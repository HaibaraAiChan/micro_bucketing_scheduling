main start at this time 1689892169.090035
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.6763331890106201
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0008292198181152344
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01576972007751465
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6773366928100586
len local_batched_seeds_list  5
partition total batch output list spend :  0.7836847305297852
self.buckets_partition() spend  sec:  0.6931352615356445
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.0413360595703125

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.10618281364440918

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.55078125 GB
    Memory Allocated: 0.10470438003540039  GigaBytes
Max Memory Allocated: 0.10470438003540039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.453125 GB
    Memory Allocated: 17.35214328765869  GigaBytes
Max Memory Allocated: 18.230217456817627  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.453125 GB
    Memory Allocated: 17.355058670043945  GigaBytes
Max Memory Allocated: 18.230217456817627  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.947265625 GB
    Memory Allocated: 0.14318037033081055  GigaBytes
Max Memory Allocated: 18.230217456817627  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.70703125 GB
    Memory Allocated: 17.400073051452637  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.70703125 GB
    Memory Allocated: 17.402652263641357  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.880859375 GB
    Memory Allocated: 0.15143918991088867  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.2578125 GB
    Memory Allocated: 14.001422882080078  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.2578125 GB
    Memory Allocated: 14.005104541778564  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3515625 GB
    Memory Allocated: 0.15689945220947266  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.35546875 GB
    Memory Allocated: 12.182416439056396  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.35546875 GB
    Memory Allocated: 12.186301708221436  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.35546875 GB
    Memory Allocated: 0.14786243438720703  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.36328125 GB
    Memory Allocated: 9.527222633361816  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.36328125 GB
    Memory Allocated: 9.528651237487793  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.36328125 GB
    Memory Allocated: 0.21671438217163086  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7757158279418945
pure train time :  3.051255464553833
train time :  4.702569246292114
end to end time :  11.369563341140747
connection check time:  2.7364859580993652
block generation time  3.1253833770751953
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.6747543811798096
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0004627704620361328
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014562845230102539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6753635406494141
len local_batched_seeds_list  5
partition total batch output list spend :  0.8590948581695557
self.buckets_partition() spend  sec:  0.6899604797363281
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.05194854736328125

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.1110081672668457

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.36328125 GB
    Memory Allocated: 0.20748615264892578  GigaBytes
Max Memory Allocated: 18.292585849761963  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.36328125 GB
    Memory Allocated: 17.434541702270508  GigaBytes
Max Memory Allocated: 18.313530445098877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.36328125 GB
    Memory Allocated: 17.43537712097168  GigaBytes
Max Memory Allocated: 18.313530445098877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.2093672752380371  GigaBytes
Max Memory Allocated: 18.313530445098877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 17.503012657165527  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 17.505591869354248  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.2171926498413086  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 14.077338218688965  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 14.081019878387451  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.22305631637573242  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 12.241267681121826  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 12.245152950286865  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.21392059326171875  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.54733943939209  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.548644542694092  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21654224395751953  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.191636562347412
pure train time :  2.561859607696533
train time :  3.6795804500579834
end to end time :  10.443433046340942
connection check time:  2.746924877166748
block generation time  3.1371662616729736
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.650334358215332
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005092620849609375
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015428304672241211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6510748863220215
len local_batched_seeds_list  5
partition total batch output list spend :  0.754002571105957
self.buckets_partition() spend  sec:  0.6665349006652832
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.038221120834350586

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.10691952705383301

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20846796035766602  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.43611764907837  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.436954975128174  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21018314361572266  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.466972827911377  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.469552040100098  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21759748458862305  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.08815050125122  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.091832160949707  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.22246789932250977  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.231832504272461  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.2357177734375  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2141718864440918  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.566547393798828  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.567939281463623  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2165522575378418  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6055610179901123
pure train time :  2.5660579204559326
train time :  3.691364288330078
end to end time :  10.27932858467102
connection check time:  2.6718332767486572
block generation time  3.1448590755462646
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.5451951026916504
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0004868507385253906
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018681764602661133
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5458357334136963
len local_batched_seeds_list  5
partition total batch output list spend :  0.6624879837036133
self.buckets_partition() spend  sec:  0.5645492076873779
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.03931784629821777

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.10918951034545898

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20855093002319336  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.447792530059814  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.448273181915283  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20934677124023438  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.479554176330566  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.482133388519287  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21763896942138672  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.065388679504395  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.06907033920288  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.22284221649169922  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.241946697235107  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.245831966400146  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21379566192626953  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.567926406860352  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.569302558898926  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21654415130615234  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0812888145446777
pure train time :  2.56706166267395
train time :  3.6863911151885986
end to end time :  10.261587619781494
connection check time:  2.7511093616485596
block generation time  3.139749765396118
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7279164791107178
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005335807800292969
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015462160110473633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7285792827606201
len local_batched_seeds_list  5
partition total batch output list spend :  0.8312907218933105
self.buckets_partition() spend  sec:  0.7440733909606934
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.04096102714538574

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.11379742622375488

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20851755142211914  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.434041500091553  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.4348783493042  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2092738151550293  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.476963996887207  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.479543209075928  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21767950057983398  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.091628074645996  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.095309734344482  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.22305631637573242  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.24443531036377  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.248320579528809  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21422863006591797  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.57352066040039  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.574848175048828  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21657514572143555  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.066732883453369
pure train time :  2.5706310272216797
train time :  3.7027130126953125
end to end time :  10.354904890060425
connection check time:  2.675278663635254
block generation time  3.130458354949951
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.6906263828277588
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005867481231689453
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016689062118530273
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6913456916809082
len local_batched_seeds_list  5
partition total batch output list spend :  0.7960648536682129
self.buckets_partition() spend  sec:  0.7080674171447754
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.04046964645385742

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.10529899597167969

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2075057029724121  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.442806243896484  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.443642616271973  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2103285789489746  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.477335453033447  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.479914665222168  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21757221221923828  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.07662057876587  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.080302238464355  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.22250604629516602  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.234339714050293  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.238224983215332  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2142620086669922  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.580832958221436  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.582292079925537  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21657705307006836  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.067091941833496
pure train time :  2.5954501628875732
train time :  3.7248103618621826
end to end time :  10.423360824584961
connection check time:  2.723534107208252
block generation time  3.1578521728515625
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7296187877655029
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005888938903808594
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0202789306640625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7303533554077148
len local_batched_seeds_list  5
partition total batch output list spend :  0.8404409885406494
self.buckets_partition() spend  sec:  0.7506680488586426
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.03992724418640137

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.10950088500976562

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20772647857666016  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.433351039886475  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.434186935424805  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2094402313232422  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.481356620788574  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.483935832977295  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21761751174926758  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.084691047668457  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.088372707366943  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.22305536270141602  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.252659797668457  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.256545066833496  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2143697738647461  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.560640811920166  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.5619478225708  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21667814254760742  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.028158664703369
pure train time :  2.583203077316284
train time :  3.7048580646514893
end to end time :  10.399909734725952
connection check time:  2.6918413639068604
block generation time  3.1480300426483154
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.6933331489562988
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0006625652313232422
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015902042388916016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6941237449645996
len local_batched_seeds_list  5
partition total batch output list spend :  0.8025929927825928
self.buckets_partition() spend  sec:  0.7100560665130615
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.042897939682006836

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.11702394485473633

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20756292343139648  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.431159019470215  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.431995391845703  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20938920974731445  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.495095252990723  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.497674465179443  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21703481674194336  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.050665855407715  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.054347515106201  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.22263145446777344  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.253052711486816  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.256937980651855  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21424198150634766  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.577224254608154  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.57853651046753  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2165546417236328  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.959329605102539
pure train time :  2.5982186794281006
train time :  3.7364115715026855
end to end time :  10.487353324890137
connection check time:  2.7896158695220947
block generation time  3.141568183898926
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7488381862640381
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005779266357421875
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014750242233276367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7495574951171875
len local_batched_seeds_list  5
partition total batch output list spend :  0.9369058609008789
self.buckets_partition() spend  sec:  0.7643415927886963
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.055193424224853516

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.11106491088867188

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2075037956237793  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.455831050872803  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.456666946411133  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20936298370361328  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.462419509887695  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.464998722076416  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21756458282470703  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.07430124282837  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.077982902526855  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.22284173965454102  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.238915920257568  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.242801189422607  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21423912048339844  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.577439785003662  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.578882694244385  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21656036376953125  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.869304895401001
pure train time :  2.5847928524017334
train time :  3.7100067138671875
end to end time :  10.544475078582764
connection check time:  2.7322988510131836
block generation time  3.1472432613372803
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  5
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.701385498046875
len(g_bucket_nids_list)  5
len(local_split_batches_nid_list)  5
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005826950073242188
self.weights_list  [0.2015592527023015, 0.14481916847186638, 0.2716156629023213, 0.28666937904795414, 0.09533653687555668]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015746355056762695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7021067142486572
len local_batched_seeds_list  5
partition total batch output list spend :  0.8185520172119141
self.buckets_partition() spend  sec:  0.7178828716278076
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.042249441146850586

res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.1041409969329834

res  length 5
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20769357681274414  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.438416004180908  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.43925189971924  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.20928478240966797  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.47419261932373  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 17.47677183151245  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21754121780395508  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.05730390548706  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 14.060985565185547  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2228407859802246  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.226136207580566  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 12.230021476745605  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.2137904167175293  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.569640159606934  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 9.570955276489258  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.109375 GB
    Memory Allocated: 0.21654796600341797  GigaBytes
Max Memory Allocated: 18.395805835723877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7681689262390137
pure train time :  2.5915143489837646
train time :  3.731987237930298
end to end time :  10.492222547531128
connection check time:  2.781582832336426
block generation time  3.143162488937378
end to end time  10.669363975524902
Total (block generation + training)time/epoch 10.669363975524902
pure train time per /epoch  [3.051255464553833, 2.561859607696533, 2.5660579204559326, 2.56706166267395, 2.5706310272216797, 2.5954501628875732, 2.583203077316284, 2.5982186794281006, 2.5847928524017334, 2.5915143489837646]
pure train time average  2.5844102587018694
input num list  [672530, 672003, 671828, 672756, 672451, 672280, 673023, 672644, 672049, 672212]
