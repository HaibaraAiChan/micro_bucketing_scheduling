main start at this time 1690860339.144528
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0009610652923583984
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015780210494995117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7990543842315674
len local_batched_seeds_list  11
partition total batch output list spend :  0.9761788845062256
self.buckets_partition() spend  sec:  0.8148632049560547
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.03349709510803223

in edges time spent  0.14535880088806152
local to global src and eids time spent  0.3271341323852539
time gen tails  0.0799257755279541
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.12913942337036133

in edges time spent  0.8488032817840576
local to global src and eids time spent  1.464853048324585
time gen tails  0.25491929054260254
res  length 11
block collection to dataloader spend  1.8358230590820312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.53125 GB
    Memory Allocated: 0.08311700820922852  GigaBytes
Max Memory Allocated: 0.08311700820922852  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.048828125 GB
    Memory Allocated: 6.978695869445801  GigaBytes
Max Memory Allocated: 7.301041126251221  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.048828125 GB
    Memory Allocated: 6.979198932647705  GigaBytes
Max Memory Allocated: 7.301041126251221  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.560546875 GB
    Memory Allocated: 0.1299605369567871  GigaBytes
Max Memory Allocated: 7.301041126251221  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.56640625 GB
    Memory Allocated: 8.64131784439087  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.56640625 GB
    Memory Allocated: 8.643210411071777  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.19140625 GB
    Memory Allocated: 0.12044382095336914  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.19921875 GB
    Memory Allocated: 6.999370574951172  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.19921875 GB
    Memory Allocated: 6.999822616577148  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.19921875 GB
    Memory Allocated: 0.13570833206176758  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.55859375 GB
    Memory Allocated: 8.427629470825195  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.55859375 GB
    Memory Allocated: 8.430412769317627  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 0.1355600357055664  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 8.232489585876465  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 8.233760356903076  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 0.13228797912597656  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 7.89162540435791  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 7.892584800720215  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 0.1390528678894043  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 7.593177795410156  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.16015625 GB
    Memory Allocated: 7.595442295074463  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.68359375 GB
    Memory Allocated: 0.13323354721069336  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.68359375 GB
    Memory Allocated: 7.212799072265625  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.68359375 GB
    Memory Allocated: 7.213502883911133  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.68359375 GB
    Memory Allocated: 0.13935232162475586  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.68359375 GB
    Memory Allocated: 6.418467998504639  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.68359375 GB
    Memory Allocated: 6.420806407928467  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.68359375 GB
    Memory Allocated: 0.13198375701904297  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 6.224530220031738  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 6.224977970123291  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.12915468215942383  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 5.8408308029174805  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 5.841207981109619  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.1990513801574707  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.776398181915283
pure train time :  2.666638135910034
train time :  5.0077550411224365
end to end time :  11.764039039611816
connection check time:  3.851118564605713
block generation time  1.9070866107940674
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0005350112915039062
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014611005783081055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8129558563232422
len local_batched_seeds_list  11
partition total batch output list spend :  1.2026350498199463
self.buckets_partition() spend  sec:  0.82759690284729
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.055023908615112305

in edges time spent  0.17321228981018066
local to global src and eids time spent  0.34790992736816406
time gen tails  0.08597683906555176
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.1312696933746338

in edges time spent  0.8785400390625
local to global src and eids time spent  1.4145941734313965
time gen tails  0.24704527854919434
res  length 11
block collection to dataloader spend  2.09808349609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.18399381637573242  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.041712284088135  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.0408735275268555  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.1962742805480957  GigaBytes
Max Memory Allocated: 9.043034076690674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 8.72053050994873  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 8.722392559051514  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.18643999099731445  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.080915927886963  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.0813679695129395  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.20198297500610352  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 8.502607822418213  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 8.505316734313965  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.20157337188720703  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 8.34205436706543  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 8.343496799468994  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.19844532012939453  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.982179164886475  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.983138561248779  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.20519351959228516  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.649867057800293  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.652146816253662  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.19945192337036133  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.2739691734313965  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 7.274672985076904  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.20548725128173828  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 6.478163242340088  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 6.480511665344238  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.693359375 GB
    Memory Allocated: 0.1981039047241211  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.287187099456787  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.28763484954834  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19524049758911133  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.914348125457764  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.914725303649902  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19899606704711914  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.191019296646118
pure train time :  2.260789394378662
train time :  4.148147821426392
end to end time :  11.154602527618408
connection check time:  3.801650285720825
block generation time  1.9735996723175049
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0006327629089355469
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.019357681274414062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8773486614227295
len local_batched_seeds_list  11
partition total batch output list spend :  1.0456490516662598
self.buckets_partition() spend  sec:  0.8967416286468506
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.03885984420776367

in edges time spent  0.08669757843017578
local to global src and eids time spent  0.2511296272277832
time gen tails  0.08261466026306152
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.132981538772583

in edges time spent  0.8202266693115234
local to global src and eids time spent  1.393627643585205
time gen tails  0.23877501487731934
res  length 11
block collection to dataloader spend  1.621246337890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18400335311889648  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.05012845993042  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.049289703369141  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19600343704223633  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.709250926971436  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.711143493652344  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18651914596557617  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.076287269592285  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.076739311218262  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20214462280273438  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.503366947174072  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.506241798400879  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20176029205322266  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.300177097320557  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.301461219787598  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19840145111083984  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.978142738342285  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.97910213470459  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.205108642578125  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.650665760040283  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.652865409851074  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1990523338317871  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.267969131469727  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.268672943115234  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20530080795288086  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.469903945922852  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.472379207611084  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1981678009033203  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.281472682952881  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.281920433044434  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19522714614868164  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.909018039703369  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.909395217895508  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19898271560668945  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6094322204589844
pure train time :  2.26499080657959
train time :  4.169832706451416
end to end time :  10.665352821350098
connection check time:  3.489912748336792
block generation time  1.9415521621704102
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0005807876586914062
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014370918273925781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7751410007476807
len local_batched_seeds_list  11
partition total batch output list spend :  1.1506803035736084
self.buckets_partition() spend  sec:  0.7895450592041016
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.055021047592163086

in edges time spent  0.15846824645996094
local to global src and eids time spent  0.27281665802001953
time gen tails  0.060225486755371094
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.12606406211853027

in edges time spent  0.8683121204376221
local to global src and eids time spent  1.4057211875915527
time gen tails  0.24354076385498047
res  length 11
block collection to dataloader spend  2.2411346435546875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18398618698120117  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.044464111328125  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.043625354766846  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19627952575683594  GigaBytes
Max Memory Allocated: 9.122354507446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.72860336303711  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.730495929718018  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1865215301513672  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.082358360290527  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.082810401916504  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20212078094482422  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.520527362823486  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.523362159729004  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20162200927734375  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.340805530548096  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.34223461151123  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19826841354370117  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.9553608894348145  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.956320285797119  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20516586303710938  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.637599945068359  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.63976526260376  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19931507110595703  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.276363849639893  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.2770676612854  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20530128479003906  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.468151569366455  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.470585823059082  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19817018508911133  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.280117511749268  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.28056526184082  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19533300399780273  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.933202743530273  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.933579921722412  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19908428192138672  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.08178448677063
pure train time :  2.2667226791381836
train time :  4.156878471374512
end to end time :  10.921756982803345
connection check time:  3.6483802795410156
block generation time  1.940302848815918
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.00055694580078125
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014623641967773438
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8988406658172607
len local_batched_seeds_list  11
partition total batch output list spend :  1.2779524326324463
self.buckets_partition() spend  sec:  0.913494348526001
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.05546975135803223

in edges time spent  0.1603832244873047
local to global src and eids time spent  0.2202005386352539
time gen tails  0.059917449951171875
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.1275036334991455

in edges time spent  0.8575232028961182
local to global src and eids time spent  1.402653694152832
time gen tails  0.24129509925842285
res  length 11
block collection to dataloader spend  1.71661376953125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18398809432983398  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.039843559265137  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.039004802703857  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19609594345092773  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.718724727630615  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.720556259155273  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18648767471313477  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.065622806549072  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.066074848175049  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.2020401954650879  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.509629249572754  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.512525081634521  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.2017812728881836  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.301805019378662  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.303260803222656  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1992635726928711  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.998773097991943  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.999732494354248  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20523977279663086  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.654451370239258  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.65673303604126  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1993575096130371  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.274516582489014  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.2752203941345215  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20530033111572266  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.467540264129639  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.46998929977417  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19817018508911133  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.288874626159668  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.289322376251221  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19526386260986328  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.910243511199951  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.91062068939209  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1990189552307129  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0689327716827393
pure train time :  2.27158522605896
train time :  4.133025169372559
end to end time :  10.931997537612915
connection check time:  3.5732877254486084
block generation time  1.9297950267791748
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0005545616149902344
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015959739685058594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8794934749603271
len local_batched_seeds_list  11
partition total batch output list spend :  1.2646737098693848
self.buckets_partition() spend  sec:  0.8954834938049316
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.059654951095581055

in edges time spent  0.17361950874328613
local to global src and eids time spent  0.34732842445373535
time gen tails  0.08280730247497559
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.13251113891601562

in edges time spent  0.8904898166656494
local to global src and eids time spent  1.3901610374450684
time gen tails  0.2418043613433838
res  length 11
block collection to dataloader spend  1.6689300537109375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1840057373046875  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.05081033706665  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.049972057342529  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1960911750793457  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.709089279174805  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.710981845855713  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1865229606628418  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.0804362297058105  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.080888271331787  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20198965072631836  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.508310317993164  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.511206150054932  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.2016301155090332  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.341444969177246  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.342905044555664  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19842195510864258  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.991307258605957  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.992266654968262  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20516157150268555  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.658875465393066  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.6610636711120605  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1992807388305664  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.268485069274902  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.26918888092041  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20529556274414062  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.459880352020264  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.462380409240723  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19817113876342773  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.2945733070373535  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.295021057128906  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19512462615966797  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.9167585372924805  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.917135715484619  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19887924194335938  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0668296813964844
pure train time :  2.2809255123138428
train time :  4.132731914520264
end to end time :  11.102227210998535
connection check time:  3.7685959339141846
block generation time  1.915531873703003
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.000560760498046875
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015926361083984375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8548352718353271
len local_batched_seeds_list  11
partition total batch output list spend :  1.2296807765960693
self.buckets_partition() spend  sec:  0.8707888126373291
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.05513167381286621

in edges time spent  0.15506505966186523
local to global src and eids time spent  0.3266570568084717
time gen tails  0.08147478103637695
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.13176965713500977

in edges time spent  0.8108994960784912
local to global src and eids time spent  1.3867912292480469
time gen tails  0.23865938186645508
res  length 11
block collection to dataloader spend  1.6689300537109375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18399572372436523  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.050681114196777  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.049842357635498  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19620180130004883  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.721573829650879  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.723466396331787  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18651676177978516  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.077441215515137  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.077893257141113  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20210695266723633  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.516517639160156  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.519413471221924  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.2017822265625  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.338576793670654  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.340059280395508  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19839048385620117  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.981425762176514  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.982385158538818  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20520544052124023  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.648030757904053  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.650312423706055  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19910478591918945  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.268091201782227  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.268795013427734  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20540094375610352  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.480156898498535  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.482540130615234  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19813776016235352  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.287680149078369  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.288127899169922  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19518327713012695  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.911936283111572  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.912313461303711  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19894123077392578  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.028404474258423
pure train time :  2.270857334136963
train time :  4.177994012832642
end to end time :  10.964875221252441
connection check time:  3.6364660263061523
block generation time  1.905670404434204
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0005273818969726562
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014777898788452148
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7975327968597412
len local_batched_seeds_list  11
partition total batch output list spend :  1.1645264625549316
self.buckets_partition() spend  sec:  0.8123366832733154
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.057709455490112305

in edges time spent  0.1558849811553955
local to global src and eids time spent  0.33412814140319824
time gen tails  0.08276534080505371
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.13169431686401367

in edges time spent  0.8416903018951416
local to global src and eids time spent  1.3901760578155518
time gen tails  0.24516606330871582
res  length 11
block collection to dataloader spend  1.9550323486328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1839900016784668  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.040075778961182  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.039237022399902  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19609880447387695  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.710326671600342  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.71221923828125  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1865253448486328  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.075873374938965  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.076325416564941  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20203399658203125  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.527338981628418  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.530053615570068  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20160198211669922  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.297746181488037  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.29908561706543  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1983938217163086  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.947824478149414  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.948783874511719  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20517206192016602  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.647348403930664  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.649628162384033  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19958257675170898  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.295357704162598  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.2960615158081055  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.2053070068359375  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.472548007965088  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.474928855895996  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1981358528137207  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.279814720153809  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.280262470245361  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19547653198242188  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.937796115875244  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.938173294067383  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19922685623168945  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.960613965988159
pure train time :  2.275756597518921
train time :  4.137255430221558
end to end time :  10.920458793640137
connection check time:  3.6867940425872803
block generation time  1.9106178283691406
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0005767345428466797
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016643285751342773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8570857048034668
len local_batched_seeds_list  11
partition total batch output list spend :  1.023005485534668
self.buckets_partition() spend  sec:  0.8737595081329346
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.04090523719787598

in edges time spent  0.1531374454498291
local to global src and eids time spent  0.33828258514404297
time gen tails  0.08245730400085449
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.13346433639526367

in edges time spent  0.8633790016174316
local to global src and eids time spent  1.4089922904968262
time gen tails  0.24685215950012207
res  length 11
block collection to dataloader spend  2.1457672119140625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1840071678161621  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.055919647216797  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.055079936981201  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19620037078857422  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.722596168518066  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.724488735198975  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1865243911743164  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.06493616104126  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.065388202667236  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.2020726203918457  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.492029190063477  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.494925022125244  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20159339904785156  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.302626132965088  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.303906440734863  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1993260383605957  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.985447883605957  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.986407279968262  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20518064498901367  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.646564483642578  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.64884614944458  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1994190216064453  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.2846784591674805  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.285382270812988  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20530080795288086  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.465380668640137  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.467797756195068  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19817066192626953  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.285573959350586  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.286021709442139  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19530963897705078  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.915147304534912  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.915524482727051  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19906330108642578  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8697474002838135
pure train time :  2.278144121170044
train time :  4.147565126419067
end to end time :  10.832643270492554
connection check time:  3.7270290851593018
block generation time  1.9180691242218018
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
the grouping_fanout_arxiv called successfully
capacity  4300
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723 1294 1283]

remove bucket_id:  [12, 21, 23]
original bucket_id :,  [13, 22, 21]
remove weights:  [1723 1294 1283], 		------------sum 4300

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
res_tmp  [1511 1481 1293]

remove bucket_id:  [15, 16, 18]
original bucket_id :,  [18, 19, 23]
remove weights:  [1511 1481 1293], 		------------sum 4285

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1293]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2122 2091]

remove bucket_id:  [0, 1]
original bucket_id :,  [3, 2]
remove weights:  [2122 2091], 		------------sum 4213

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2085 2056]

remove bucket_id:  [0, 1]
original bucket_id :,  [6, 7]
remove weights:  [2085 2056], 		------------sum 4141

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [2003 1983]

remove bucket_id:  [0, 1]
original bucket_id :,  [8, 9]
remove weights:  [2003 1983], 		------------sum 3986

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1962 1875]

remove bucket_id:  [0, 1]
original bucket_id :,  [1, 11]
remove weights:  [1962 1875], 		------------sum 3837

before remove weights,  [1962, 1875, 1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1429]
res_tmp  [1682 1672]

remove bucket_id:  [0, 1]
original bucket_id :,  [14, 0]
remove weights:  [1682 1672], 		------------sum 3354

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1429]
after remove pre pack weights,  [1584, 1579, 1530, 1429]
res_tmp  [1584 1579]

remove bucket_id:  [0, 1]
original bucket_id :,  [16, 15]
remove weights:  [1584 1579], 		------------sum 3163

before remove weights,  [1584, 1579, 1530, 1429]
after remove pre pack weights,  [1530, 1429]
G_BUCKET_ID_list [[13, 22, 21], [4, 5], [18, 19, 23], [3, 2], [6, 7], [8, 9], [1, 11], [10, 12], [14, 0], [16, 15], [17, 20]]
Groups_mem_list  [[1723, 1294, 1283], [2164, 2127], [1511, 1481, 1293], [2122, 2091], [2085, 2056], [2003, 1983], [1962, 1875], [1874, 1773], [1682, 1672], [1584, 1579], [1530, 1429]]
G_BUCKET_ID_list length 11
len(g_bucket_nids_list)  11
len(local_split_batches_nid_list)  11
current group_mem  4.300945355808334
current group_mem  4.291440736088369
current group_mem  4.286428340907184
current group_mem  4.213744787954807
current group_mem  4.141342153354332
current group_mem  3.9876730341236692
current group_mem  3.8383728445724703
current group_mem  3.6482251697690558
current group_mem  3.355003707640746
current group_mem  3.1630642178293034
current group_mem  2.9600885323173918
batches output list generation spend  0.0005481243133544922
self.weights_list  [0.03704599685510386, 0.13140387723908908, 0.03329631299413906, 0.19195962217261742, 0.09211466775161918, 0.07076016318272287, 0.1594770235647288, 0.05189078633399677, 0.1712868783057147, 0.0329994172045612, 0.027765254395707106]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014175891876220703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8100132942199707
len local_batched_seeds_list  11
partition total batch output list spend :  1.175011396408081
self.buckets_partition() spend  sec:  0.8242199420928955
layer  0
 the number of batches:  11
check_connections_block*********************************

the find indices time spent  0.05568838119506836

in edges time spent  0.16179585456848145
local to global src and eids time spent  0.3309178352355957
time gen tails  0.08166742324829102
res  length 11
layer  1
num of batch  11
check_connections_block*********************************

the find indices time spent  0.1335282325744629

in edges time spent  0.8057663440704346
local to global src and eids time spent  1.3938288688659668
time gen tails  0.24247264862060547
res  length 11
block collection to dataloader spend  1.71661376953125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1840062141418457  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.044363975524902  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.043525218963623  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19603872299194336  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.698554039001465  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.700446605682373  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.18652820587158203  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.074505805969238  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.074957847595215  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20172786712646484  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.487946033477783  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.490706443786621  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20158100128173828  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.342575073242188  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 8.343994617462158  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19832801818847656  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.943295478820801  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.9442548751831055  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.2051858901977539  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.645465850830078  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.64774751663208  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19922876358032227  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.267059326171875  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 7.267763137817383  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.20533990859985352  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.468217372894287  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.470590591430664  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.19812679290771484  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.289860248565674  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 6.290307998657227  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1953258514404297  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.911750316619873  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 5.912127494812012  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.701171875 GB
    Memory Allocated: 0.1990814208984375  GigaBytes
Max Memory Allocated: 9.130350112915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.767803192138672
pure train time :  2.2835183143615723
train time :  4.144327640533447
end to end time :  10.929195880889893
connection check time:  3.6558752059936523
block generation time  1.9335589408874512
end to end time  11.064357042312622
Total (block generation + training)time/epoch 11.064357042312622
pure train time per /epoch  [2.666638135910034, 2.260789394378662, 2.26499080657959, 2.2667226791381836, 2.27158522605896, 2.2809255123138428, 2.270857334136963, 2.275756597518921, 2.278144121170044, 2.2835183143615723]
pure train time average  2.2753585406712125
input num list  [1175416, 1176360, 1174741, 1175992, 1176001, 1175613, 1175626, 1175612, 1177007, 1175132]
