main start at this time 1689369074.7572997
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
dtype  torch.int64
data type  <class 'torch.Tensor'>
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04672694206237793
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.70871901512146
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0007727146148681641
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014900922775268555
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7097742557525635
len local_batched_seeds_list  6
partition total batch output list spend :  0.9819967746734619
self.buckets_partition() spend  sec:  0.7247216701507568
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.55078125 GB
    Memory Allocated: 0.10406208038330078  GigaBytes
Max Memory Allocated: 0.10406208038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.77734375 GB
    Memory Allocated: 16.670205116271973  GigaBytes
Max Memory Allocated: 17.51566982269287  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.77734375 GB
    Memory Allocated: 16.672929763793945  GigaBytes
Max Memory Allocated: 17.51566982269287  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.21484375 GB
    Memory Allocated: 0.14232826232910156  GigaBytes
Max Memory Allocated: 17.51566982269287  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.26171875 GB
    Memory Allocated: 16.83097219467163  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.26171875 GB
    Memory Allocated: 16.83355140686035  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.775390625 GB
    Memory Allocated: 0.1501169204711914  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.876953125 GB
    Memory Allocated: 13.326295852661133  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.876953125 GB
    Memory Allocated: 13.329930305480957  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.908203125 GB
    Memory Allocated: 0.1540975570678711  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.912109375 GB
    Memory Allocated: 11.517342567443848  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.912109375 GB
    Memory Allocated: 11.521181106567383  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.912109375 GB
    Memory Allocated: 0.14553356170654297  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.91796875 GB
    Memory Allocated: 8.80642557144165  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.91796875 GB
    Memory Allocated: 8.807762622833252  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.91796875 GB
    Memory Allocated: 0.12331485748291016  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.98046875 GB
    Memory Allocated: 4.534646987915039  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.98046875 GB
    Memory Allocated: 4.534882545471191  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.98046875 GB
    Memory Allocated: 0.19104862213134766  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7768516540527344
pure train time :  2.9664862155914307
train time :  4.781209945678711
end to end time :  11.454941034317017
connection check time:  2.391141891479492
block generation time  3.2775919437408447
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04780912399291992
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.665658712387085
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0004591941833496094
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015610694885253906
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.6663849353790283
len local_batched_seeds_list  6
partition total batch output list spend :  0.8381245136260986
self.buckets_partition() spend  sec:  0.6820476055145264
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.98046875 GB
    Memory Allocated: 0.20446109771728516  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.98046875 GB
    Memory Allocated: 16.788347244262695  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.98046875 GB
    Memory Allocated: 16.79007863998413  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 0.2084360122680664  GigaBytes
Max Memory Allocated: 17.662331581115723  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 16.910569190979004  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 16.913148403167725  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 0.21679925918579102  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 13.441802501678467  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 13.445436954498291  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 0.22015047073364258  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 11.525242328643799  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 11.529080867767334  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 0.2117786407470703  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 8.871695518493652  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 8.87303876876831  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.693359375 GB
    Memory Allocated: 0.18903207778930664  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.577242851257324  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.577478408813477  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.1906876564025879  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.191272497177124
pure train time :  2.4830493927001953
train time :  3.7542436122894287
end to end time :  7.659196615219116
connection check time:  1.3362517356872559
block generation time  1.7076525688171387
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04578280448913574
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.6542787551879883
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0007822513580322266
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015504837036132812
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.6552958488464355
len local_batched_seeds_list  6
partition total batch output list spend :  0.8229310512542725
self.buckets_partition() spend  sec:  0.6708612442016602
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20448637008666992  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.7801194190979  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.781851768493652  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20842790603637695  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.890556812286377  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.892586708068848  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21569013595581055  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.426297187805176  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.429931640625  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2201080322265625  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.55762004852295  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.561458587646484  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21164608001708984  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.879849433898926  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.88114309310913  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.1887192726135254  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.565552711486816  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.565788269042969  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.19037246704101562  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.609492063522339
pure train time :  2.4685451984405518
train time :  3.7675559520721436
end to end time :  10.586326837539673
connection check time:  2.6118040084838867
block generation time  3.3618152141571045
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.049727439880371094
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.5991313457489014
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005090236663818359
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03466367721557617
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.6000888347625732
len local_batched_seeds_list  6
partition total batch output list spend :  0.7909047603607178
self.buckets_partition() spend  sec:  0.6348052024841309
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20456886291503906  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.790167808532715  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.791901111602783  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20854425430297852  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.89387798309326  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.896457195281982  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2167987823486328  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.433974742889404  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.437609195709229  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.22002935409545898  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.538902759552002  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.542741298675537  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2120957374572754  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.87697458267212  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.878254890441895  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.18898296356201172  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.5866265296936035  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.586862087249756  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.19063472747802734  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0765774250030518
pure train time :  2.445587158203125
train time :  3.7232208251953125
end to end time :  8.551002025604248
connection check time:  1.940382719039917
block generation time  2.078300952911377
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.057096242904663086
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7510707378387451
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0004940032958984375
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016400575637817383
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.751807451248169
len local_batched_seeds_list  6
partition total batch output list spend :  0.9309289455413818
self.buckets_partition() spend  sec:  0.7682557106018066
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20453929901123047  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.789635181427002  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.791367530822754  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2085113525390625  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.897515296936035  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.900094509124756  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21580171585083008  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.424421787261963  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.428056240081787  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.22023963928222656  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.587084293365479  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.590922832489014  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21155214309692383  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.867320537567139  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.868663787841797  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.18924856185913086  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.5864362716674805  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.586671829223633  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.19087791442871094  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0672078132629395
pure train time :  2.4737138748168945
train time :  3.765568733215332
end to end time :  10.506006479263306
connection check time:  2.4959359169006348
block generation time  3.2963240146636963
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05156826972961426
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7389223575592041
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.000518798828125
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01836538314819336
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7398240566253662
len local_batched_seeds_list  6
partition total batch output list spend :  0.9141526222229004
self.buckets_partition() spend  sec:  0.7582452297210693
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2045292854309082  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.792802810668945  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.79453468322754  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2085094451904297  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.886858463287354  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.888888359069824  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2156658172607422  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.416808128356934  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.420442581176758  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2201399803161621  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.583288669586182  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.587127208709717  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2117767333984375  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.863390445709229  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.864733695983887  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.1890854835510254  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.586245536804199  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.586481094360352  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.19068241119384766  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0671396255493164
pure train time :  2.484685182571411
train time :  3.7868709564208984
end to end time :  10.515003681182861
connection check time:  2.4280779361724854
block generation time  3.368704080581665
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.055002450942993164
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7181031703948975
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.000507354736328125
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014888763427734375
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7188775539398193
len local_batched_seeds_list  6
partition total batch output list spend :  0.9947645664215088
self.buckets_partition() spend  sec:  0.7338242530822754
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2044820785522461  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.785690307617188  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.78742218017578  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2085399627685547  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.900822162628174  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.902852058410645  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21587467193603516  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.428930282592773  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.432564735412598  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2200489044189453  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.538825035095215  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.54266357421875  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2118968963623047  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.89127254486084  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.892615795135498  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.1889200210571289  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.569201946258545  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.569437503814697  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.1904897689819336  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0283710956573486
pure train time :  2.4787964820861816
train time :  3.7724366188049316
end to end time :  10.513213396072388
connection check time:  2.4388113021850586
block generation time  3.287275552749634
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04779052734375
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7456166744232178
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005288124084472656
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0156707763671875
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7465064525604248
len local_batched_seeds_list  6
partition total batch output list spend :  0.9140403270721436
self.buckets_partition() spend  sec:  0.7622270584106445
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2045140266418457  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.7728533744812  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.77458620071411  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20850753784179688  GigaBytes
Max Memory Allocated: 17.74316120147705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.914132118225098  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.91671133041382  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21573925018310547  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.408153533935547  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.411787986755371  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.22037029266357422  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.576016426086426  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.579854965209961  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2118086814880371  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.901613712310791  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.902950286865234  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.18909835815429688  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.588787078857422  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.589022636413574  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.19072389602661133  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9591526985168457
pure train time :  2.4813034534454346
train time :  3.7837204933166504
end to end time :  10.48187804222107
connection check time:  2.400763511657715
block generation time  3.363957166671753
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.03339815139770508
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.30666446685791016
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0004703998565673828
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01691889762878418
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3073549270629883
len local_batched_seeds_list  6
partition total batch output list spend :  0.42282772064208984
self.buckets_partition() spend  sec:  0.3243143558502197
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20445537567138672  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.79955816268921  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.80129051208496  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20848512649536133  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.891793251037598  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.89437246322632  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21573257446289062  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.40109634399414  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.404730796813965  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.22026395797729492  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.56062364578247  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.564462184906006  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21147489547729492  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.87018346786499  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.871526718139648  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.18918371200561523  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.595238208770752  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.595473766326904  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.1907811164855957  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8670897483825684
pure train time :  2.4830093383789062
train time :  3.8076932430267334
end to end time :  7.348699331283569
connection check time:  1.36281156539917
block generation time  1.7402794361114502
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.0539400577545166
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  9460
map_output_list size  9460
self.K  6
the grouping_fanout_arxiv called successfully
capacity  6029
 
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1313 1017  939  787  716  634  623]

remove bucket_id:  [5, 6, 9, 10, 13, 14]
original bucket_id :,  [5, 6, 9, 10, 13, 14]
remove weights:  [1017  939  787  716  634  623], 		------------sum 4716

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
res_tmp  [1168  871  715  678  567  560  530  505  435]

remove bucket_id:  [5, 7, 8, 9, 10, 12, 14, 15]
original bucket_id :,  [7, 11, 12, 16, 15, 18, 20, 22]
remove weights:  [871 715 678 567 560 530 505 435], 		------------sum 4861

before remove weights,  [3637, 3519, 1313, 1168, 1111, 871, 827, 715, 678, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
res_tmp  [3519 1168  827  506]

remove bucket_id:  [1, 3, 5, 7]
original bucket_id :,  [1, 3, 8, 19]
remove weights:  [3519 1168  827  506], 		------------sum 6020

before remove weights,  [3637, 3519, 1313, 1168, 1111, 827, 541, 506, 433, 428]
after remove pre pack weights,  [3637, 1313, 1111, 541, 433, 428]
res_tmp  [3637 1313  541  433]

remove bucket_id:  [0, 1, 3, 4]
original bucket_id :,  [0, 2, 17, 23]
remove weights:  [3637 1313  541  433], 		------------sum 5924

before remove weights,  [3637, 1313, 1111, 541, 433, 428]
after remove pre pack weights,  [1111, 428]
G_BUCKET_ID_list [[5, 6, 9, 10, 13, 14], [7, 11, 12, 16, 15, 18, 20, 22], [1, 3, 8, 19], [0, 2, 17, 23], [4, 21]]
Groups_mem_list  [[1017, 939, 787, 716, 634, 623], [871, 715, 678, 567, 560, 530, 505, 435], [3519, 1168, 827, 506], [3637, 1313, 541, 433], [1111, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7297995090484619
5
6
[5, 6, 9, 10, 13, 14]
current group_mem  4.718984284246874
[7, 11, 12, 16, 15, 18, 20, 22]
current group_mem  4.864741552039423
[1, 3, 8, 19]
current group_mem  6.021272563572968
[0, 2, 17, 23]
current group_mem  5.92694655011749
[4, 21]
current group_mem  1.5392633456629305
batches output list generation spend  0.0005304813385009766
self.weights_list  [0.1980954684905598, 0.1413553842601247, 0.2681518786905796, 0.2832055948362125, 0.09186175652346026, 0.017329917199063127]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01669621467590332
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7305796146392822
len local_batched_seeds_list  6
partition total batch output list spend :  0.9087188243865967
self.buckets_partition() spend  sec:  0.7473270893096924
layer  0
 the number of batches:  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  6
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 6
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20447969436645508  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.77796745300293  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.779699325561523  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.20848608016967773  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.898410320281982  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 16.900989532470703  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21578264236450195  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.415969848632812  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 13.419604301452637  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.2200913429260254  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.542343139648438  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 11.546181678771973  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.21160650253295898  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.876374244689941  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 8.877715587615967  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.1892094612121582  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.587911605834961  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 4.588147163391113  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6953125 GB
    Memory Allocated: 0.19084739685058594  GigaBytes
Max Memory Allocated: 17.746652603149414  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7663745880126953
pure train time :  2.4957478046417236
train time :  3.808475971221924
end to end time :  10.612792491912842
connection check time:  2.503941774368286
block generation time  3.368316888809204
end to end time  10.791773080825806
Total (block generation + training)time/epoch 10.791773080825806
pure train time per /epoch  [2.9664862155914307, 2.4830493927001953, 2.4685451984405518, 2.445587158203125, 2.4737138748168945, 2.484685182571411, 2.4787964820861816, 2.4813034534454346, 2.4830093383789062, 2.4957478046417236]
pure train time average  2.477549042020525
input num list  [740673, 740565, 739293, 740575, 740721, 740468, 740522, 740697, 739724, 740260]
