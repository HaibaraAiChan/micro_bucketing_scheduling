main start at this time 1691116913.2789989
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0008218288421630859
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014782190322875977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.529644250869751
len local_batched_seeds_list  4
partition total batch output list spend :  0.682464599609375
self.buckets_partition() spend  sec:  0.5444583892822266
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042227983474731445

in edges time spent  0.1477344036102295
local to global src and eids time spent  0.29243016242980957
time gen tails  0.06237459182739258
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12834548950195312

in edges time spent  0.5655190944671631
local to global src and eids time spent  0.8838245868682861
time gen tails  0.1300210952758789
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.525390625 GB
    Memory Allocated: 0.07788610458374023  GigaBytes
Max Memory Allocated: 0.07788610458374023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.748046875 GB
    Memory Allocated: 7.910709381103516  GigaBytes
Max Memory Allocated: 8.122176170349121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.748046875 GB
    Memory Allocated: 7.914387226104736  GigaBytes
Max Memory Allocated: 8.122176170349121  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.103515625 GB
    Memory Allocated: 0.08814573287963867  GigaBytes
Max Memory Allocated: 8.122176170349121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.720703125 GB
    Memory Allocated: 8.119879245758057  GigaBytes
Max Memory Allocated: 8.339144706726074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.720703125 GB
    Memory Allocated: 8.123239040374756  GigaBytes
Max Memory Allocated: 8.339144706726074  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.724609375 GB
    Memory Allocated: 0.09274101257324219  GigaBytes
Max Memory Allocated: 8.339144706726074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.078125 GB
    Memory Allocated: 8.319740295410156  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.078125 GB
    Memory Allocated: 8.323147296905518  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 0.09773445129394531  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 8.176105976104736  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 8.179506778717041  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 0.1119084358215332  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.834001064300537
pure train time :  0.9281857013702393
train time :  1.693077564239502
end to end time :  6.351992607116699
connection check time:  2.596464157104492
block generation time  1.359762191772461
Run 00 | Epoch 00000 | Loss 3.8340 | Test 0.0431
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004324913024902344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015504121780395508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5201969146728516
len local_batched_seeds_list  4
partition total batch output list spend :  0.6262142658233643
self.buckets_partition() spend  sec:  0.5357387065887451
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04084444046020508

in edges time spent  0.15231847763061523
local to global src and eids time spent  0.28873229026794434
time gen tails  0.06415534019470215
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12480831146240234

in edges time spent  0.5802257061004639
local to global src and eids time spent  0.8718616962432861
time gen tails  0.13436293601989746
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 0.09424495697021484  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 7.9239678382873535  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 7.9230217933654785  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.080078125 GB
    Memory Allocated: 0.09383916854858398  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.791015625 GB
    Memory Allocated: 8.137462139129639  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.791015625 GB
    Memory Allocated: 8.141139507293701  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.96875 GB
    Memory Allocated: 0.09828805923461914  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.97265625 GB
    Memory Allocated: 8.319003582000732  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.97265625 GB
    Memory Allocated: 8.322404384613037  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 0.1022634506225586  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 8.179344177246094  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 8.182744979858398  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 0.1120138168334961  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.575561046600342
pure train time :  0.531644344329834
train time :  0.7930641174316406
end to end time :  5.385981321334839
connection check time:  2.5947961807250977
block generation time  1.3490304946899414
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004115104675292969
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014642715454101562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49275827407836914
len local_batched_seeds_list  4
partition total batch output list spend :  0.6467859745025635
self.buckets_partition() spend  sec:  0.507434606552124
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042670488357543945

in edges time spent  0.1515967845916748
local to global src and eids time spent  0.2987029552459717
time gen tails  0.06486392021179199
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12479448318481445

in edges time spent  0.5898246765136719
local to global src and eids time spent  0.866767168045044
time gen tails  0.13486671447753906
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 0.09464073181152344  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 7.9255595207214355  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 7.924747943878174  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 0.09419679641723633  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 8.124041080474854  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.974609375 GB
    Memory Allocated: 8.127718448638916  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.09829282760620117  GigaBytes
Max Memory Allocated: 8.543493270874023  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.324007987976074  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.327408790588379  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.10241842269897461  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.185532569885254  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.188933372497559  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.11097240447998047  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3671858310699463
pure train time :  0.5276615619659424
train time :  0.7723484039306641
end to end time :  5.399321556091309
connection check time:  2.6214308738708496
block generation time  1.342940330505371
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005288124084472656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014252901077270508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48465514183044434
len local_batched_seeds_list  4
partition total batch output list spend :  0.6367044448852539
self.buckets_partition() spend  sec:  0.49894142150878906
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04254746437072754

in edges time spent  0.15182161331176758
local to global src and eids time spent  0.285341739654541
time gen tails  0.06504058837890625
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12776708602905273

in edges time spent  0.531423807144165
local to global src and eids time spent  0.8727984428405762
time gen tails  0.13413619995117188
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.0941004753112793  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 7.915768146514893  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 7.914888858795166  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.09395933151245117  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.154893398284912  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.158570766448975  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.09812068939208984  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.323788166046143  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.327188968658447  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.10231590270996094  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.180978775024414  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.184379577636719  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.11066484451293945  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2199463844299316
pure train time :  0.4986259937286377
train time :  0.7586712837219238
end to end time :  5.309394598007202
connection check time:  2.5527987480163574
block generation time  1.3455960750579834
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00038814544677734375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01424860954284668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3983893394470215
len local_batched_seeds_list  4
partition total batch output list spend :  0.550283670425415
self.buckets_partition() spend  sec:  0.41266846656799316
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043050289154052734

in edges time spent  0.1489722728729248
local to global src and eids time spent  0.2872645854949951
time gen tails  0.06426167488098145
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12931466102600098

in edges time spent  0.5253887176513672
local to global src and eids time spent  0.8617250919342041
time gen tails  0.13336491584777832
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.0938558578491211  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 7.916675567626953  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 7.915796279907227  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.09393548965454102  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.150026321411133  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.153703689575195  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 0.0983428955078125  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.32380723953247  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.15234375 GB
    Memory Allocated: 8.327208042144775  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10339975357055664  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.193388938903809  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.196969985961914  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11197185516357422  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1714792251586914
pure train time :  0.4930081367492676
train time :  0.7606265544891357
end to end time :  5.19989800453186
connection check time:  2.535196542739868
block generation time  1.33781099319458
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00037741661071777344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014241695404052734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4752349853515625
len local_batched_seeds_list  4
partition total batch output list spend :  0.6264729499816895
self.buckets_partition() spend  sec:  0.48951148986816406
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043241024017333984

in edges time spent  0.14777302742004395
local to global src and eids time spent  0.288801908493042
time gen tails  0.0641791820526123
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12756061553955078

in edges time spent  0.525554895401001
local to global src and eids time spent  0.8630356788635254
time gen tails  0.1342480182647705
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09437847137451172  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.92707633972168  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.926130294799805  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09396076202392578  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.141623973846436  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.145301342010498  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09823179244995117  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.311051845550537  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.314452648162842  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10253381729125977  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.186208248138428  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.189609050750732  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.1108865737915039  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.122007369995117
pure train time :  0.49849462509155273
train time :  0.7784669399261475
end to end time :  5.308426856994629
connection check time:  2.538450002670288
block generation time  1.3510394096374512
Run 00 | Epoch 00005 | Loss 3.1220 | Test 0.2377
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004324913024902344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014251708984375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44003820419311523
len local_batched_seeds_list  4
partition total batch output list spend :  0.5948314666748047
self.buckets_partition() spend  sec:  0.45432400703430176
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04527854919433594

in edges time spent  0.15578198432922363
local to global src and eids time spent  0.29364585876464844
time gen tails  0.06560587882995605
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.127333402633667

in edges time spent  0.6041927337646484
local to global src and eids time spent  0.8808867931365967
time gen tails  0.13518714904785156
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09395217895507812  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.925331115722656  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.924450874328613  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09392309188842773  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.136614799499512  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.140292167663574  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.0982809066772461  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.31848669052124  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.321887493133545  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10277128219604492  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.18296480178833  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.186708450317383  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.1114344596862793  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.057310104370117
pure train time :  0.4982311725616455
train time :  0.7705028057098389
end to end time :  5.399851322174072
connection check time:  2.6511852741241455
block generation time  1.358978271484375
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040268898010253906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014783382415771484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5077660083770752
len local_batched_seeds_list  4
partition total batch output list spend :  0.663383960723877
self.buckets_partition() spend  sec:  0.5225818157196045
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.06091666221618652

in edges time spent  0.15914106369018555
local to global src and eids time spent  0.2956569194793701
time gen tails  0.06894040107727051
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12710309028625488

in edges time spent  0.603996753692627
local to global src and eids time spent  0.8932807445526123
time gen tails  0.13721203804016113
res  length 4
block collection to dataloader spend  1.7404556274414062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09464740753173828  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.925337314605713  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.924457550048828  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09410667419433594  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.136468887329102  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.140146255493164  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09911632537841797  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.320484638214111  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.323885440826416  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10348796844482422  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.18359088897705  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.187171936035156  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11228179931640625  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.003438711166382
pure train time :  0.5124258995056152
train time :  0.784489631652832
end to end time :  5.5211896896362305
connection check time:  2.7167320251464844
block generation time  1.3407747745513916
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005035400390625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01412057876586914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.551715612411499
len local_batched_seeds_list  4
partition total batch output list spend :  0.7071988582611084
self.buckets_partition() spend  sec:  0.565871000289917
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042421579360961914

in edges time spent  0.15045857429504395
local to global src and eids time spent  0.2886965274810791
time gen tails  0.06658315658569336
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12392473220825195

in edges time spent  0.535468578338623
local to global src and eids time spent  0.8515584468841553
time gen tails  0.13338112831115723
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09463310241699219  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.959192752838135  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.958303928375244  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09392118453979492  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.126842021942139  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.130585670471191  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09827518463134766  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.313117980957031  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.316518783569336  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10234928131103516  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.188687801361084  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.192088603973389  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.1107020378112793  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9593777656555176
pure train time :  0.4848177433013916
train time :  0.7737841606140137
end to end time :  5.37017822265625
connection check time:  2.5343940258026123
block generation time  1.3346614837646484
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003883838653564453
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014393329620361328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5175952911376953
len local_batched_seeds_list  4
partition total batch output list spend :  0.6717696189880371
self.buckets_partition() spend  sec:  0.5320203304290771
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04272270202636719

in edges time spent  0.14795637130737305
local to global src and eids time spent  0.2868802547454834
time gen tails  0.06419062614440918
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12468576431274414

in edges time spent  0.5319695472717285
local to global src and eids time spent  0.8603799343109131
time gen tails  0.13260316848754883
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09407377243041992  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.971957206726074  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.971011638641357  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09387063980102539  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.123198509216309  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.126875877380371  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09909677505493164  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.319433212280273  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.322834014892578  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.1034846305847168  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.186402797698975  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.18998384475708  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11165618896484375  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.912024736404419
pure train time :  0.5015079975128174
train time :  0.7664563655853271
end to end time :  5.312617063522339
connection check time:  2.533324956893921
block generation time  1.325761079788208
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039768218994140625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014086723327636719
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.517676830291748
len local_batched_seeds_list  4
partition total batch output list spend :  0.6704583168029785
self.buckets_partition() spend  sec:  0.5318045616149902
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042799949645996094

in edges time spent  0.14776945114135742
local to global src and eids time spent  0.2866702079772949
time gen tails  0.06473064422607422
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1250617504119873

in edges time spent  0.5442588329315186
local to global src and eids time spent  0.8543002605438232
time gen tails  0.13290858268737793
res  length 4
block collection to dataloader spend  9.059906005859375e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09394025802612305  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.920894145965576  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.919948101043701  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09387063980102539  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.138679504394531  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.142356872558594  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09837675094604492  GigaBytes
Max Memory Allocated: 8.547760963439941  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.330626487731934  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.334027290344238  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10243558883666992  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.187062740325928  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.190463542938232  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11152458190917969  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.86515474319458
pure train time :  0.4958009719848633
train time :  0.7610158920288086
end to end time :  5.314518928527832
connection check time:  2.541181802749634
block generation time  1.328298568725586
Run 00 | Epoch 00010 | Loss 2.8652 | Test 0.2720
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003733634948730469
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014898538589477539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5154557228088379
len local_batched_seeds_list  4
partition total batch output list spend :  0.6710479259490967
self.buckets_partition() spend  sec:  0.530386209487915
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04395580291748047

in edges time spent  0.15703868865966797
local to global src and eids time spent  0.29349374771118164
time gen tails  0.0655214786529541
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12749695777893066

in edges time spent  0.5727944374084473
local to global src and eids time spent  0.8856470584869385
time gen tails  0.13882946968078613
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09477663040161133  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.956765174865723  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.955885410308838  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.0940241813659668  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.152201652526855  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.155561447143555  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09820032119750977  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.322968006134033  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.326368808746338  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10336112976074219  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.199772834777832  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.203353881835938  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11216306686401367  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.814675807952881
pure train time :  0.49532198905944824
train time :  0.7720050811767578
end to end time :  5.431346416473389
connection check time:  2.638549327850342
block generation time  1.3279340267181396
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004031658172607422
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014307737350463867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.554074764251709
len local_batched_seeds_list  4
partition total batch output list spend :  0.7108712196350098
self.buckets_partition() spend  sec:  0.5684187412261963
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0443875789642334

in edges time spent  0.15124154090881348
local to global src and eids time spent  0.28845787048339844
time gen tails  0.06469559669494629
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12589669227600098

in edges time spent  0.5400934219360352
local to global src and eids time spent  0.8564386367797852
time gen tails  0.13283443450927734
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09462594985961914  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.9260783195495605  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.925212860107422  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09386157989501953  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.139722347259521  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.143399715423584  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09826231002807617  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.326725006103516  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.33012580871582  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10231256484985352  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.181427001953125  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.18482780456543  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11066818237304688  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.763253927230835
pure train time :  0.48667454719543457
train time :  0.7583580017089844
end to end time :  5.360036373138428
connection check time:  2.5462286472320557
block generation time  1.326085090637207
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005040168762207031
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014042377471923828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5165805816650391
len local_batched_seeds_list  4
partition total batch output list spend :  0.670172929763794
self.buckets_partition() spend  sec:  0.530653715133667
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042359352111816406

in edges time spent  0.1487586498260498
local to global src and eids time spent  0.28839111328125
time gen tails  0.06445741653442383
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12639188766479492

in edges time spent  0.5254793167114258
local to global src and eids time spent  0.8573427200317383
time gen tails  0.13304805755615234
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09386920928955078  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.923182964324951  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.922236919403076  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09429597854614258  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.160966396331787  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.164326190948486  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09819841384887695  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.317575454711914  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.320976257324219  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10262823104858398  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.18023681640625  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.183980464935303  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11141014099121094  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.704498052597046
pure train time :  0.5097296237945557
train time :  0.7851910591125488
end to end time :  5.330170392990112
connection check time:  2.528623104095459
block generation time  1.3324074745178223
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040340423583984375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025174617767333984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5293741226196289
len local_batched_seeds_list  4
partition total batch output list spend :  0.698983907699585
self.buckets_partition() spend  sec:  0.554581880569458
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04614448547363281

in edges time spent  0.15384864807128906
local to global src and eids time spent  0.28989219665527344
time gen tails  0.06489706039428711
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12721800804138184

in edges time spent  0.5424740314483643
local to global src and eids time spent  0.8566672801971436
time gen tails  0.13364672660827637
res  length 4
block collection to dataloader spend  1.5735626220703125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09457778930664062  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.927611351013184  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.926700592041016  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09387350082397461  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.117541790008545  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.121219158172607  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09830331802368164  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.32629680633545  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.329697608947754  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10343074798583984  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.181957244873047  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.185538291931152  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11160135269165039  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6543681621551514
pure train time :  0.5001764297485352
train time :  0.7645211219787598
end to end time :  5.383270263671875
connection check time:  2.5567524433135986
block generation time  1.3420979976654053
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003960132598876953
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014045953750610352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5054183006286621
len local_batched_seeds_list  4
partition total batch output list spend :  0.6564781665802002
self.buckets_partition() spend  sec:  0.5195052623748779
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0451202392578125

in edges time spent  0.1518557071685791
local to global src and eids time spent  0.2886629104614258
time gen tails  0.0643155574798584
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12676119804382324

in edges time spent  0.5195457935333252
local to global src and eids time spent  0.7631950378417969
time gen tails  0.09805488586425781
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.0939168930053711  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.923948287963867  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.92300271987915  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09402942657470703  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.15192985534668  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.155607223510742  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09822750091552734  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.309670448303223  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.313071250915527  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10234212875366211  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.185409545898438  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.188810348510742  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.11146736145019531  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6081442832946777
pure train time :  0.49605369567871094
train time :  0.7514963150024414
end to end time :  5.165518283843994
connection check time:  2.4005038738250732
block generation time  1.3367435932159424
Run 00 | Epoch 00015 | Loss 2.6081 | Test 0.2965
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041604042053222656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016096830368041992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5020709037780762
len local_batched_seeds_list  4
partition total batch output list spend :  0.6581559181213379
self.buckets_partition() spend  sec:  0.5182015895843506
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04610705375671387

in edges time spent  0.1600782871246338
local to global src and eids time spent  0.29299378395080566
time gen tails  0.06555914878845215
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12418031692504883

in edges time spent  0.5968029499053955
local to global src and eids time spent  0.861884593963623
time gen tails  0.13524913787841797
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09424686431884766  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.917937278747559  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.9169921875  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09389352798461914  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.151178359985352  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.154855728149414  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09828615188598633  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.32204294204712  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.325443744659424  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.10339212417602539  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.184983730316162  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.188564777374268  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.1119084358215332  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5495712757110596
pure train time :  0.4933359622955322
train time :  0.7644600868225098
end to end time :  5.405004501342773
connection check time:  2.6264572143554688
block generation time  1.3400664329528809
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00038242340087890625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01389622688293457
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4198324680328369
len local_batched_seeds_list  4
partition total batch output list spend :  0.5732719898223877
self.buckets_partition() spend  sec:  0.4337594509124756
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.044716596603393555

in edges time spent  0.15261435508728027
local to global src and eids time spent  0.28992366790771484
time gen tails  0.06642746925354004
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12534475326538086

in edges time spent  0.5735306739807129
local to global src and eids time spent  0.9141874313354492
time gen tails  0.14215850830078125
res  length 4
block collection to dataloader spend  1.5497207641601562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09431695938110352  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.928154945373535  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 7.92720890045166  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.09394454956054688  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.146533012390137  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 8.1502103805542  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.154296875 GB
    Memory Allocated: 0.0989842414855957  GigaBytes
Max Memory Allocated: 8.5543794631958  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.333445072174072  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.336845874786377  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10221385955810547  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182721614837646  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186122417449951  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11122941970825195  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4976425170898438
pure train time :  0.5406982898712158
train time :  0.7901914119720459
end to end time :  5.510547876358032
connection check time:  2.685645341873169
block generation time  1.4382810592651367
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005049705505371094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014352798461914062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.542557954788208
len local_batched_seeds_list  4
partition total batch output list spend :  0.6982073783874512
self.buckets_partition() spend  sec:  0.5569467544555664
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04480695724487305

in edges time spent  0.15083694458007812
local to global src and eids time spent  0.29081058502197266
time gen tails  0.06451892852783203
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1267993450164795

in edges time spent  0.5707483291625977
local to global src and eids time spent  0.9109196662902832
time gen tails  0.14185190200805664
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09462499618530273  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926090717315674  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925201892852783  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09387350082397461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138677597045898  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14216661453247  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09927225112915039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32849645614624  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331897258758545  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10249567031860352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.204397201538086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.20779800415039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11185598373413086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.447526693344116
pure train time :  0.5643160343170166
train time :  0.8104045391082764
end to end time :  5.5935914516448975
connection check time:  2.6607933044433594
block generation time  1.4060876369476318
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039005279541015625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014148473739624023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5123131275177002
len local_batched_seeds_list  4
partition total batch output list spend :  0.6683337688446045
self.buckets_partition() spend  sec:  0.5264935493469238
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.045165300369262695

in edges time spent  0.1514580249786377
local to global src and eids time spent  0.288707971572876
time gen tails  0.06435155868530273
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12594318389892578

in edges time spent  0.5670139789581299
local to global src and eids time spent  0.864884614944458
time gen tails  0.13970327377319336
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0945277214050293  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.933207988739014  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.932260990142822  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939474105834961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127581119537354  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.131258487701416  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09910821914672852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324123859405518  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327524662017822  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1023101806640625  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18007230758667  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183473110198975  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11065244674682617  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4086477756500244
pure train time :  0.5329861640930176
train time :  0.8002662658691406
end to end time :  5.449014186859131
connection check time:  2.6080985069274902
block generation time  1.355078935623169
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042891502380371094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014600276947021484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5539376735687256
len local_batched_seeds_list  4
partition total batch output list spend :  0.7079904079437256
self.buckets_partition() spend  sec:  0.5685791969299316
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04301643371582031

in edges time spent  0.1512002944946289
local to global src and eids time spent  0.2881598472595215
time gen tails  0.0642702579498291
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12770915031433105

in edges time spent  0.5623736381530762
local to global src and eids time spent  0.8565094470977783
time gen tails  0.13453006744384766
res  length 4
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390115737915039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921113014221191  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920233726501465  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397602081298828  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149935722351074  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.153613090515137  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09830045700073242  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320588111877441  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323988914489746  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10235357284545898  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181756973266602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185157775878906  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1107034683227539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.367976427078247
pure train time :  0.5369598865509033
train time :  0.7836339473724365
end to end time :  5.418880224227905
connection check time:  2.569343328475952
block generation time  1.3328001499176025
Run 00 | Epoch 00020 | Loss 2.3680 | Test 0.4571
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00037407875061035156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014933586120605469
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5503745079040527
len local_batched_seeds_list  4
partition total batch output list spend :  0.704951286315918
self.buckets_partition() spend  sec:  0.565342903137207
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04567551612854004

in edges time spent  0.1571798324584961
local to global src and eids time spent  0.29103875160217285
time gen tails  0.0652015209197998
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12912797927856445

in edges time spent  0.570305585861206
local to global src and eids time spent  0.8637950420379639
time gen tails  0.13603448867797852
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09410572052001953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.969374179840088  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.968428611755371  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0940241813659668  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.124127864837646  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127805233001709  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821939468383789  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31842851638794  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321829319000244  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10276412963867188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186076164245605  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189819812774658  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11150169372558594  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.330249786376953
pure train time :  0.4906172752380371
train time :  0.7758095264434814
end to end time :  5.452693939208984
connection check time:  2.6099894046783447
block generation time  1.3438215255737305
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041222572326660156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027875185012817383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5090711116790771
len local_batched_seeds_list  4
partition total batch output list spend :  0.6765141487121582
self.buckets_partition() spend  sec:  0.5369794368743896
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04296374320983887

in edges time spent  0.1493678092956543
local to global src and eids time spent  0.28664708137512207
time gen tails  0.0645897388458252
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12636089324951172

in edges time spent  0.5379433631896973
local to global src and eids time spent  0.8679111003875732
time gen tails  0.1368885040283203
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09468412399291992  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.961041450500488  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9600958824157715  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394168853759766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142518997192383  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.146196365356445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09833812713623047  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32448434829712  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327885150909424  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1023569107055664  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180588722229004  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183989524841309  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1112985610961914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.295522928237915
pure train time :  0.5063068866729736
train time :  0.7735838890075684
end to end time :  5.355048418045044
connection check time:  2.559807062149048
block generation time  1.3311378955841064
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00046443939208984375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014563322067260742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5295610427856445
len local_batched_seeds_list  4
partition total batch output list spend :  0.6854379177093506
self.buckets_partition() spend  sec:  0.544156551361084
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04281258583068848

in edges time spent  0.15124130249023438
local to global src and eids time spent  0.18500685691833496
time gen tails  0.046698808670043945
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1315934658050537

in edges time spent  0.5516021251678467
local to global src and eids time spent  0.7992265224456787
time gen tails  0.10976934432983398
res  length 4
block collection to dataloader spend  9.059906005859375e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09401893615722656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9669904708862305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.966879367828369  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09379005432128906  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138549327850342  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141909122467041  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09825277328491211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32118034362793  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324581146240234  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10280561447143555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.191192150115967  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19493579864502  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11080312728881836  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.260563850402832
pure train time :  0.4850132465362549
train time :  0.7536740303039551
end to end time :  5.1470842361450195
connection check time:  2.3705356121063232
block generation time  1.3221385478973389
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.000408172607421875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014089345932006836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5154235363006592
len local_batched_seeds_list  4
partition total batch output list spend :  0.6694290637969971
self.buckets_partition() spend  sec:  0.5295450687408447
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042725563049316406

in edges time spent  0.14777708053588867
local to global src and eids time spent  0.2861366271972656
time gen tails  0.06463313102722168
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12430286407470703

in edges time spent  0.5266149044036865
local to global src and eids time spent  0.8567891120910645
time gen tails  0.13268423080444336
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09376668930053711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92489767074585  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923952102661133  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09375762939453125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.131146430969238  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1348237991333  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09832382202148438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322604179382324  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326004981994629  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1023402214050293  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18036699295044  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183767795562744  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11095428466796875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.216094493865967
pure train time :  0.5045876502990723
train time :  0.7710938453674316
end to end time :  5.3004231452941895
connection check time:  2.5231406688690186
block generation time  1.3217566013336182
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004215240478515625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014485597610473633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5304138660430908
len local_batched_seeds_list  4
partition total batch output list spend :  0.6831090450286865
self.buckets_partition() spend  sec:  0.5449409484863281
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04259991645812988

in edges time spent  0.14682531356811523
local to global src and eids time spent  0.2878265380859375
time gen tails  0.06456637382507324
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1256883144378662

in edges time spent  0.5254747867584229
local to global src and eids time spent  0.8579964637756348
time gen tails  0.1331648826599121
res  length 4
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0942697525024414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921519756317139  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920574188232422  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397649765014648  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147924423217773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151601791381836  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0990285873413086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323087692260742  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326488494873047  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10234355926513672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181354522705078  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184755325317383  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11086130142211914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.177731990814209
pure train time :  0.510772705078125
train time :  0.772150993347168
end to end time :  5.321514368057251
connection check time:  2.5254743099212646
block generation time  1.3271312713623047
Run 00 | Epoch 00025 | Loss 2.1777 | Test 0.4632
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00038051605224609375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015261173248291016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5524806976318359
len local_batched_seeds_list  4
partition total batch output list spend :  0.7077393531799316
self.buckets_partition() spend  sec:  0.5677759647369385
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04429507255554199

in edges time spent  0.15617823600769043
local to global src and eids time spent  0.2937002182006836
time gen tails  0.0643608570098877
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12830090522766113

in edges time spent  0.5839810371398926
local to global src and eids time spent  0.8729016780853271
time gen tails  0.13587021827697754
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397745132446289  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924821853637695  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923877239227295  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388875961303711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.12827205657959  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.131761074066162  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0991978645324707  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.315553665161133  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318954467773438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10246515274047852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184880256652832  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188281059265137  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11103534698486328  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1411662101745605
pure train time :  0.49995946884155273
train time :  0.7709226608276367
end to end time :  5.4619526863098145
connection check time:  2.622965097427368
block generation time  1.3414859771728516
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041961669921875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014809846878051758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5155987739562988
len local_batched_seeds_list  4
partition total batch output list spend :  0.6706664562225342
self.buckets_partition() spend  sec:  0.5304427146911621
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04497170448303223

in edges time spent  0.15642690658569336
local to global src and eids time spent  0.28707456588745117
time gen tails  0.06418395042419434
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12686848640441895

in edges time spent  0.5475442409515381
local to global src and eids time spent  0.85791015625
time gen tails  0.1325240135192871
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0941610336303711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.931646823883057  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930700778961182  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395456314086914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.150521755218506  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.154199123382568  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09827184677124023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.305069923400879  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.308470726013184  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10233545303344727  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181383609771729  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184784412384033  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11090660095214844  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.100487232208252
pure train time :  0.5159029960632324
train time :  0.7666525840759277
end to end time :  5.340506553649902
connection check time:  2.560807228088379
block generation time  1.326242446899414
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039076805114746094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014168262481689453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4829707145690918
len local_batched_seeds_list  4
partition total batch output list spend :  0.6341028213500977
self.buckets_partition() spend  sec:  0.49717092514038086
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04275369644165039

in edges time spent  0.14837932586669922
local to global src and eids time spent  0.28589344024658203
time gen tails  0.06386613845825195
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13119959831237793

in edges time spent  0.5397047996520996
local to global src and eids time spent  0.7619142532348633
time gen tails  0.09767889976501465
res  length 4
block collection to dataloader spend  8.821487426757812e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09412860870361328  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.914196014404297  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9133172035217285  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09381961822509766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139817714691162  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143495082855225  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09827804565429688  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328011512756348  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331412315368652  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10233497619628906  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19422435760498  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.197625160217285  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1106877326965332  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0625483989715576
pure train time :  0.48191189765930176
train time :  0.7443671226501465
end to end time :  5.13001561164856
connection check time:  2.4140548706054688
block generation time  1.322446346282959
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00036978721618652344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015299558639526367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.37148499488830566
len local_batched_seeds_list  4
partition total batch output list spend :  0.4619741439819336
self.buckets_partition() spend  sec:  0.38681602478027344
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.03998541831970215

in edges time spent  0.11387825012207031
local to global src and eids time spent  0.27031922340393066
time gen tails  0.06471824645996094
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12595748901367188

in edges time spent  0.5729575157165527
local to global src and eids time spent  0.8185701370239258
time gen tails  0.10526537895202637
res  length 4
block collection to dataloader spend  9.059906005859375e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389829635620117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927781105041504  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926835060119629  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393835067749023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13997507095337  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143652439117432  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09900045394897461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.309686660766602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.313087463378906  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10347366333007812  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.198303699493408  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.201884746551514  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11228609085083008  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0252037048339844
pure train time :  0.48061323165893555
train time :  0.756847620010376
end to end time :  5.020511865615845
connection check time:  2.450162649154663
block generation time  1.3324885368347168
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004596710205078125
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014481544494628906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48238587379455566
len local_batched_seeds_list  4
partition total batch output list spend :  0.6377928256988525
self.buckets_partition() spend  sec:  0.49691224098205566
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04669022560119629

in edges time spent  0.15162181854248047
local to global src and eids time spent  0.29501962661743164
time gen tails  0.06654095649719238
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12421393394470215

in edges time spent  0.583672046661377
local to global src and eids time spent  0.874375581741333
time gen tails  0.1332409381866455
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09450006484985352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.932680130004883  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.93173360824585  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390401840209961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145001888275146  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148361682891846  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09826278686523438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321858406066895  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.3252592086792  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1033792495727539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181648254394531  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185229301452637  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11154603958129883  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.993259072303772
pure train time :  0.5040233135223389
train time :  0.7721786499023438
end to end time :  5.394450426101685
connection check time:  2.6218342781066895
block generation time  1.3369948863983154
Run 00 | Epoch 00030 | Loss 1.9933 | Test 0.4559
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003571510314941406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015342235565185547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5120234489440918
len local_batched_seeds_list  4
partition total batch output list spend :  0.6016223430633545
self.buckets_partition() spend  sec:  0.5274004936218262
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04027390480041504

in edges time spent  0.1513676643371582
local to global src and eids time spent  0.28980326652526855
time gen tails  0.06481170654296875
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1268625259399414

in edges time spent  0.5374467372894287
local to global src and eids time spent  0.8580460548400879
time gen tails  0.13404273986816406
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403133392333984  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925847053527832  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924901485443115  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09398555755615234  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138003826141357  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14168119430542  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09839439392089844  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322478294372559  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325879096984863  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10231637954711914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183379650115967  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186780452728271  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11154985427856445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9537158012390137
pure train time :  0.5006005764007568
train time :  0.7964603900909424
end to end time :  5.3258748054504395
connection check time:  2.5438058376312256
block generation time  1.3671815395355225
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00037217140197753906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014936447143554688
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5179464817047119
len local_batched_seeds_list  4
partition total batch output list spend :  0.6717705726623535
self.buckets_partition() spend  sec:  0.5329141616821289
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04541420936584473

in edges time spent  0.16714954376220703
local to global src and eids time spent  0.2957775592803955
time gen tails  0.06563091278076172
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1269984245300293

in edges time spent  0.5817043781280518
local to global src and eids time spent  0.8595337867736816
time gen tails  0.1369941234588623
res  length 4
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09438276290893555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.935724258422852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.934779167175293  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09402608871459961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.134159564971924  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137519359588623  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09830141067504883  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321787357330322  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325188159942627  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10262489318847656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.177838325500488  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181581974029541  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11217689514160156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9238338470458984
pure train time :  0.4994332790374756
train time :  0.761465311050415
end to end time :  5.430859804153442
connection check time:  2.6229746341705322
block generation time  1.3580865859985352
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00046753883361816406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014521121978759766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5406661033630371
len local_batched_seeds_list  4
partition total batch output list spend :  0.6916179656982422
self.buckets_partition() spend  sec:  0.5552222728729248
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0431821346282959

in edges time spent  0.17368578910827637
local to global src and eids time spent  0.288891077041626
time gen tails  0.06471538543701172
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13573741912841797

in edges time spent  0.5468006134033203
local to global src and eids time spent  0.8597662448883057
time gen tails  0.13356971740722656
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09454870223999023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9195661544799805  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.91868782043457  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09400320053100586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148474216461182  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152151584625244  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828901290893555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328007698059082  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331408500671387  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10337638854980469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184454917907715  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18803596496582  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11221837997436523  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8909457921981812
pure train time :  0.4887123107910156
train time :  0.7638974189758301
end to end time :  5.397787094116211
connection check time:  2.5899112224578857
block generation time  1.3386600017547607
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003826618194580078
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014157772064208984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4810175895690918
len local_batched_seeds_list  4
partition total batch output list spend :  0.6303563117980957
self.buckets_partition() spend  sec:  0.4952061176300049
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042972564697265625

in edges time spent  0.1485288143157959
local to global src and eids time spent  0.2872810363769531
time gen tails  0.0638277530670166
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12463164329528809

in edges time spent  0.5283811092376709
local to global src and eids time spent  0.8793940544128418
time gen tails  0.14156794548034668
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0945591926574707  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.916014194488525  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.915135383605957  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939335823059082  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152605056762695  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.156282424926758  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09832525253295898  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324202060699463  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327602863311768  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.103485107421875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1829514503479  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186532497406006  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11165380477905273  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8611876964569092
pure train time :  0.5113623142242432
train time :  0.773967981338501
end to end time :  5.336333990097046
connection check time:  2.5742173194885254
block generation time  1.3406414985656738
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004031658172607422
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017798185348510742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5051083564758301
len local_batched_seeds_list  4
partition total batch output list spend :  0.6587440967559814
self.buckets_partition() spend  sec:  0.5229418277740479
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04441547393798828

in edges time spent  0.15172863006591797
local to global src and eids time spent  0.2903916835784912
time gen tails  0.0648958683013916
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1256725788116455

in edges time spent  0.5461578369140625
local to global src and eids time spent  0.8602101802825928
time gen tails  0.13440322875976562
res  length 4
block collection to dataloader spend  1.7404556274414062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09396171569824219  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921796798706055  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92085075378418  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09381818771362305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141767501831055  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145444869995117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09910297393798828  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320870876312256  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32427167892456  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10230636596679688  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179877758026123  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183278560638428  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11092710494995117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8388173580169678
pure train time :  0.5073943138122559
train time :  0.7892239093780518
end to end time :  5.359540939331055
connection check time:  2.561525583267212
block generation time  1.3299050331115723
Run 00 | Epoch 00035 | Loss 1.8388 | Test 0.4980
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003845691680908203
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014541149139404297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5570602416992188
len local_batched_seeds_list  4
partition total batch output list spend :  0.7113511562347412
self.buckets_partition() spend  sec:  0.5716397762298584
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0456392765045166

in edges time spent  0.1565837860107422
local to global src and eids time spent  0.29022836685180664
time gen tails  0.06519746780395508
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.125823974609375

in edges time spent  0.5661165714263916
local to global src and eids time spent  0.8620710372924805
time gen tails  0.1347804069519043
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09412622451782227  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919551849365234  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918607234954834  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09401369094848633  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.157888889312744  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.161566257476807  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0981454849243164  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318513870239258  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321914672851562  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10281753540039062  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184083461761475  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187827110290527  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11115550994873047  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8068667650222778
pure train time :  0.501469612121582
train time :  0.7767829895019531
end to end time :  5.4464569091796875
connection check time:  2.588693618774414
block generation time  1.3444924354553223
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003769397735595703
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014533281326293945
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4810047149658203
len local_batched_seeds_list  4
partition total batch output list spend :  0.6330089569091797
self.buckets_partition() spend  sec:  0.49556875228881836
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04300546646118164

in edges time spent  0.181596040725708
local to global src and eids time spent  0.28644323348999023
time gen tails  0.06583189964294434
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12819433212280273

in edges time spent  0.5446484088897705
local to global src and eids time spent  0.8532044887542725
time gen tails  0.1347048282623291
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0942678451538086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.931222915649414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930276393890381  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392690658569336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.128847122192383  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132590770721436  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09906530380249023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318304538726807  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321705341339111  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024928092956543  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19635534286499  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.199756145477295  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11145305633544922  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7799590826034546
pure train time :  0.5083792209625244
train time :  0.7670371532440186
end to end time :  5.334928750991821
connection check time:  2.581423759460449
block generation time  1.3405356407165527
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004627704620361328
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01759052276611328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.517164945602417
len local_batched_seeds_list  4
partition total batch output list spend :  0.6743814945220947
self.buckets_partition() spend  sec:  0.5347878932952881
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04389643669128418

in edges time spent  0.15375947952270508
local to global src and eids time spent  0.29033970832824707
time gen tails  0.06519818305969238
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13005876541137695

in edges time spent  0.562619686126709
local to global src and eids time spent  0.8998146057128906
time gen tails  0.14449787139892578
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09444379806518555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.913784027099609  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.912890911102295  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395503997802734  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.156093120574951  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.159770488739014  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09825944900512695  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320510864257812  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323911666870117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10357093811035156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185981750488281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189562797546387  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1119837760925293  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7539353370666504
pure train time :  0.529395341873169
train time :  0.7894153594970703
end to end time :  5.52018666267395
connection check time:  2.6554906368255615
block generation time  1.3871684074401855
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003981590270996094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014036893844604492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5045533180236816
len local_batched_seeds_list  4
partition total batch output list spend :  0.6536736488342285
self.buckets_partition() spend  sec:  0.518622875213623
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04383134841918945

in edges time spent  0.1568279266357422
local to global src and eids time spent  0.292041540145874
time gen tails  0.06554698944091797
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12448644638061523

in edges time spent  0.5265214443206787
local to global src and eids time spent  0.7844216823577881
time gen tails  0.10819673538208008
res  length 4
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09419441223144531  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924954891204834  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924008846282959  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394502639770508  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143959522247314  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147319316864014  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09839534759521484  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.332942008972168  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.336342811584473  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1033182144165039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.196695804595947  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.200276851654053  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11213064193725586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7304112911224365
pure train time :  0.48647236824035645
train time :  0.7509200572967529
end to end time :  5.203749656677246
connection check time:  2.4473395347595215
block generation time  1.3376095294952393
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041103363037109375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015308141708374023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5031592845916748
len local_batched_seeds_list  4
partition total batch output list spend :  0.5964484214782715
self.buckets_partition() spend  sec:  0.5185117721557617
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.044550418853759766

in edges time spent  0.15242290496826172
local to global src and eids time spent  0.2908651828765869
time gen tails  0.06584954261779785
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12611174583435059

in edges time spent  0.5283770561218262
local to global src and eids time spent  0.8521938323974609
time gen tails  0.13401198387145996
res  length 4
block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09462261199951172  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9387359619140625  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.937880039215088  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939035415649414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132996082305908  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13667345046997  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982356071472168  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323041915893555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32644271850586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10239648818969727  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181752681732178  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185153484344482  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1107473373413086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.703468680381775
pure train time :  0.5164170265197754
train time :  0.7747762203216553
end to end time :  5.260465145111084
connection check time:  2.533726692199707
block generation time  1.3377256393432617
Run 00 | Epoch 00040 | Loss 1.7035 | Test 0.5176
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004112720489501953
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01577591896057129
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.563854455947876
len local_batched_seeds_list  4
partition total batch output list spend :  0.7213311195373535
self.buckets_partition() spend  sec:  0.5796678066253662
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04649543762207031

in edges time spent  0.1541147232055664
local to global src and eids time spent  0.2898528575897217
time gen tails  0.06620931625366211
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12880754470825195

in edges time spent  0.5595521926879883
local to global src and eids time spent  0.8678371906280518
time gen tails  0.1341865062713623
res  length 4
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393310546875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930293083190918  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929347515106201  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384012222290039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.12431812286377  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127995491027832  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09829521179199219  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.316848754882812  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320249557495117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10239982604980469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18218183517456  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185582637786865  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11075925827026367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.686100721359253
pure train time :  0.48905491828918457
train time :  0.7681448459625244
end to end time :  5.457887172698975
connection check time:  2.590686798095703
block generation time  1.3584034442901611
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003788471221923828
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014412403106689453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4176828861236572
len local_batched_seeds_list  4
partition total batch output list spend :  0.5716283321380615
self.buckets_partition() spend  sec:  0.4321293830871582
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04326629638671875

in edges time spent  0.16035008430480957
local to global src and eids time spent  0.2886991500854492
time gen tails  0.06595134735107422
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13219952583312988

in edges time spent  0.552692174911499
local to global src and eids time spent  0.8568100929260254
time gen tails  0.13441705703735352
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397649765014648  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.962841987609863  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9619622230529785  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388065338134766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137314796447754  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140992164611816  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821844100952148  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324944019317627  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329291820526123  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1026763916015625  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18393325805664  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187676906585693  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1112985610961914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.662001609802246
pure train time :  0.4933583736419678
train time :  0.7599911689758301
end to end time :  5.276164531707764
connection check time:  2.5786943435668945
block generation time  1.3497602939605713
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004642009735107422
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01418614387512207
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48636412620544434
len local_batched_seeds_list  4
partition total batch output list spend :  0.6383602619171143
self.buckets_partition() spend  sec:  0.5005812644958496
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04304385185241699

in edges time spent  0.14656472206115723
local to global src and eids time spent  0.28800225257873535
time gen tails  0.06504702568054199
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13058972358703613

in edges time spent  0.5406432151794434
local to global src and eids time spent  0.8572044372558594
time gen tails  0.1340019702911377
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09451961517333984  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.955784797668457  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.95483922958374  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09387445449829102  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.134713649749756  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138073444366455  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09827423095703125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321205139160156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324605941772461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1035151481628418  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181817531585693  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185398578643799  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11175918579101562  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.639963984489441
pure train time :  0.5122265815734863
train time :  0.766085147857666
end to end time :  5.307814121246338
connection check time:  2.5492796897888184
block generation time  1.3377060890197754
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003895759582519531
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014581441879272461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5131726264953613
len local_batched_seeds_list  4
partition total batch output list spend :  0.6671872138977051
self.buckets_partition() spend  sec:  0.527787446975708
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04253053665161133

in edges time spent  0.14683985710144043
local to global src and eids time spent  0.28682684898376465
time gen tails  0.06496024131774902
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12743496894836426

in edges time spent  0.5293607711791992
local to global src and eids time spent  0.8572080135345459
time gen tails  0.13411903381347656
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394025802612305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921932220458984  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920986652374268  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390592575073242  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141203880310059  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144881248474121  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09830474853515625  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32475233078003  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328153133392334  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10328960418701172  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181592464447021  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184708595275879  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11075925827026367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6239559650421143
pure train time :  0.5073366165161133
train time :  0.7699239253997803
end to end time :  5.319086313247681
connection check time:  2.532719135284424
block generation time  1.3355216979980469
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039076805114746094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014530658721923828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.515416145324707
len local_batched_seeds_list  4
partition total batch output list spend :  0.6710803508758545
self.buckets_partition() spend  sec:  0.5299875736236572
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04268312454223633

in edges time spent  0.14661145210266113
local to global src and eids time spent  0.287106990814209
time gen tails  0.06512951850891113
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12563276290893555

in edges time spent  0.5432281494140625
local to global src and eids time spent  0.8541522026062012
time gen tails  0.1342484951019287
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09424543380737305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.963048934936523  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.962169647216797  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09386444091796875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136459827423096  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139819622039795  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828996658325195  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.315147399902344  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318548202514648  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10339498519897461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.162193775177002  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.165774822235107  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11246538162231445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6040911674499512
pure train time :  0.5010623931884766
train time :  0.7658834457397461
end to end time :  5.327212333679199
connection check time:  2.5419695377349854
block generation time  1.3341739177703857
Run 00 | Epoch 00045 | Loss 1.6041 | Test 0.5466
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004017353057861328
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014953136444091797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5633656978607178
len local_batched_seeds_list  4
partition total batch output list spend :  0.7207052707672119
self.buckets_partition() spend  sec:  0.5783557891845703
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.044782400131225586

in edges time spent  0.1585986614227295
local to global src and eids time spent  0.2886524200439453
time gen tails  0.0660548210144043
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12909150123596191

in edges time spent  0.5817883014678955
local to global src and eids time spent  0.8399045467376709
time gen tails  0.10139822959899902
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09446907043457031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.928478240966797  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927591323852539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09398126602172852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140375137329102  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144118785858154  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831047058105469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328153610229492  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331554412841797  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10238122940063477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182390689849854  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185791492462158  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11129617691040039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5807313919067383
pure train time :  0.4851808547973633
train time :  0.7677938938140869
end to end time :  5.452504873275757
connection check time:  2.565971851348877
block generation time  1.3804693222045898
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003750324249267578
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01591634750366211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4857523441314697
len local_batched_seeds_list  4
partition total batch output list spend :  0.5805399417877197
self.buckets_partition() spend  sec:  0.5017015933990479
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04444527626037598

in edges time spent  0.14980006217956543
local to global src and eids time spent  0.2879610061645508
time gen tails  0.06564140319824219
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12905168533325195

in edges time spent  0.579798698425293
local to global src and eids time spent  0.9102871417999268
time gen tails  0.14249587059020996
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09420299530029297  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9265923500061035  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925713539123535  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09415388107299805  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147390365600586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151067733764648  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09907102584838867  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324572563171387  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327973365783691  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10345220565795898  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18974256515503  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.193323612213135  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11229228973388672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5620189905166626
pure train time :  0.49564576148986816
train time :  0.7588534355163574
end to end time :  5.4082372188568115
connection check time:  2.665148973464966
block generation time  1.3896188735961914
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00048661231994628906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014683246612548828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5212647914886475
len local_batched_seeds_list  4
partition total batch output list spend :  0.6767570972442627
self.buckets_partition() spend  sec:  0.5359809398651123
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04326033592224121

in edges time spent  0.1473848819732666
local to global src and eids time spent  0.28933215141296387
time gen tails  0.06502008438110352
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13445734977722168

in edges time spent  0.5396089553833008
local to global src and eids time spent  0.8585360050201416
time gen tails  0.13549351692199707
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09450340270996094  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924932956695557  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924053192138672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939779281616211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14383602142334  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147513389587402  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09827136993408203  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319779872894287  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323180675506592  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10354089736938477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.194486618041992  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.198067665100098  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11334991455078125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5473835468292236
pure train time :  0.4942631721496582
train time :  0.7529788017272949
end to end time :  5.340728521347046
connection check time:  2.5584664344787598
block generation time  1.3389642238616943
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041937828063964844
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01423501968383789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5168027877807617
len local_batched_seeds_list  4
partition total batch output list spend :  0.6721303462982178
self.buckets_partition() spend  sec:  0.531069278717041
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0464634895324707

in edges time spent  0.1555955410003662
local to global src and eids time spent  0.28858351707458496
time gen tails  0.06745338439941406
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1285409927368164

in edges time spent  0.5500125885009766
local to global src and eids time spent  0.8748807907104492
time gen tails  0.13894033432006836
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09472370147705078  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921905994415283  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921109199523926  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09396886825561523  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140758037567139  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144435405731201  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821891784667969  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.317138195037842  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320538997650146  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10248279571533203  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183509826660156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186910629272461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11083555221557617  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5329833030700684
pure train time :  0.48323774337768555
train time :  0.7506933212280273
end to end time :  5.398123502731323
connection check time:  2.6038599014282227
block generation time  1.3529765605926514
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039839744567871094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015061140060424805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5330729484558105
len local_batched_seeds_list  4
partition total batch output list spend :  0.6893789768218994
self.buckets_partition() spend  sec:  0.5481734275817871
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04261207580566406

in edges time spent  0.14977717399597168
local to global src and eids time spent  0.28931164741516113
time gen tails  0.06581306457519531
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12709784507751465

in edges time spent  0.5718193054199219
local to global src and eids time spent  0.8760755062103271
time gen tails  0.13538336753845215
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09400415420532227  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930508136749268  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929562091827393  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403610229492188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1573166847229  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.161060333251953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09824800491333008  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322842121124268  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326242923736572  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1034688949584961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180694103240967  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184275150299072  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1116628646850586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.512730598449707
pure train time :  0.49634528160095215
train time :  0.7666797637939453
end to end time :  5.416650772094727
connection check time:  2.601799964904785
block generation time  1.339550495147705
Run 00 | Epoch 00050 | Loss 1.5127 | Test 0.5503
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004165172576904297
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013901233673095703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.553372859954834
len local_batched_seeds_list  4
partition total batch output list spend :  0.7065849304199219
self.buckets_partition() spend  sec:  0.5673112869262695
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04325294494628906

in edges time spent  0.14833378791809082
local to global src and eids time spent  0.2885010242462158
time gen tails  0.06499481201171875
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1290733814239502

in edges time spent  0.5262882709503174
local to global src and eids time spent  0.851994514465332
time gen tails  0.13394761085510254
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392166137695312  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924619674682617  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9236741065979  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09400749206542969  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.15707540512085  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.160752773284912  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09833478927612305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320602893829346  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324346542358398  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10344457626342773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188287734985352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.191868782043457  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11190223693847656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4983090162277222
pure train time :  0.49315905570983887
train time :  0.767507791519165
end to end time :  5.368185043334961
connection check time:  2.5289952754974365
block generation time  1.3490402698516846
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004410743713378906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01442718505859375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4822371006011963
len local_batched_seeds_list  4
partition total batch output list spend :  0.6312451362609863
self.buckets_partition() spend  sec:  0.49669480323791504
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042868614196777344

in edges time spent  0.14687633514404297
local to global src and eids time spent  0.2868678569793701
time gen tails  0.0635983943939209
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12829875946044922

in edges time spent  0.5307083129882812
local to global src and eids time spent  0.8585159778594971
time gen tails  0.13470220565795898
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0940399169921875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.931915283203125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.931036472320557  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09383964538574219  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.126620292663574  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.130297660827637  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09837722778320312  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322511196136475  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32591199874878  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10245418548583984  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19761037826538  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.200726509094238  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1110386848449707  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4940102100372314
pure train time :  0.5046145915985107
train time :  0.7684926986694336
end to end time :  5.295278549194336
connection check time:  2.5369017124176025
block generation time  1.3411061763763428
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005018711090087891
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014629602432250977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4621560573577881
len local_batched_seeds_list  4
partition total batch output list spend :  0.5523664951324463
self.buckets_partition() spend  sec:  0.47681736946105957
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.040456533432006836

in edges time spent  0.1662440299987793
local to global src and eids time spent  0.2874112129211426
time gen tails  0.06516218185424805
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13076138496398926

in edges time spent  0.5291290283203125
local to global src and eids time spent  0.8631443977355957
time gen tails  0.1348419189453125
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09417581558227539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922377109527588  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921430587768555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394121170043945  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136320114135742  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139997482299805  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09810733795166016  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319555759429932  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322956562042236  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10276079177856445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190564155578613  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.194307804107666  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11111259460449219  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.476956844329834
pure train time :  0.49779844284057617
train time :  0.7582967281341553
end to end time :  5.220824718475342
connection check time:  2.556925058364868
block generation time  1.337017297744751
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003783702850341797
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014423370361328125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.42697739601135254
len local_batched_seeds_list  4
partition total batch output list spend :  0.581336259841919
self.buckets_partition() spend  sec:  0.4414327144622803
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043190717697143555

in edges time spent  0.14672422409057617
local to global src and eids time spent  0.2858741283416748
time gen tails  0.06502437591552734
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13372325897216797

in edges time spent  0.5331063270568848
local to global src and eids time spent  0.8723838329315186
time gen tails  0.13724589347839355
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09432411193847656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.937891006469727  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.936944484710693  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09402322769165039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145842552185059  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149519920349121  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09824419021606445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31978702545166  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323187828063965  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10234355926513672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185506820678711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188907623291016  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11093282699584961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4636168479919434
pure train time :  0.5102941989898682
train time :  0.7760193347930908
end to end time :  5.273409128189087
connection check time:  2.562037467956543
block generation time  1.338810920715332
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003829002380371094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01417684555053711
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4973733425140381
len local_batched_seeds_list  4
partition total batch output list spend :  0.6502466201782227
self.buckets_partition() spend  sec:  0.5115888118743896
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04294633865356445

in edges time spent  0.15031957626342773
local to global src and eids time spent  0.2940676212310791
time gen tails  0.06746697425842285
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12723398208618164

in edges time spent  0.5700440406799316
local to global src and eids time spent  0.865288496017456
time gen tails  0.137359619140625
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09424829483032227  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.931042194366455  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930096626281738  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403848648071289  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14768123626709  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151041030883789  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823751449584961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320903778076172  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324304580688477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10227680206298828  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18009901046753  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183499813079834  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11116170883178711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.452775239944458
pure train time :  0.5310459136962891
train time :  0.7807018756866455
end to end time :  5.394840955734253
connection check time:  2.5994043350219727
block generation time  1.3504557609558105
Run 00 | Epoch 00055 | Loss 1.4528 | Test 0.5703
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004012584686279297
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014519453048706055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5463318824768066
len local_batched_seeds_list  4
partition total batch output list spend :  0.6990697383880615
self.buckets_partition() spend  sec:  0.5608890056610107
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.05426812171936035

in edges time spent  0.1691150665283203
local to global src and eids time spent  0.2926216125488281
time gen tails  0.0666816234588623
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.126450777053833

in edges time spent  0.5778803825378418
local to global src and eids time spent  0.8668689727783203
time gen tails  0.1359109878540039
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0943150520324707  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.93215799331665  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.931212902069092  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397459030151367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138404846191406  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142082214355469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09898185729980469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.289746761322021  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.293147563934326  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10347652435302734  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185529232025146  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189110279083252  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11165761947631836  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.439632534980774
pure train time :  0.49810075759887695
train time :  0.7821521759033203
end to end time :  5.489079475402832
connection check time:  2.634655237197876
block generation time  1.3528804779052734
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004258155822753906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014385700225830078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.505171537399292
len local_batched_seeds_list  4
partition total batch output list spend :  0.654895544052124
self.buckets_partition() spend  sec:  0.51959228515625
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.044532060623168945

in edges time spent  0.15456557273864746
local to global src and eids time spent  0.2879915237426758
time gen tails  0.06547331809997559
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12586498260498047

in edges time spent  0.5697996616363525
local to global src and eids time spent  0.8633675575256348
time gen tails  0.13414263725280762
res  length 4
block collection to dataloader spend  1.52587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09387874603271484  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9132280349731445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.91234827041626  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393453598022461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152733325958252  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.156410694122314  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0985708236694336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32209587097168  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325839519500732  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10334444046020508  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.177844047546387  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181425094604492  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1117701530456543  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4267971515655518
pure train time :  0.5001316070556641
train time :  0.760317325592041
end to end time :  5.368287563323975
connection check time:  2.588289737701416
block generation time  1.343975305557251
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003952980041503906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014079809188842773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49213266372680664
len local_batched_seeds_list  4
partition total batch output list spend :  0.6420111656188965
self.buckets_partition() spend  sec:  0.5062465667724609
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043140411376953125

in edges time spent  0.14852476119995117
local to global src and eids time spent  0.28698205947875977
time gen tails  0.06524777412414551
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.126617431640625

in edges time spent  0.5249812602996826
local to global src and eids time spent  0.8587696552276611
time gen tails  0.13475894927978516
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0940704345703125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927687644958496  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9276347160339355  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09399032592773438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.15277099609375  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.156514644622803  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982675552368164  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318657875061035  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32205867767334  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1023397445678711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182698249816895  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1860990524292  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11068964004516602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4171980619430542
pure train time :  0.5162978172302246
train time :  0.7723016738891602
end to end time :  5.303447008132935
connection check time:  2.5315394401550293
block generation time  1.3439595699310303
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003979206085205078
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01417994499206543
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5164151191711426
len local_batched_seeds_list  4
partition total batch output list spend :  0.6699135303497314
self.buckets_partition() spend  sec:  0.5306284427642822
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04312729835510254

in edges time spent  0.1462574005126953
local to global src and eids time spent  0.287006139755249
time gen tails  0.06503868103027344
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1248323917388916

in edges time spent  0.5322203636169434
local to global src and eids time spent  0.8556830883026123
time gen tails  0.13425946235656738
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09386444091796875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.914219856262207  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.91327428817749  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938873291015625  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13965892791748  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143147945404053  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09922981262207031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.316652297973633  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320053100585938  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1027212142944336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179811954498291  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183555603027344  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11073589324951172  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4045510292053223
pure train time :  0.4956228733062744
train time :  0.7541375160217285
end to end time :  5.312089681625366
connection check time:  2.5300915241241455
block generation time  1.3404409885406494
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003695487976074219
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014058113098144531
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4836280345916748
len local_batched_seeds_list  4
partition total batch output list spend :  0.6326992511749268
self.buckets_partition() spend  sec:  0.4977266788482666
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04240536689758301

in edges time spent  0.1470661163330078
local to global src and eids time spent  0.18466448783874512
time gen tails  0.04802751541137695
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12769770622253418

in edges time spent  0.5298655033111572
local to global src and eids time spent  0.8597579002380371
time gen tails  0.13472843170166016
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09380149841308594  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921609401702881  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920663356781006  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393501281738281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.134364128112793  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137723922729492  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09830522537231445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323261737823486  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326662540435791  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10347557067871094  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18283462524414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186415672302246  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11164617538452148  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3982398509979248
pure train time :  0.5199329853057861
train time :  0.7669374942779541
end to end time :  5.17100191116333
connection check time:  2.417663097381592
block generation time  1.3411059379577637
Run 00 | Epoch 00060 | Loss 1.3982 | Test 0.5978
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039505958557128906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014994382858276367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4849872589111328
len local_batched_seeds_list  4
partition total batch output list spend :  0.6373746395111084
self.buckets_partition() spend  sec:  0.5000135898590088
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.047293901443481445

in edges time spent  0.16391730308532715
local to global src and eids time spent  0.2898421287536621
time gen tails  0.06631302833557129
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1256246566772461

in edges time spent  0.5847141742706299
local to global src and eids time spent  0.8794748783111572
time gen tails  0.13533735275268555
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09383487701416016  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924831867218018  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923885822296143  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09387922286987305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136300086975098  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13997745513916  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831619262695312  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325126647949219  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328527450561523  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10342979431152344  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183804512023926  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187385559082031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11160039901733398  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3839001655578613
pure train time :  0.512995719909668
train time :  0.7815120220184326
end to end time :  5.429205656051636
connection check time:  2.6376819610595703
block generation time  1.3590784072875977
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004000663757324219
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014213323593139648
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5079567432403564
len local_batched_seeds_list  4
partition total batch output list spend :  0.6593754291534424
self.buckets_partition() spend  sec:  0.5222055912017822
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04313802719116211

in edges time spent  0.15346980094909668
local to global src and eids time spent  0.2916231155395508
time gen tails  0.0654599666595459
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12677502632141113

in edges time spent  0.5350077152252197
local to global src and eids time spent  0.8633158206939697
time gen tails  0.13483786582946777
res  length 4
block collection to dataloader spend  1.239776611328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390783309936523  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918427467346191  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918344974517822  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390544891357422  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147449970245361  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151127338409424  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09834671020507812  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322880268096924  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326281070709229  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10265970230102539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18035888671875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184102535247803  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11065816879272461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3752213716506958
pure train time :  0.5038056373596191
train time :  0.7648918628692627
end to end time :  5.357839584350586
connection check time:  2.5586371421813965
block generation time  1.3545637130737305
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004811286926269531
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013987302780151367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48136186599731445
len local_batched_seeds_list  4
partition total batch output list spend :  0.6315491199493408
self.buckets_partition() spend  sec:  0.495380163192749
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04301762580871582

in edges time spent  0.148895263671875
local to global src and eids time spent  0.2876467704772949
time gen tails  0.06535029411315918
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12689447402954102

in edges time spent  0.5385777950286865
local to global src and eids time spent  0.8699467182159424
time gen tails  0.13495635986328125
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09402084350585938  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921270370483398  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920324802398682  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389829635620117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.153815746307373  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.157493114471436  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09911870956420898  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325880527496338  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329281330108643  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10344934463500977  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182099342346191  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185680389404297  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11161422729492188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.368271827697754
pure train time :  0.504178524017334
train time :  0.7642922401428223
end to end time :  5.3250861167907715
connection check time:  2.559751272201538
block generation time  1.3491928577423096
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004172325134277344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014207124710083008
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48428869247436523
len local_batched_seeds_list  4
partition total batch output list spend :  0.6360821723937988
self.buckets_partition() spend  sec:  0.49852705001831055
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04274773597717285

in edges time spent  0.1500561237335205
local to global src and eids time spent  0.28760266304016113
time gen tails  0.06551408767700195
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12891435623168945

in edges time spent  0.5432960987091064
local to global src and eids time spent  0.8616044521331787
time gen tails  0.1354656219482422
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392309188842773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.928159236907959  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927213668823242  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388351440429688  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.126378536224365  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.130122184753418  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09911584854125977  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322768688201904  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326169490814209  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10240936279296875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183262825012207  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186663627624512  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11075639724731445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3575572967529297
pure train time :  0.523836612701416
train time :  0.7799484729766846
end to end time :  5.341898441314697
connection check time:  2.558805465698242
block generation time  1.3548624515533447
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042319297790527344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014099836349487305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4956076145172119
len local_batched_seeds_list  4
partition total batch output list spend :  0.6470918655395508
self.buckets_partition() spend  sec:  0.5097484588623047
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04318571090698242

in edges time spent  0.1501152515411377
local to global src and eids time spent  0.2871828079223633
time gen tails  0.06518340110778809
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1293351650238037

in edges time spent  0.5642786026000977
local to global src and eids time spent  0.9015181064605713
time gen tails  0.14034104347229004
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392261505126953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924982070922852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924036502838135  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09382104873657227  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.135787010192871  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139464378356934  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09840822219848633  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321465015411377  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324865818023682  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10251188278198242  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187694549560547  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.191095352172852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11086273193359375  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.353588581085205
pure train time :  0.4950838088989258
train time :  0.7677474021911621
end to end time :  5.42529821395874
connection check time:  2.6350507736206055
block generation time  1.358701229095459
Run 00 | Epoch 00065 | Loss 1.3536 | Test 0.5969
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004456043243408203
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01569509506225586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5208277702331543
len local_batched_seeds_list  4
partition total batch output list spend :  0.673107385635376
self.buckets_partition() spend  sec:  0.5365614891052246
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04616737365722656

in edges time spent  0.1579277515411377
local to global src and eids time spent  0.29212212562561035
time gen tails  0.06565141677856445
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12744927406311035

in edges time spent  0.5548264980316162
local to global src and eids time spent  0.8608019351959229
time gen tails  0.1369473934173584
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388065338134766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927731037139893  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926784515380859  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09391355514526367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143902778625488  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147262573242188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09824562072753906  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327584266662598  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.330985069274902  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10341882705688477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186326503753662  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189907550811768  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11193037033081055  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.341918706893921
pure train time :  0.503291130065918
train time :  0.7939975261688232
end to end time :  5.466614723205566
connection check time:  2.5924041271209717
block generation time  1.390108585357666
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040268898010253906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015496492385864258
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.43190741539001465
len local_batched_seeds_list  4
partition total batch output list spend :  0.591050386428833
self.buckets_partition() spend  sec:  0.4474360942840576
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04392361640930176

in edges time spent  0.15280580520629883
local to global src and eids time spent  0.29567575454711914
time gen tails  0.06702804565429688
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13185811042785645

in edges time spent  0.5755126476287842
local to global src and eids time spent  0.8167316913604736
time gen tails  0.10298871994018555
res  length 4
block collection to dataloader spend  1.6450881958007812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09426593780517578  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926594257354736  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925648212432861  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394407272338867  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13892126083374  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142664909362793  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982050895690918  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.316679954528809  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320080757141113  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1023859977722168  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186663627624512  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190064430236816  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11138534545898438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3355451822280884
pure train time :  0.4734318256378174
train time :  0.747236967086792
end to end time :  5.3125832080841064
connection check time:  2.544083833694458
block generation time  1.4107329845428467
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004680156707763672
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014198064804077148
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.22639036178588867
len local_batched_seeds_list  4
partition total batch output list spend :  0.28539133071899414
self.buckets_partition() spend  sec:  0.24061894416809082
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.02426290512084961

in edges time spent  0.0841057300567627
local to global src and eids time spent  0.11411929130554199
time gen tails  0.03803706169128418
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.08668637275695801

in edges time spent  0.3012840747833252
local to global src and eids time spent  0.3640165328979492
time gen tails  0.08165144920349121
res  length 4
block collection to dataloader spend  7.867813110351562e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09471368789672852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.943689823150635  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.942829132080078  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09382009506225586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13070821762085  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.134068012237549  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09822797775268555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.315638065338135  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31903886795044  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10223579406738281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.17872142791748  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182122230529785  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11057806015014648  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.326289176940918
pure train time :  0.48017191886901855
train time :  0.7467470169067383
end to end time :  3.2667486667633057
connection check time:  1.247554063796997
block generation time  0.9793317317962646
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00034046173095703125
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013407230377197266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.21564412117004395
len local_batched_seeds_list  4
partition total batch output list spend :  0.2732255458831787
self.buckets_partition() spend  sec:  0.22907686233520508
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.024494409561157227

in edges time spent  0.08270025253295898
local to global src and eids time spent  0.11629319190979004
time gen tails  0.038892269134521484
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.08584785461425781

in edges time spent  0.504817008972168
local to global src and eids time spent  0.7735898494720459
time gen tails  0.09924554824829102
res  length 4
block collection to dataloader spend  9.059906005859375e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09380912780761719  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921241760253906  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92036247253418  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09386539459228516  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145870685577393  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149230480194092  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09833335876464844  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322892665863037  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326293468475342  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10346364974975586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182623386383057  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186204433441162  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11233234405517578  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3192540407180786
pure train time :  0.5181598663330078
train time :  0.7687361240386963
end to end time :  4.325093507766724
connection check time:  2.0041344165802
block generation time  1.2653465270996094
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039124488830566406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015531539916992188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4888005256652832
len local_batched_seeds_list  4
partition total batch output list spend :  0.581470251083374
self.buckets_partition() spend  sec:  0.5043654441833496
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043094635009765625

in edges time spent  0.1491532325744629
local to global src and eids time spent  0.2879786491394043
time gen tails  0.06556844711303711
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12815237045288086

in edges time spent  0.5309674739837646
local to global src and eids time spent  0.8590805530548096
time gen tails  0.13978195190429688
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09464359283447266  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920502185821533  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9195556640625  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09387922286987305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147872924804688  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.15155029296875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09826469421386719  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329288959503174  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.332689762115479  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024007797241211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181910991668701  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185311794281006  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11168670654296875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3110474348068237
pure train time :  0.5108070373535156
train time :  0.7590236663818359
end to end time :  5.263763666152954
connection check time:  2.548499822616577
block generation time  1.361114740371704
Run 00 | Epoch 00070 | Loss 1.3110 | Test 0.6133
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004477500915527344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015099048614501953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5156497955322266
len local_batched_seeds_list  4
partition total batch output list spend :  0.667081356048584
self.buckets_partition() spend  sec:  0.5307879447937012
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.045847177505493164

in edges time spent  0.15971755981445312
local to global src and eids time spent  0.2893831729888916
time gen tails  0.06656646728515625
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12909698486328125

in edges time spent  0.5836920738220215
local to global src and eids time spent  0.8824539184570312
time gen tails  0.13632750511169434
res  length 4
block collection to dataloader spend  1.3113021850585938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09463644027709961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922853469848633  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921908378601074  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09373664855957031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.121506214141846  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.125183582305908  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09908866882324219  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32198715209961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325387954711914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10237598419189453  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179464340209961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182865142822266  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11071634292602539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3032981157302856
pure train time :  0.5212802886962891
train time :  0.7907381057739258
end to end time :  5.482563257217407
connection check time:  2.6371066570281982
block generation time  1.3729004859924316
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039124488830566406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014688968658447266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5006844997406006
len local_batched_seeds_list  4
partition total batch output list spend :  0.6522536277770996
self.buckets_partition() spend  sec:  0.5154075622558594
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04277324676513672

in edges time spent  0.15382099151611328
local to global src and eids time spent  0.29013490676879883
time gen tails  0.06549525260925293
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1307694911956787

in edges time spent  0.5372302532196045
local to global src and eids time spent  0.8625748157501221
time gen tails  0.13594484329223633
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09396982192993164  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930239677429199  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929294109344482  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0937962532043457  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132008075714111  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.135685443878174  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831953048706055  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325300216674805  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32870101928711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10277795791625977  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189040184020996  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.192783832550049  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11098957061767578  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3004627227783203
pure train time :  0.5058712959289551
train time :  0.7710628509521484
end to end time :  5.361981153488159
connection check time:  2.5625147819519043
block generation time  1.3629531860351562
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00048279762268066406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014386892318725586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4980428218841553
len local_batched_seeds_list  4
partition total batch output list spend :  0.6491909027099609
self.buckets_partition() spend  sec:  0.5124609470367432
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04308772087097168

in edges time spent  0.14887118339538574
local to global src and eids time spent  0.2869908809661865
time gen tails  0.06529498100280762
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12903380393981934

in edges time spent  0.5487561225891113
local to global src and eids time spent  0.8927021026611328
time gen tails  0.1400761604309082
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397411346435547  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930604457855225  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929725170135498  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384393692016602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.123940467834473  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127617835998535  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821081161499023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319756031036377  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323156833648682  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10239982604980469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.198902130126953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.202302932739258  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11104822158813477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2897343635559082
pure train time :  0.5028927326202393
train time :  0.7654495239257812
end to end time :  5.394185304641724
connection check time:  2.6010639667510986
block generation time  1.3654508590698242
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003771781921386719
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014115095138549805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48300957679748535
len local_batched_seeds_list  4
partition total batch output list spend :  0.6332862377166748
self.buckets_partition() spend  sec:  0.49715638160705566
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04293322563171387

in edges time spent  0.14864611625671387
local to global src and eids time spent  0.2875347137451172
time gen tails  0.0655207633972168
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12758374214172363

in edges time spent  0.5305361747741699
local to global src and eids time spent  0.8626983165740967
time gen tails  0.13569259643554688
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09432125091552734  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925102233886719  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924156188964844  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389352798461914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13284969329834  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136527061462402  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09824180603027344  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322670936584473  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326071739196777  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1027379035949707  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182928562164307  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18667221069336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1113896369934082  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2867746353149414
pure train time :  0.5001442432403564
train time :  0.7664749622344971
end to end time :  5.30747127532959
connection check time:  2.5433425903320312
block generation time  1.346315622329712
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00038051605224609375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014259576797485352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4864952564239502
len local_batched_seeds_list  4
partition total batch output list spend :  0.636164665222168
self.buckets_partition() spend  sec:  0.5007948875427246
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04249835014343262

in edges time spent  0.1472771167755127
local to global src and eids time spent  0.2882044315338135
time gen tails  0.0657651424407959
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1279764175415039

in edges time spent  0.5242033004760742
local to global src and eids time spent  0.8599562644958496
time gen tails  0.1348581314086914
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09456872940063477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9245924949646  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923731803894043  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09416627883911133  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151719570159912  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.155079364776611  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982661247253418  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.315430641174316  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318831443786621  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10232257843017578  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181057929992676  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18445873260498  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11134815216064453  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.276819109916687
pure train time :  0.507239818572998
train time :  0.7588832378387451
end to end time :  5.293061017990112
connection check time:  2.534648895263672
block generation time  1.3504271507263184
Run 00 | Epoch 00075 | Loss 1.2768 | Test 0.6125
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041222572326660156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015525102615356445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5168859958648682
len local_batched_seeds_list  4
partition total batch output list spend :  0.6681644916534424
self.buckets_partition() spend  sec:  0.5324440002441406
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04594254493713379

in edges time spent  0.160599946975708
local to global src and eids time spent  0.2911505699157715
time gen tails  0.06637716293334961
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12956833839416504

in edges time spent  0.5530276298522949
local to global src and eids time spent  0.8616492748260498
time gen tails  0.1354682445526123
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09456062316894531  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92322301864624  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922344207763672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09385919570922852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14053201675415  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144209384918213  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09829378128051758  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322599411010742  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326000213623047  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10234737396240234  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18019962310791  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183600425720215  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11131429672241211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.273295283317566
pure train time :  0.5057835578918457
train time :  0.7829046249389648
end to end time :  5.410866022109985
connection check time:  2.588374614715576
block generation time  1.3539700508117676
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042629241943359375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014374732971191406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5192892551422119
len local_batched_seeds_list  4
partition total batch output list spend :  0.6717782020568848
self.buckets_partition() spend  sec:  0.533698320388794
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04472184181213379

in edges time spent  0.15204858779907227
local to global src and eids time spent  0.2920188903808594
time gen tails  0.0659787654876709
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12863969802856445

in edges time spent  0.529522180557251
local to global src and eids time spent  0.8569507598876953
time gen tails  0.13530325889587402
res  length 4
block collection to dataloader spend  1.239776611328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0942840576171875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920179843902588  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919234752655029  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397697448730469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.161293983459473  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.164971351623535  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828424453735352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319647312164307  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323048114776611  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10234928131103516  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179451942443848  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182852745056152  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11107635498046875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2675094604492188
pure train time :  0.49689364433288574
train time :  0.7656173706054688
end to end time :  5.343271970748901
connection check time:  2.547039031982422
block generation time  1.3448846340179443
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005240440368652344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013961553573608398
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48598384857177734
len local_batched_seeds_list  4
partition total batch output list spend :  0.6369576454162598
self.buckets_partition() spend  sec:  0.49997925758361816
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04320168495178223

in edges time spent  0.14856195449829102
local to global src and eids time spent  0.28712987899780273
time gen tails  0.06587481498718262
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12833929061889648

in edges time spent  0.5372333526611328
local to global src and eids time spent  0.8547616004943848
time gen tails  0.1351606845855713
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0941915512084961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930504322052002  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929559230804443  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09417152404785156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141731262207031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145408630371094  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09913110733032227  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.3326997756958  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.336100578308105  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10230493545532227  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186755657196045  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19015645980835  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11096382141113281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2621190547943115
pure train time :  0.490344762802124
train time :  0.7503788471221924
end to end time :  5.293635129928589
connection check time:  2.543302297592163
block generation time  1.3499677181243896
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004017353057861328
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014143943786621094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4287722110748291
len local_batched_seeds_list  4
partition total batch output list spend :  0.5832540988922119
self.buckets_partition() spend  sec:  0.4429512023925781
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043163299560546875

in edges time spent  0.14902520179748535
local to global src and eids time spent  0.28737306594848633
time gen tails  0.06617116928100586
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12712430953979492

in edges time spent  0.5328197479248047
local to global src and eids time spent  0.8541707992553711
time gen tails  0.13524341583251953
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09432363510131836  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9354939460754395  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.934548377990723  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.093963623046875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142805576324463  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.146482944488525  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09820175170898438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31721019744873  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320611000061035  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10344409942626953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187466621398926  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.191047668457031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11196374893188477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2595008611679077
pure train time :  0.508589506149292
train time :  0.7687816619873047
end to end time :  5.257818698883057
connection check time:  2.5379276275634766
block generation time  1.3543071746826172
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003979206085205078
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014394760131835938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5206067562103271
len local_batched_seeds_list  4
partition total batch output list spend :  0.670788049697876
self.buckets_partition() spend  sec:  0.5350415706634521
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042611122131347656

in edges time spent  0.14641022682189941
local to global src and eids time spent  0.2866835594177246
time gen tails  0.06582331657409668
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12723088264465332

in edges time spent  0.5311665534973145
local to global src and eids time spent  0.8591098785400391
time gen tails  0.13508296012878418
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0943455696105957  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.963808536529541  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.962862491607666  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.093963623046875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14514446258545  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148821830749512  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09825658798217773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319931983947754  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323675632476807  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10343313217163086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184888362884521  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188469409942627  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11159801483154297  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2504024505615234
pure train time :  0.5051298141479492
train time :  0.7666003704071045
end to end time :  5.329012870788574
connection check time:  2.535857677459717
block generation time  1.3417770862579346
Run 00 | Epoch 00080 | Loss 1.2504 | Test 0.6186
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.000392913818359375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014876842498779297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5329456329345703
len local_batched_seeds_list  4
partition total batch output list spend :  0.6863155364990234
self.buckets_partition() spend  sec:  0.5478553771972656
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04784059524536133

in edges time spent  0.1623997688293457
local to global src and eids time spent  0.2962002754211426
time gen tails  0.0691080093383789
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13316726684570312

in edges time spent  0.5962581634521484
local to global src and eids time spent  0.8736526966094971
time gen tails  0.13731145858764648
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384679794311523  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922273635864258  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921327590942383  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09391975402832031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145217895507812  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148895263671875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09839773178100586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.3299241065979  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.333324909210205  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10238885879516602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183742046356201  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186858177185059  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11073780059814453  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2433650493621826
pure train time :  0.5089082717895508
train time :  0.7822074890136719
end to end time :  5.541361331939697
connection check time:  2.6737067699432373
block generation time  1.3797149658203125
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040411949157714844
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014275789260864258
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5008015632629395
len local_batched_seeds_list  4
partition total batch output list spend :  0.6527464389801025
self.buckets_partition() spend  sec:  0.5151090621948242
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04637646675109863

in edges time spent  0.15619111061096191
local to global src and eids time spent  0.28859543800354004
time gen tails  0.06599855422973633
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12599587440490723

in edges time spent  0.5689287185668945
local to global src and eids time spent  0.8684449195861816
time gen tails  0.13582706451416016
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09402132034301758  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.933076858520508  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9328932762146  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09396123886108398  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138641357421875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142318725585938  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09841156005859375  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32473611831665  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328136920928955  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10335016250610352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183601379394531  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187182426452637  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11246204376220703  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2396633625030518
pure train time :  0.5060436725616455
train time :  0.7621972560882568
end to end time :  5.377732992172241
connection check time:  2.6071527004241943
block generation time  1.3422532081604004
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004525184631347656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014037370681762695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48037099838256836
len local_batched_seeds_list  4
partition total batch output list spend :  0.6297409534454346
self.buckets_partition() spend  sec:  0.49444103240966797
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042847633361816406

in edges time spent  0.15096044540405273
local to global src and eids time spent  0.2889530658721924
time gen tails  0.06606531143188477
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12679314613342285

in edges time spent  0.563483476638794
local to global src and eids time spent  0.8561921119689941
time gen tails  0.13497495651245117
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09442138671875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.961757183074951  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.960812568664551  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938105583190918  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.12599802017212  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.129675388336182  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09906721115112305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322907447814941  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326308250427246  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10240697860717773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186436176300049  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189836978912354  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11141109466552734  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2335479259490967
pure train time :  0.4628126621246338
train time :  0.7474267482757568
end to end time :  5.321276664733887
connection check time:  2.582364320755005
block generation time  1.3438127040863037
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003991127014160156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01409912109375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4803001880645752
len local_batched_seeds_list  4
partition total batch output list spend :  0.6294991970062256
self.buckets_partition() spend  sec:  0.494429349899292
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0428617000579834

in edges time spent  0.148942232131958
local to global src and eids time spent  0.2879905700683594
time gen tails  0.06598186492919922
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12650585174560547

in edges time spent  0.5399527549743652
local to global src and eids time spent  0.8848538398742676
time gen tails  0.14591670036315918
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09453773498535156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.913216590881348  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9122700691223145  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394168853759766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136144638061523  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139822006225586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823179244995117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318981170654297  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322381973266602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10272645950317383  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143601417541504  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147345066070557  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11070585250854492  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2300976514816284
pure train time :  0.5297958850860596
train time :  0.8086051940917969
end to end time :  5.51844048500061
connection check time:  2.6357033252716064
block generation time  1.4268834590911865
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004086494445800781
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016664981842041016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5180482864379883
len local_batched_seeds_list  4
partition total batch output list spend :  0.6768105030059814
self.buckets_partition() spend  sec:  0.534754753112793
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.044966697692871094

in edges time spent  0.1560666561126709
local to global src and eids time spent  0.2953791618347168
time gen tails  0.06694531440734863
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12836766242980957

in edges time spent  0.5815081596374512
local to global src and eids time spent  0.8785901069641113
time gen tails  0.13758444786071777
res  length 4
block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09405994415283203  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.971983909606934  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9718017578125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09380388259887695  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.125602722167969  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.129280090332031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09907245635986328  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320891380310059  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324292182922363  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10232305526733398  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185815334320068  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189216136932373  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11143064498901367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2251527309417725
pure train time :  0.49408912658691406
train time :  0.776036262512207
end to end time :  5.498986721038818
connection check time:  2.6426727771759033
block generation time  1.3830344676971436
Run 00 | Epoch 00085 | Loss 1.2252 | Test 0.6201
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004100799560546875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015134811401367188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5773165225982666
len local_batched_seeds_list  4
partition total batch output list spend :  0.7325780391693115
self.buckets_partition() spend  sec:  0.5924885272979736
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.047415733337402344

in edges time spent  0.16191434860229492
local to global src and eids time spent  0.2341609001159668
time gen tails  0.05017852783203125
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12805819511413574

in edges time spent  0.5947084426879883
local to global src and eids time spent  0.8813867568969727
time gen tails  0.13740777969360352
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09473562240600586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.96273946762085  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9619364738464355  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403657913208008  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13401746749878  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137761116027832  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09908676147460938  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329854965209961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.333255767822266  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.102294921875  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.194855213165283  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.198256015777588  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11182928085327148  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.221278429031372
pure train time :  0.4687964916229248
train time :  0.7644219398498535
end to end time :  5.511018991470337
connection check time:  2.619405746459961
block generation time  1.3759276866912842
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004372596740722656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014491081237792969
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5102152824401855
len local_batched_seeds_list  4
partition total batch output list spend :  0.6609795093536377
self.buckets_partition() spend  sec:  0.524738073348999
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.044531822204589844

in edges time spent  0.1554889678955078
local to global src and eids time spent  0.288149356842041
time gen tails  0.06602668762207031
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12919354438781738

in edges time spent  0.5514364242553711
local to global src and eids time spent  0.8655095100402832
time gen tails  0.1365211009979248
res  length 4
block collection to dataloader spend  1.8358230590820312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0945425033569336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.914048671722412  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9131035804748535  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389019012451172  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137726783752441  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141404151916504  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09877777099609375  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318608283996582  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322351932525635  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10266351699829102  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190639019012451  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.194382667541504  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1114201545715332  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.218285322189331
pure train time :  0.47698974609375
train time :  0.7784743309020996
end to end time :  5.403310537338257
connection check time:  2.588022232055664
block generation time  1.3596279621124268
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005033016204833984
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014102458953857422
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5307004451751709
len local_batched_seeds_list  4
partition total batch output list spend :  0.6824333667755127
self.buckets_partition() spend  sec:  0.544835090637207
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04277157783508301

in edges time spent  0.15167570114135742
local to global src and eids time spent  0.2884202003479004
time gen tails  0.06628704071044922
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1285569667816162

in edges time spent  0.5384812355041504
local to global src and eids time spent  0.8619740009307861
time gen tails  0.13643693923950195
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09458589553833008  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.928539752960205  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9275946617126465  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395360946655273  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14874792098999  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152425289154053  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09830141067504883  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320423603057861  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323824405670166  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10261678695678711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180090427398682  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183834075927734  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11155271530151367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2146975994110107
pure train time :  0.46903109550476074
train time :  0.75956130027771
end to end time :  5.38810396194458
connection check time:  2.5678532123565674
block generation time  1.3635876178741455
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004184246063232422
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014094829559326172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5180158615112305
len local_batched_seeds_list  4
partition total batch output list spend :  0.6713416576385498
self.buckets_partition() spend  sec:  0.5321433544158936
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04347586631774902

in edges time spent  0.15227127075195312
local to global src and eids time spent  0.28966712951660156
time gen tails  0.06664681434631348
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12824130058288574

in edges time spent  0.541506290435791
local to global src and eids time spent  0.8593335151672363
time gen tails  0.13681316375732422
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09464597702026367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.928433895111084  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927488803863525  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384012222290039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.131492614746094  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.134852409362793  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821462631225586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32445764541626  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327858448028564  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10333776473999023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.153553485870361  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.157134532928467  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11173057556152344  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2071340084075928
pure train time :  0.46790146827697754
train time :  0.7569468021392822
end to end time :  5.376427173614502
connection check time:  2.5697062015533447
block generation time  1.3618509769439697
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042891502380371094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014197111129760742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4291224479675293
len local_batched_seeds_list  4
partition total batch output list spend :  0.5827085971832275
self.buckets_partition() spend  sec:  0.4433605670928955
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0432734489440918

in edges time spent  0.15142202377319336
local to global src and eids time spent  0.28819799423217773
time gen tails  0.06655144691467285
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12944889068603516

in edges time spent  0.5423099994659424
local to global src and eids time spent  0.8984205722808838
time gen tails  0.14507555961608887
res  length 4
block collection to dataloader spend  1.1920928955078125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09399557113647461  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920044422149658  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919100284576416  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09382772445678711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.134507179260254  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137866973876953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982980728149414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325121879577637  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328522682189941  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10269784927368164  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.17855453491211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182298183441162  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1116037368774414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.201640248298645
pure train time :  0.545382022857666
train time :  0.8408420085906982
end to end time :  5.4322669506073
connection check time:  2.6303420066833496
block generation time  1.3649485111236572
Run 00 | Epoch 00090 | Loss 1.2016 | Test 0.6226
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004305839538574219
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015697956085205078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5442252159118652
len local_batched_seeds_list  4
partition total batch output list spend :  0.6400926113128662
self.buckets_partition() spend  sec:  0.5599629878997803
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04638552665710449

in edges time spent  0.1579883098602295
local to global src and eids time spent  0.29219818115234375
time gen tails  0.0672910213470459
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12953472137451172

in edges time spent  0.5848667621612549
local to global src and eids time spent  0.9021332263946533
time gen tails  0.14226675033569336
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09464454650878906  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.932751655578613  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.931920051574707  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393548965454102  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14632272720337  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149682521820068  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09829998016357422  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329358577728271  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.332759380340576  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1034383773803711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179990768432617  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183571815490723  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11160516738891602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1974695920944214
pure train time :  0.46686792373657227
train time :  0.768139123916626
end to end time :  5.524841547012329
connection check time:  2.6801490783691406
block generation time  1.4148118495941162
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003991127014160156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014340400695800781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4202749729156494
len local_batched_seeds_list  4
partition total batch output list spend :  0.5707085132598877
self.buckets_partition() spend  sec:  0.4346466064453125
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04311203956604004

in edges time spent  0.17769098281860352
local to global src and eids time spent  0.2877166271209717
time gen tails  0.06638622283935547
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12893462181091309

in edges time spent  0.5676653385162354
local to global src and eids time spent  0.8998610973358154
time gen tails  0.13650894165039062
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09406232833862305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923845291137695  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9228997230529785  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938262939453125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.116799354553223  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.120476722717285  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09832954406738281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.330145359039307  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.333546161651611  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10344266891479492  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185386657714844  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18896770477295  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11181831359863281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1971288919448853
pure train time :  0.5007266998291016
train time :  0.7678496837615967
end to end time :  5.369123697280884
connection check time:  2.661029815673828
block generation time  1.3565261363983154
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005342960357666016
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014141321182250977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4968416690826416
len local_batched_seeds_list  4
partition total batch output list spend :  0.6477887630462646
self.buckets_partition() spend  sec:  0.5110135078430176
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04492831230163574

in edges time spent  0.15340924263000488
local to global src and eids time spent  0.29006528854370117
time gen tails  0.06619763374328613
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12781500816345215

in edges time spent  0.5457217693328857
local to global src and eids time spent  0.8588998317718506
time gen tails  0.13501667976379395
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0940089225769043  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922903060913086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921957492828369  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09419059753417969  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127553462982178  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13123083114624  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09910392761230469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322200298309326  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32560110092163  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10264158248901367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183347225189209  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187090873718262  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11127614974975586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1894030570983887
pure train time :  0.5049138069152832
train time :  0.7679846286773682
end to end time :  5.375933647155762
connection check time:  2.582080125808716
block generation time  1.3618180751800537
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004181861877441406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01454925537109375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.509230375289917
len local_batched_seeds_list  4
partition total batch output list spend :  0.6612663269042969
self.buckets_partition() spend  sec:  0.5238115787506104
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043182373046875

in edges time spent  0.15314292907714844
local to global src and eids time spent  0.28827977180480957
time gen tails  0.0669260025024414
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13036632537841797

in edges time spent  0.5449085235595703
local to global src and eids time spent  0.8559901714324951
time gen tails  0.13625717163085938
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09450960159301758  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921835899353027  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920956611633301  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09379768371582031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133104801177979  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136782169342041  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823894500732422  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320401668548584  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323802471160889  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10274696350097656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.194189071655273  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.197932720184326  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11075878143310547  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1861963272094727
pure train time :  0.5031905174255371
train time :  0.7687332630157471
end to end time :  5.367408037185669
connection check time:  2.569938898086548
block generation time  1.3527467250823975
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004067420959472656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014201641082763672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47743773460388184
len local_batched_seeds_list  4
partition total batch output list spend :  0.6261394023895264
self.buckets_partition() spend  sec:  0.49167847633361816
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04272174835205078

in edges time spent  0.152205228805542
local to global src and eids time spent  0.2875993251800537
time gen tails  0.06642746925354004
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12827277183532715

in edges time spent  0.5414509773254395
local to global src and eids time spent  0.8597285747528076
time gen tails  0.13548588752746582
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394264221191406  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920125484466553  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919179439544678  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09387683868408203  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141069889068604  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144747257232666  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09826231002807617  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321051597595215  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32445240020752  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10278558731079102  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181089878082275  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184833526611328  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11080408096313477  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1890414953231812
pure train time :  0.4995768070220947
train time :  0.7679264545440674
end to end time :  5.34532618522644
connection check time:  2.565063953399658
block generation time  1.3739757537841797
Run 00 | Epoch 00095 | Loss 1.1890 | Test 0.6200
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004291534423828125
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014230966567993164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.528048038482666
len local_batched_seeds_list  4
partition total batch output list spend :  0.6829447746276855
self.buckets_partition() spend  sec:  0.5423145294189453
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04378533363342285

in edges time spent  0.15472006797790527
local to global src and eids time spent  0.28967785835266113
time gen tails  0.06652355194091797
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1278245449066162

in edges time spent  0.5728421211242676
local to global src and eids time spent  0.9240515232086182
time gen tails  0.14412951469421387
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395170211791992  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920732498168945  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919785976409912  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384536743164062  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136951923370361  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140629291534424  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0983266830444336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323166847229004  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326567649841309  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10226821899414062  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180180549621582  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183581352233887  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11088418960571289  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1872665882110596
pure train time :  0.5170238018035889
train time :  0.7815394401550293
end to end time :  5.5788960456848145
connection check time:  2.692624807357788
block generation time  1.4075727462768555
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004036426544189453
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014106988906860352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4907395839691162
len local_batched_seeds_list  4
partition total batch output list spend :  0.6413986682891846
self.buckets_partition() spend  sec:  0.5048789978027344
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04272198677062988

in edges time spent  0.15049219131469727
local to global src and eids time spent  0.2872796058654785
time gen tails  0.06650018692016602
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1257791519165039

in edges time spent  0.5361530780792236
local to global src and eids time spent  0.8581955432891846
time gen tails  0.1411573886871338
res  length 4
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09422588348388672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927652359008789  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926706790924072  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403705596923828  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.169888019561768  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.173247814178467  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09902286529541016  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318675994873047  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322076797485352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10332250595092773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180680274963379  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184261322021484  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11204862594604492  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1817950010299683
pure train time :  0.530259370803833
train time :  0.7774169445037842
end to end time :  5.390206575393677
connection check time:  2.5923616886138916
block generation time  1.3575429916381836
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004937648773193359
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014333486557006836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5406150817871094
len local_batched_seeds_list  4
partition total batch output list spend :  0.6955933570861816
self.buckets_partition() spend  sec:  0.5549845695495605
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04349398612976074

in edges time spent  0.1526200771331787
local to global src and eids time spent  0.28851747512817383
time gen tails  0.06647348403930664
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1289353370666504

in edges time spent  0.5445864200592041
local to global src and eids time spent  0.860407829284668
time gen tails  0.13628292083740234
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939188003540039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920411109924316  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919466018676758  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394359588623047  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148202896118164  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151880264282227  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09825277328491211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.301038265228271  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.304439067840576  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10344457626342773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179310321807861  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182891368865967  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11160850524902344  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1782175302505493
pure train time :  0.5347177982330322
train time :  0.7890276908874512
end to end time :  5.436267137527466
connection check time:  2.573025941848755
block generation time  1.3649773597717285
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004017353057861328
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014282703399658203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49535560607910156
len local_batched_seeds_list  4
partition total batch output list spend :  0.6448180675506592
self.buckets_partition() spend  sec:  0.5096681118011475
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04279279708862305

in edges time spent  0.1510159969329834
local to global src and eids time spent  0.2875373363494873
time gen tails  0.0661473274230957
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12665605545043945

in edges time spent  0.5470178127288818
local to global src and eids time spent  0.8531458377838135
time gen tails  0.13610148429870605
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09383440017700195  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925915241241455  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924969673156738  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0942220687866211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.155346393585205  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.159023761749268  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09820842742919922  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324632167816162  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328032970428467  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10226821899414062  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181875228881836  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18527603149414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.111419677734375  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1692590713500977
pure train time :  0.5081117153167725
train time :  0.7705883979797363
end to end time :  5.342362642288208
connection check time:  2.561833143234253
block generation time  1.3518750667572021
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004405975341796875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01429605484008789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48127222061157227
len local_batched_seeds_list  4
partition total batch output list spend :  0.6311900615692139
self.buckets_partition() spend  sec:  0.49561405181884766
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04280495643615723

in edges time spent  0.15109491348266602
local to global src and eids time spent  0.28667354583740234
time gen tails  0.06658267974853516
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12804937362670898

in edges time spent  0.5420866012573242
local to global src and eids time spent  0.8547348976135254
time gen tails  0.11098384857177734
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09414339065551758  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921675205230713  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920730113983154  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392690658569336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1342453956604  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137922763824463  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09832954406738281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329418659210205  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.33281946182251  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10338449478149414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18483018875122  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188411235809326  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11154842376708984  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1666762828826904
pure train time :  0.521376371383667
train time :  0.8155639171600342
end to end time :  5.367968320846558
connection check time:  2.5368521213531494
block generation time  1.370309591293335
Run 00 | Epoch 00100 | Loss 1.1667 | Test 0.6207
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004303455352783203
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016207456588745117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5478277206420898
len local_batched_seeds_list  4
partition total batch output list spend :  0.6416478157043457
self.buckets_partition() spend  sec:  0.5640742778778076
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.046897172927856445

in edges time spent  0.18149185180664062
local to global src and eids time spent  0.29168701171875
time gen tails  0.06686806678771973
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1280508041381836

in edges time spent  0.5599477291107178
local to global src and eids time spent  0.8843910694122314
time gen tails  0.14035916328430176
res  length 4
block collection to dataloader spend  1.5735626220703125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394502639770508  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.953096389770508  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.952150821685791  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389400482177734  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.126739978790283  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.130417346954346  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09834909439086914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318527221679688  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321928024291992  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10241556167602539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183517456054688  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186918258666992  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11162757873535156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.161597490310669
pure train time :  0.5320262908935547
train time :  0.7927789688110352
end to end time :  5.517065525054932
connection check time:  2.6926958560943604
block generation time  1.3691458702087402
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00044465065002441406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01424860954284668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5459961891174316
len local_batched_seeds_list  4
partition total batch output list spend :  0.7010102272033691
self.buckets_partition() spend  sec:  0.5602865219116211
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043082237243652344

in edges time spent  0.1565096378326416
local to global src and eids time spent  0.28926825523376465
time gen tails  0.06568384170532227
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12719297409057617

in edges time spent  0.575340986251831
local to global src and eids time spent  0.861234188079834
time gen tails  0.1363816261291504
res  length 4
block collection to dataloader spend  1.8596649169921875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09449481964111328  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92207145690918  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921199798583984  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939335823059082  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139509201049805  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143186569213867  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09912776947021484  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323660373687744  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327061176300049  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10333251953125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184453010559082  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188034057617188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11149168014526367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1666572093963623
pure train time :  0.5129203796386719
train time :  0.7769472599029541
end to end time :  5.462454319000244
connection check time:  2.6104891300201416
block generation time  1.3572449684143066
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004892349243164062
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014639616012573242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49752283096313477
len local_batched_seeds_list  4
partition total batch output list spend :  0.6492176055908203
self.buckets_partition() spend  sec:  0.5121941566467285
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042877912521362305

in edges time spent  0.14899826049804688
local to global src and eids time spent  0.286609411239624
time gen tails  0.06618046760559082
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12577342987060547

in edges time spent  0.5545237064361572
local to global src and eids time spent  0.8572368621826172
time gen tails  0.13515663146972656
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09391927719116211  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924719333648682  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923773765563965  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403610229492188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141115665435791  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14447546005249  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823131561279297  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.30489206314087  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.308292865753174  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10233640670776367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.156196594238281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.159597396850586  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11187601089477539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1615302562713623
pure train time :  0.5006768703460693
train time :  0.7695188522338867
end to end time :  5.362543106079102
connection check time:  2.569380283355713
block generation time  1.3610196113586426
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003972053527832031
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014201641082763672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3958611488342285
len local_batched_seeds_list  4
partition total batch output list spend :  0.5452902317047119
self.buckets_partition() spend  sec:  0.4100937843322754
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04271340370178223

in edges time spent  0.1488041877746582
local to global src and eids time spent  0.2870492935180664
time gen tails  0.06615877151489258
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1261272430419922

in edges time spent  0.5336074829101562
local to global src and eids time spent  0.8553977012634277
time gen tails  0.1353893280029297
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09437227249145508  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921972751617432  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9210944175720215  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394168853759766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.146105766296387  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149465560913086  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831428527832031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323615074157715  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32701587677002  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10341978073120117  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184234142303467  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187815189361572  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11198949813842773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.159395694732666
pure train time :  0.5147578716278076
train time :  0.7613661289215088
end to end time :  5.2218029499053955
connection check time:  2.546541452407837
block generation time  1.3530116081237793
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040340423583984375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014484405517578125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49817800521850586
len local_batched_seeds_list  4
partition total batch output list spend :  0.6515159606933594
self.buckets_partition() spend  sec:  0.5127043724060059
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04273247718811035

in edges time spent  0.1490802764892578
local to global src and eids time spent  0.28771257400512695
time gen tails  0.06624507904052734
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1276869773864746

in edges time spent  0.5291805267333984
local to global src and eids time spent  0.8536925315856934
time gen tails  0.1359093189239502
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09428691864013672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921574592590332  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9206953048706055  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939340591430664  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.123453140258789  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127130508422852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0990605354309082  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323078632354736  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326479434967041  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10224676132202148  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180622577667236  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184023380279541  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11149215698242188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.161083698272705
pure train time :  0.5037133693695068
train time :  0.768310546875
end to end time :  5.330270767211914
connection check time:  2.541856050491333
block generation time  1.351074457168579
Run 00 | Epoch 00105 | Loss 1.1611 | Test 0.6239
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004138946533203125
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014805316925048828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5119972229003906
len local_batched_seeds_list  4
partition total batch output list spend :  0.6629185676574707
self.buckets_partition() spend  sec:  0.5268383026123047
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04619598388671875

in edges time spent  0.16212701797485352
local to global src and eids time spent  0.31209492683410645
time gen tails  0.06750297546386719
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1293315887451172

in edges time spent  0.5883049964904785
local to global src and eids time spent  0.8867847919464111
time gen tails  0.14493322372436523
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403800964355469  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926875591278076  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925997257232666  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0941777229309082  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.118305206298828  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.121665000915527  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09826469421386719  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321744918823242  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325145721435547  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10340690612792969  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.178813934326172  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182394981384277  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11223316192626953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1558876037597656
pure train time :  0.49036455154418945
train time :  0.8008387088775635
end to end time :  5.5740721225738525
connection check time:  2.7066895961761475
block generation time  1.3833158016204834
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042939186096191406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014259576797485352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5385720729827881
len local_batched_seeds_list  4
partition total batch output list spend :  0.6985797882080078
self.buckets_partition() spend  sec:  0.5528643131256104
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04288005828857422

in edges time spent  0.15926003456115723
local to global src and eids time spent  0.29038310050964355
time gen tails  0.06644630432128906
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12920236587524414

in edges time spent  0.5522627830505371
local to global src and eids time spent  0.8580739498138428
time gen tails  0.13610553741455078
res  length 4
block collection to dataloader spend  1.7881393432617188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09398126602172852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.917237758636475  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.916293144226074  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388875961303711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144128322601318  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14780569076538  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09824848175048828  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31815242767334  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321553230285645  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10256385803222656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.192456722259521  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.195857524871826  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11224126815795898  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1547924280166626
pure train time :  0.5058889389038086
train time :  0.7797198295593262
end to end time :  5.446603298187256
connection check time:  2.5862467288970947
block generation time  1.3539953231811523
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005006790161132812
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014524698257446289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5044810771942139
len local_batched_seeds_list  4
partition total batch output list spend :  0.6546950340270996
self.buckets_partition() spend  sec:  0.5190432071685791
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043128013610839844

in edges time spent  0.1514606475830078
local to global src and eids time spent  0.28803253173828125
time gen tails  0.06640791893005371
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12769722938537598

in edges time spent  0.55670166015625
local to global src and eids time spent  0.855440616607666
time gen tails  0.13627314567565918
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09457254409790039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.959359645843506  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.958479404449463  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384441375732422  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14033031463623  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144007682800293  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09822225570678711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32630968093872  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329710483551025  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10273599624633789  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184298515319824  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188042163848877  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11144399642944336  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1528520584106445
pure train time :  0.5069150924682617
train time :  0.7749917507171631
end to end time :  5.3801844120025635
connection check time:  2.5767993927001953
block generation time  1.3571019172668457
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004107952117919922
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014374256134033203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5185701847076416
len local_batched_seeds_list  4
partition total batch output list spend :  0.672598123550415
self.buckets_partition() spend  sec:  0.5329773426055908
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04275369644165039

in edges time spent  0.15166807174682617
local to global src and eids time spent  0.2875096797943115
time gen tails  0.06608152389526367
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12692689895629883

in edges time spent  0.5638279914855957
local to global src and eids time spent  0.8958041667938232
time gen tails  0.1410231590270996
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09462833404541016  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9304399490356445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929493427276611  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392404556274414  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1386137008667  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142291069030762  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09832382202148438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320263862609863  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324007511138916  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10344886779785156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188663005828857  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.192244052886963  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11194372177124023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.150356650352478
pure train time :  0.5333530902862549
train time :  0.7869081497192383
end to end time :  5.516017436981201
connection check time:  2.6372344493865967
block generation time  1.4038543701171875
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00043392181396484375
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014529228210449219
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5155925750732422
len local_batched_seeds_list  4
partition total batch output list spend :  0.6699392795562744
self.buckets_partition() spend  sec:  0.5301640033721924
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04353809356689453

in edges time spent  0.15177488327026367
local to global src and eids time spent  0.28908681869506836
time gen tails  0.06595873832702637
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1280381679534912

in edges time spent  0.5349736213684082
local to global src and eids time spent  0.8587701320648193
time gen tails  0.13555526733398438
res  length 4
block collection to dataloader spend  1.1205673217773438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09428930282592773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925023555755615  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92407751083374  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938711166381836  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138348579406738  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141708374023438  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09836244583129883  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324670791625977  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328071594238281  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10343503952026367  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188382148742676  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.191963195800781  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11226463317871094  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.149627447128296
pure train time :  0.4889659881591797
train time :  0.7639284133911133
end to end time :  5.357843637466431
connection check time:  2.5582938194274902
block generation time  1.3520176410675049
Run 00 | Epoch 00110 | Loss 1.1496 | Test 0.6250
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040721893310546875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01641082763671875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5163207054138184
len local_batched_seeds_list  4
partition total batch output list spend :  0.6710085868835449
self.buckets_partition() spend  sec:  0.532764196395874
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04658055305480957

in edges time spent  0.15782642364501953
local to global src and eids time spent  0.28964900970458984
time gen tails  0.06693792343139648
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12664794921875

in edges time spent  0.5674128532409668
local to global src and eids time spent  0.854560136795044
time gen tails  0.13602948188781738
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09468221664428711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922133922576904  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921188831329346  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09399652481079102  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149355411529541  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.153032779693604  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09827947616577148  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319382667541504  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322783470153809  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10335731506347656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181390762329102  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184971809387207  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11270284652709961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1460769176483154
pure train time :  0.492708683013916
train time :  0.7653181552886963
end to end time :  5.4036900997161865
connection check time:  2.5973153114318848
block generation time  1.3486614227294922
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041031837463378906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014749288558959961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4840102195739746
len local_batched_seeds_list  4
partition total batch output list spend :  0.6336910724639893
self.buckets_partition() spend  sec:  0.498790979385376
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04468035697937012

in edges time spent  0.15642356872558594
local to global src and eids time spent  0.2876601219177246
time gen tails  0.06630825996398926
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12734270095825195

in edges time spent  0.5487227439880371
local to global src and eids time spent  0.8566691875457764
time gen tails  0.13538241386413574
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0947270393371582  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923838138580322  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922959804534912  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392738342285156  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.159180641174316  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.162858009338379  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823846817016602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32001256942749  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323413372039795  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1026153564453125  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182328701019287  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18607234954834  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11089754104614258  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1473428010940552
pure train time :  0.4990556240081787
train time :  0.7677903175354004
end to end time :  5.332360029220581
connection check time:  2.5725932121276855
block generation time  1.344663143157959
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005495548248291016
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014278888702392578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4794132709503174
len local_batched_seeds_list  4
partition total batch output list spend :  0.6293022632598877
self.buckets_partition() spend  sec:  0.4937281608581543
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0429072380065918

in edges time spent  0.1503448486328125
local to global src and eids time spent  0.2863919734954834
time gen tails  0.06594443321228027
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12549090385437012

in edges time spent  0.5413610935211182
local to global src and eids time spent  0.8564488887786865
time gen tails  0.1385056972503662
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384393692016602  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919980525970459  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9190354347229  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09385299682617188  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.129261016845703  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132938385009766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831476211547852  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323771476745605  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32717227935791  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10233163833618164  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183887004852295  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1872878074646  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11067581176757812  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1444107294082642
pure train time :  0.49601078033447266
train time :  0.7651445865631104
end to end time :  5.31177830696106
connection check time:  2.560551404953003
block generation time  1.343578577041626
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004096031188964844
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01405954360961914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5159189701080322
len local_batched_seeds_list  4
partition total batch output list spend :  0.6689891815185547
self.buckets_partition() spend  sec:  0.5300107002258301
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04304838180541992

in edges time spent  0.15046310424804688
local to global src and eids time spent  0.2870769500732422
time gen tails  0.06480884552001953
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12684202194213867

in edges time spent  0.5294756889343262
local to global src and eids time spent  0.849907398223877
time gen tails  0.13513517379760742
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392213821411133  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923099994659424  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922153949737549  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389543533325195  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.135268688201904  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138946056365967  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09871149063110352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320654392242432  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324398040771484  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10242748260498047  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183033466339111  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186434268951416  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11076879501342773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1402006149291992
pure train time :  0.49925661087036133
train time :  0.7762439250946045
end to end time :  5.344339609146118
connection check time:  2.53544282913208
block generation time  1.3487145900726318
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042939186096191406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014157533645629883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4342164993286133
len local_batched_seeds_list  4
partition total batch output list spend :  0.5885424613952637
self.buckets_partition() spend  sec:  0.44842529296875
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04302573204040527

in edges time spent  0.1481471061706543
local to global src and eids time spent  0.28579115867614746
time gen tails  0.06605935096740723
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12656855583190918

in edges time spent  0.5313050746917725
local to global src and eids time spent  0.8491575717926025
time gen tails  0.13450384140014648
res  length 4
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09407806396484375  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92840051651001  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.928377628326416  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395694732666016  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143420696258545  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.146780490875244  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09834575653076172  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319403648376465  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32280445098877  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10275411605834961  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185935974121094  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189679622650146  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1109781265258789  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1406326293945312
pure train time :  0.5302138328552246
train time :  0.7752540111541748
end to end time :  5.256431341171265
connection check time:  2.5340070724487305
block generation time  1.3451876640319824
Run 00 | Epoch 00115 | Loss 1.1406 | Test 0.6278
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042510032653808594
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015278339385986328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5193231105804443
len local_batched_seeds_list  4
partition total batch output list spend :  0.6708521842956543
self.buckets_partition() spend  sec:  0.5346381664276123
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04715561866760254

in edges time spent  0.16050219535827637
local to global src and eids time spent  0.2909879684448242
time gen tails  0.06729316711425781
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12666034698486328

in edges time spent  0.5617272853851318
local to global src and eids time spent  0.8691153526306152
time gen tails  0.13585925102233887
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0941157341003418  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926575660705566  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925695896148682  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09421825408935547  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138087272644043  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141764640808105  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09825325012207031  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319419384002686  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323767185211182  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10278844833374023  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184149742126465  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187893390655518  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11149358749389648  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1400675773620605
pure train time :  0.4907231330871582
train time :  0.7669262886047363
end to end time :  5.428802013397217
connection check time:  2.6101510524749756
block generation time  1.3581929206848145
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040984153747558594
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01466679573059082
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3971869945526123
len local_batched_seeds_list  4
partition total batch output list spend :  0.5469615459442139
self.buckets_partition() spend  sec:  0.41188573837280273
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04520463943481445

in edges time spent  0.1535637378692627
local to global src and eids time spent  0.2858705520629883
time gen tails  0.0662987232208252
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12737441062927246

in edges time spent  0.5448017120361328
local to global src and eids time spent  0.8641664981842041
time gen tails  0.13517475128173828
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09451723098754883  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.913327217102051  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.912381172180176  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392833709716797  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132585048675537  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1362624168396  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0983591079711914  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.330039978027344  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.333440780639648  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10280179977416992  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188673496246338  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19241714477539  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11154031753540039  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1367239952087402
pure train time :  0.498044490814209
train time :  0.764411449432373
end to end time :  5.247145414352417
connection check time:  2.5719797611236572
block generation time  1.3483905792236328
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004942417144775391
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014508962631225586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47516775131225586
len local_batched_seeds_list  4
partition total batch output list spend :  0.6240949630737305
self.buckets_partition() spend  sec:  0.48970961570739746
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0427556037902832

in edges time spent  0.15021157264709473
local to global src and eids time spent  0.2873516082763672
time gen tails  0.06635284423828125
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12637591361999512

in edges time spent  0.5640213489532471
local to global src and eids time spent  0.9032514095306396
time gen tails  0.14562606811523438
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09477663040161133  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926362037658691  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925415515899658  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384965896606445  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136253356933594  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139930725097656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831762313842773  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32469654083252  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328097343444824  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10242176055908203  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.192438125610352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.195838928222656  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11172866821289062  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1373422145843506
pure train time :  0.4942471981048584
train time :  0.7650096416473389
end to end time :  5.42643666267395
connection check time:  2.6544952392578125
block generation time  1.3657832145690918
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004100799560546875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014399051666259766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4764838218688965
len local_batched_seeds_list  4
partition total batch output list spend :  0.6278665065765381
self.buckets_partition() spend  sec:  0.49091386795043945
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04326820373535156

in edges time spent  0.15838217735290527
local to global src and eids time spent  0.28873682022094727
time gen tails  0.06883502006530762
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12845444679260254

in edges time spent  0.5621085166931152
local to global src and eids time spent  0.8625288009643555
time gen tails  0.13991928100585938
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09404325485229492  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929376125335693  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92842960357666  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395074844360352  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.122677326202393  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.126354694366455  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09833478927612305  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321874141693115  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32527494430542  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1033787727355957  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19373083114624  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.197311878204346  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11297416687011719  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1355295181274414
pure train time :  0.4950733184814453
train time :  0.7659375667572021
end to end time :  5.384646892547607
connection check time:  2.6168785095214844
block generation time  1.3589768409729004
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004143714904785156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014845132827758789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48136377334594727
len local_batched_seeds_list  4
partition total batch output list spend :  0.6306438446044922
self.buckets_partition() spend  sec:  0.49625301361083984
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04325556755065918

in edges time spent  0.1535947322845459
local to global src and eids time spent  0.18469762802124023
time gen tails  0.04878401756286621
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12537670135498047

in edges time spent  0.5563921928405762
local to global src and eids time spent  0.8534367084503174
time gen tails  0.13527512550354004
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09453296661376953  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9139838218688965  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.913039207458496  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392166137695312  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.129693031311035  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133370399475098  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982213020324707  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319897651672363  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323298454284668  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10347318649291992  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186158180236816  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189739227294922  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11188602447509766  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1330409049987793
pure train time :  0.502906322479248
train time :  0.7667417526245117
end to end time :  5.223012685775757
connection check time:  2.450709581375122
block generation time  1.359792709350586
Run 00 | Epoch 00120 | Loss 1.1330 | Test 0.6267
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003960132598876953
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014370203018188477
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5138297080993652
len local_batched_seeds_list  4
partition total batch output list spend :  0.6637001037597656
self.buckets_partition() spend  sec:  0.5282385349273682
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042650461196899414

in edges time spent  0.1499013900756836
local to global src and eids time spent  0.2875831127166748
time gen tails  0.0665276050567627
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12803411483764648

in edges time spent  0.5552945137023926
local to global src and eids time spent  0.8543186187744141
time gen tails  0.13533687591552734
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09426593780517578  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.963881492614746  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.962935447692871  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389257431030273  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139046669006348  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14272403717041  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09913778305053711  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323467254638672  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326868057250977  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10234737396240234  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182131290435791  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185532093048096  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1106877326965332  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1281592845916748
pure train time :  0.49088478088378906
train time :  0.7688694000244141
end to end time :  5.386048793792725
connection check time:  2.5706207752227783
block generation time  1.3639469146728516
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040078163146972656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014582633972167969
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4847884178161621
len local_batched_seeds_list  4
partition total batch output list spend :  0.635261058807373
self.buckets_partition() spend  sec:  0.4994039535522461
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04280519485473633

in edges time spent  0.14854836463928223
local to global src and eids time spent  0.28696608543395996
time gen tails  0.06633877754211426
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1263585090637207

in edges time spent  0.553858757019043
local to global src and eids time spent  0.8565051555633545
time gen tails  0.1358661651611328
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389448165893555  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92484188079834  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923896312713623  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938572883605957  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139546871185303  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143224239349365  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0987849235534668  GigaBytes
Max Memory Allocated: 8.557762622833252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.334304332733154  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.338047981262207  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024160385131836  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181203842163086  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18460464477539  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11092329025268555  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1301907300949097
pure train time :  0.499117374420166
train time :  0.7664394378662109
end to end time :  5.3310387134552
connection check time:  2.5665457248687744
block generation time  1.3501603603363037
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039386749267578125
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014069557189941406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47876644134521484
len local_batched_seeds_list  4
partition total batch output list spend :  0.6277279853820801
self.buckets_partition() spend  sec:  0.49286675453186035
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0429232120513916

in edges time spent  0.15061450004577637
local to global src and eids time spent  0.2869143486022949
time gen tails  0.06590938568115234
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1259324550628662

in edges time spent  0.5321025848388672
local to global src and eids time spent  0.8575007915496826
time gen tails  0.13513636589050293
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09402942657470703  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92667818069458  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9257330894470215  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938868522644043  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137001991271973  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140679359436035  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0983433723449707  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32405948638916  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327460289001465  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10272693634033203  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181842803955078  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18558645248413  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11072731018066406  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1305402517318726
pure train time :  0.49632692337036133
train time :  0.7683017253875732
end to end time :  5.30632758140564
connection check time:  2.5466487407684326
block generation time  1.3467514514923096
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00045490264892578125
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014278173446655273
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5138051509857178
len local_batched_seeds_list  4
partition total batch output list spend :  0.6658957004547119
self.buckets_partition() spend  sec:  0.5281181335449219
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04466962814331055

in edges time spent  0.16352009773254395
local to global src and eids time spent  0.2901756763458252
time gen tails  0.06778573989868164
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12776589393615723

in edges time spent  0.5870711803436279
local to global src and eids time spent  0.8682999610900879
time gen tails  0.13694429397583008
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389019012451172  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924644470214844  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923698902130127  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09414434432983398  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.156734943389893  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.160412311553955  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09829950332641602  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323912143707275  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32731294631958  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10227203369140625  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.175452709197998  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.178853511810303  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11149406433105469  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.125539779663086
pure train time :  0.4845914840698242
train time :  0.7590689659118652
end to end time :  5.432006597518921
connection check time:  2.637938976287842
block generation time  1.3536865711212158
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004162788391113281
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014194726943969727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48189449310302734
len local_batched_seeds_list  4
partition total batch output list spend :  0.6308929920196533
self.buckets_partition() spend  sec:  0.49613142013549805
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04273486137390137

in edges time spent  0.1544482707977295
local to global src and eids time spent  0.2892622947692871
time gen tails  0.06689119338989258
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12573885917663574

in edges time spent  0.5272436141967773
local to global src and eids time spent  0.8575525283813477
time gen tails  0.13644695281982422
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395790100097656  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9246745109558105  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92372989654541  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09409761428833008  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149182319641113  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152859687805176  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09816884994506836  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.317780017852783  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321180820465088  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10278701782226562  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1831693649292  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186913013458252  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11080455780029297  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1261920928955078
pure train time :  0.48743152618408203
train time :  0.7607133388519287
end to end time :  5.306138753890991
connection check time:  2.549636125564575
block generation time  1.3521645069122314
Run 00 | Epoch 00125 | Loss 1.1262 | Test 0.6302
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039958953857421875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013857603073120117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48455142974853516
len local_batched_seeds_list  4
partition total batch output list spend :  0.6339821815490723
self.buckets_partition() spend  sec:  0.4984402656555176
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.046507835388183594

in edges time spent  0.1560525894165039
local to global src and eids time spent  0.2915351390838623
time gen tails  0.0663919448852539
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12934184074401855

in edges time spent  0.579801082611084
local to global src and eids time spent  0.9107463359832764
time gen tails  0.14507174491882324
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938868522644043  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92431116104126  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923364639282227  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09377574920654297  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.122754573822021  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.126431941986084  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09839344024658203  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327056884765625  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331404685974121  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1026153564453125  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179106712341309  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182850360870361  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11062049865722656  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1227689981460571
pure train time :  0.5057878494262695
train time :  0.7709226608276367
end to end time :  5.533853054046631
connection check time:  2.6921181678771973
block generation time  1.4242353439331055
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00039696693420410156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014172554016113281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48697733879089355
len local_batched_seeds_list  4
partition total batch output list spend :  0.637702226638794
self.buckets_partition() spend  sec:  0.5011847019195557
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042786359786987305

in edges time spent  0.15118789672851562
local to global src and eids time spent  0.2879955768585205
time gen tails  0.0666816234588623
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12659835815429688

in edges time spent  0.5718002319335938
local to global src and eids time spent  0.8714137077331543
time gen tails  0.13622522354125977
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09398698806762695  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.934549331665039  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.933603763580322  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390449523925781  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140909671783447  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14458703994751  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09905862808227539  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.310205936431885  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31360673904419  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10343074798583984  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18079137802124  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184372425079346  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11159276962280273  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1243658065795898
pure train time :  0.49704623222351074
train time :  0.772881269454956
end to end time :  5.39158296585083
connection check time:  2.6049704551696777
block generation time  1.3629770278930664
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004925727844238281
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014013051986694336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.39792823791503906
len local_batched_seeds_list  4
partition total batch output list spend :  0.5489344596862793
self.buckets_partition() spend  sec:  0.4119739532470703
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04281497001647949

in edges time spent  0.15082335472106934
local to global src and eids time spent  0.286820650100708
time gen tails  0.06634402275085449
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12755179405212402

in edges time spent  0.5168068408966064
local to global src and eids time spent  0.769782543182373
time gen tails  0.09996795654296875
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0937948226928711  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921504497528076  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920559406280518  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390449523925781  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.135775566101074  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139452934265137  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821128845214844  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32536506652832  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328765869140625  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10270023345947266  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186197757720947  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18994140625  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11097431182861328  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1208325624465942
pure train time :  0.5935652256011963
train time :  0.851454496383667
end to end time :  5.184156179428101
connection check time:  2.411895990371704
block generation time  1.358992576599121
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040602684020996094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01709914207458496
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41347336769104004
len local_batched_seeds_list  4
partition total batch output list spend :  0.5090787410736084
self.buckets_partition() spend  sec:  0.4306063652038574
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04419112205505371

in edges time spent  0.1507275104522705
local to global src and eids time spent  0.2874767780303955
time gen tails  0.06638312339782715
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1284804344177246

in edges time spent  0.5370998382568359
local to global src and eids time spent  0.8572990894317627
time gen tails  0.13622403144836426
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09409379959106445  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922053813934326  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921174049377441  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09383296966552734  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132825374603271  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136502742767334  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09818124771118164  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32300329208374  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326404094696045  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10342121124267578  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183880805969238  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187461853027344  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11193227767944336  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1196739673614502
pure train time :  0.49768972396850586
train time :  0.7627668380737305
end to end time :  5.205587863922119
connection check time:  2.5529911518096924
block generation time  1.3655650615692139
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041294097900390625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01427912712097168
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5343499183654785
len local_batched_seeds_list  4
partition total batch output list spend :  0.6873791217803955
self.buckets_partition() spend  sec:  0.5486772060394287
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04328155517578125

in edges time spent  0.1504051685333252
local to global src and eids time spent  0.28748559951782227
time gen tails  0.06653952598571777
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12948036193847656

in edges time spent  0.5329263210296631
local to global src and eids time spent  0.8553688526153564
time gen tails  0.13624167442321777
res  length 4
block collection to dataloader spend  1.7642974853515625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09424686431884766  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9237284660339355  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922848701477051  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09391307830810547  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141753673553467  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14543104171753  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09911108016967773  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32324504852295  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326645851135254  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1027369499206543  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182143688201904  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185887336730957  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11073446273803711  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.116136074066162
pure train time :  0.5004410743713379
train time :  0.7684595584869385
end to end time :  5.386795997619629
connection check time:  2.550750494003296
block generation time  1.3666765689849854
Run 00 | Epoch 00130 | Loss 1.1161 | Test 0.6265
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003886222839355469
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014708995819091797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5219225883483887
len local_batched_seeds_list  4
partition total batch output list spend :  0.671729564666748
self.buckets_partition() spend  sec:  0.5366671085357666
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.046004295349121094

in edges time spent  0.15915346145629883
local to global src and eids time spent  0.29047226905822754
time gen tails  0.06716752052307129
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1306290626525879

in edges time spent  0.5785977840423584
local to global src and eids time spent  0.8758423328399658
time gen tails  0.13765740394592285
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395885467529297  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.914930820465088  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9140520095825195  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.135804653167725  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139164447784424  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09827804565429688  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323011875152588  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326412677764893  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10261106491088867  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.177723407745361  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181467056274414  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1106104850769043  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1147339344024658
pure train time :  0.48825693130493164
train time :  0.7726788520812988
end to end time :  5.480726003646851
connection check time:  2.634828805923462
block generation time  1.3771030902862549
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004611015319824219
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014402389526367188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5154907703399658
len local_batched_seeds_list  4
partition total batch output list spend :  0.6675846576690674
self.buckets_partition() spend  sec:  0.5299279689788818
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0440983772277832

in edges time spent  0.16044330596923828
local to global src and eids time spent  0.28854966163635254
time gen tails  0.06844115257263184
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12872099876403809

in edges time spent  0.5791406631469727
local to global src and eids time spent  0.8633730411529541
time gen tails  0.1401515007019043
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09408855438232422  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.95909309387207  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9581475257873535  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09376335144042969  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137913703918457  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14159107208252  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0981907844543457  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318213939666748  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321614742279053  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10235357284545898  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184029579162598  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187430381774902  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11133766174316406  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1164997816085815
pure train time :  0.4943428039550781
train time :  0.7726130485534668
end to end time :  5.469821929931641
connection check time:  2.624573230743408
block generation time  1.3845231533050537
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004951953887939453
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014524698257446289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5255334377288818
len local_batched_seeds_list  4
partition total batch output list spend :  0.6767678260803223
self.buckets_partition() spend  sec:  0.540090799331665
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043128252029418945

in edges time spent  0.1556081771850586
local to global src and eids time spent  0.2879800796508789
time gen tails  0.06712889671325684
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12940764427185059

in edges time spent  0.5699553489685059
local to global src and eids time spent  0.8817219734191895
time gen tails  0.1374497413635254
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09453630447387695  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9254984855651855  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92463493347168  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09422731399536133  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141804218292236  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145481586456299  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09912252426147461  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31937026977539  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322771072387695  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1034083366394043  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184735774993896  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188316822052002  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11158466339111328  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1139920949935913
pure train time :  0.5061886310577393
train time :  0.7629292011260986
end to end time :  5.4439377784729
connection check time:  2.620814800262451
block generation time  1.364919662475586
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.000396728515625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013931035995483398
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.485431432723999
len local_batched_seeds_list  4
partition total batch output list spend :  0.6341254711151123
self.buckets_partition() spend  sec:  0.4993925094604492
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043753623962402344

in edges time spent  0.15376973152160645
local to global src and eids time spent  0.2907698154449463
time gen tails  0.06628656387329102
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12890386581420898

in edges time spent  0.5414929389953613
local to global src and eids time spent  0.8774869441986084
time gen tails  0.14061474800109863
res  length 4
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09408950805664062  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.959373950958252  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.958427906036377  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0938568115234375  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.124492645263672  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.128170013427734  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09838056564331055  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323523998260498  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326924800872803  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10243988037109375  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186753273010254  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190154075622559  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11080026626586914  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.110383152961731
pure train time :  0.5246264934539795
train time :  0.7866384983062744
end to end time :  5.4324023723602295
connection check time:  2.621281385421753
block generation time  1.3717882633209229
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004088878631591797
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014135360717773438
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5023193359375
len local_batched_seeds_list  4
partition total batch output list spend :  0.6514005661010742
self.buckets_partition() spend  sec:  0.5165023803710938
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04244422912597656

in edges time spent  0.15012311935424805
local to global src and eids time spent  0.2877199649810791
time gen tails  0.06636977195739746
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12949466705322266

in edges time spent  0.5308330059051514
local to global src and eids time spent  0.8576884269714355
time gen tails  0.13615775108337402
res  length 4
block collection to dataloader spend  1.71661376953125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939173698425293  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925698280334473  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924752235412598  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09418296813964844  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145245552062988  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14892292022705  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09822607040405273  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320446491241455  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32384729385376  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10242843627929688  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.198087692260742  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.201488494873047  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11142206192016602  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.109291911125183
pure train time :  0.5086827278137207
train time :  0.7700240612030029
end to end time :  5.352617025375366
connection check time:  2.54963755607605
block generation time  1.3605866432189941
Run 00 | Epoch 00135 | Loss 1.1093 | Test 0.6264
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040793418884277344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01603841781616211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5031931400299072
len local_batched_seeds_list  4
partition total batch output list spend :  0.654738187789917
self.buckets_partition() spend  sec:  0.5192677974700928
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04951977729797363

in edges time spent  0.16154932975769043
local to global src and eids time spent  0.2920658588409424
time gen tails  0.06757330894470215
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13139843940734863

in edges time spent  0.5840167999267578
local to global src and eids time spent  0.8730809688568115
time gen tails  0.13973188400268555
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09461021423339844  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.934107780456543  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9332451820373535  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09379816055297852  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.129366874694824  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133044242858887  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09910345077514648  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.330443382263184  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.333844184875488  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10239839553833008  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183276176452637  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186676979064941  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11128997802734375  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1097456216812134
pure train time :  0.4991276264190674
train time :  0.7862534523010254
end to end time :  5.484767913818359
connection check time:  2.649186849594116
block generation time  1.3720381259918213
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004181861877441406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014461755752563477
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4845294952392578
len local_batched_seeds_list  4
partition total batch output list spend :  0.6347103118896484
self.buckets_partition() spend  sec:  0.4990236759185791
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04329252243041992

in edges time spent  0.1590743064880371
local to global src and eids time spent  0.292755126953125
time gen tails  0.06637454032897949
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12910056114196777

in edges time spent  0.576430082321167
local to global src and eids time spent  0.9102139472961426
time gen tails  0.1445925235748291
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09426641464233398  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924661159515381  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923716068267822  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395265579223633  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.150017261505127  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.153377056121826  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828472137451172  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327805042266846  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.33120584487915  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10345458984375  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18406057357788  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187641620635986  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1116175651550293  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1075202226638794
pure train time :  0.4753870964050293
train time :  0.7616004943847656
end to end time :  5.525348901748657
connection check time:  2.689164161682129
block generation time  1.4270381927490234
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004341602325439453
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014317512512207031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5133504867553711
len local_batched_seeds_list  4
partition total batch output list spend :  0.6750965118408203
self.buckets_partition() spend  sec:  0.5277018547058105
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04686236381530762

in edges time spent  0.1665644645690918
local to global src and eids time spent  0.28981995582580566
time gen tails  0.07146835327148438
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1306471824645996

in edges time spent  0.6486845016479492
local to global src and eids time spent  0.9088075160980225
time gen tails  0.1496427059173584
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939035415649414  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921089172363281  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920209884643555  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09384346008300781  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.129494190216064  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133171558380127  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823751449584961  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328489303588867  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331890106201172  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10237693786621094  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.196399688720703  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.199800491333008  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11104059219360352  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1076340675354004
pure train time :  0.5157625675201416
train time :  0.766106367111206
end to end time :  5.644171476364136
connection check time:  2.774909734725952
block generation time  1.4135093688964844
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00043773651123046875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013816595077514648
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5063748359680176
len local_batched_seeds_list  4
partition total batch output list spend :  0.6618523597717285
self.buckets_partition() spend  sec:  0.5202252864837646
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042809486389160156

in edges time spent  0.15692949295043945
local to global src and eids time spent  0.29114794731140137
time gen tails  0.06796765327453613
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12936115264892578

in edges time spent  0.5426247119903564
local to global src and eids time spent  0.8581886291503906
time gen tails  0.14077019691467285
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09410810470581055  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92122745513916  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920281887054443  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397506713867188  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148882865905762  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152242660522461  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09838104248046875  GigaBytes
Max Memory Allocated: 8.558441162109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.336594104766846  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.33999490737915  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10348892211914062  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.194622993469238  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.198204040527344  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11183357238769531  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.104863166809082
pure train time :  0.498309850692749
train time :  0.768341064453125
end to end time :  5.394373655319214
connection check time:  2.579106569290161
block generation time  1.3632876873016357
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004200935363769531
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014094829559326172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.42830777168273926
len local_batched_seeds_list  4
partition total batch output list spend :  0.5814080238342285
self.buckets_partition() spend  sec:  0.44244837760925293
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04323530197143555

in edges time spent  0.15372872352600098
local to global src and eids time spent  0.2865896224975586
time gen tails  0.06665301322937012
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13002634048461914

in edges time spent  0.5454773902893066
local to global src and eids time spent  0.8888168334960938
time gen tails  0.14012503623962402
res  length 4
block collection to dataloader spend  1.811981201171875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09408950805664062  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924312591552734  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923366069793701  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388399124145508  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.126927852630615  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.130605220794678  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09833765029907227  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325061321258545  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32846212387085  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10227298736572266  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.197318077087402  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.200718879699707  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11122560501098633  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1044459342956543
pure train time :  0.5064854621887207
train time :  0.7830729484558105
end to end time :  5.360517978668213
connection check time:  2.6181066036224365
block generation time  1.3629300594329834
Run 00 | Epoch 00140 | Loss 1.1044 | Test 0.6288
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040721893310546875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01613640785217285
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41483020782470703
len local_batched_seeds_list  4
partition total batch output list spend :  0.5084235668182373
self.buckets_partition() spend  sec:  0.4310007095336914
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04767608642578125

in edges time spent  0.16199350357055664
local to global src and eids time spent  0.29151463508605957
time gen tails  0.06784534454345703
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12949657440185547

in edges time spent  0.5519964694976807
local to global src and eids time spent  0.8622667789459229
time gen tails  0.13732314109802246
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09414863586425781  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927938461303711  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927167892456055  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389448165893555  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.15062427520752  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.154301643371582  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828996658325195  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.312377452850342  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.315778255462646  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10232019424438477  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184433937072754  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187834739685059  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11175775527954102  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1024706363677979
pure train time :  0.5717475414276123
train time :  0.8359670639038086
end to end time :  5.333663702011108
connection check time:  2.5950467586517334
block generation time  1.380091667175293
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.000396728515625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014653444290161133
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4264392852783203
len local_batched_seeds_list  4
partition total batch output list spend :  0.5806522369384766
self.buckets_partition() spend  sec:  0.44112658500671387
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04252815246582031

in edges time spent  0.15038752555847168
local to global src and eids time spent  0.2862999439239502
time gen tails  0.06665444374084473
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12936735153198242

in edges time spent  0.5731673240661621
local to global src and eids time spent  0.8670849800109863
time gen tails  0.13671255111694336
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0945892333984375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9279046058654785  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92703914642334  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395170211791992  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133349418640137  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136709213256836  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09820747375488281  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31753396987915  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320934772491455  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10231637954711914  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179137229919434  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182538032531738  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11067533493041992  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.101101040840149
pure train time :  0.4826996326446533
train time :  0.7509133815765381
end to end time :  5.30875039100647
connection check time:  2.600963592529297
block generation time  1.361077070236206
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004878044128417969
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014569282531738281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47495460510253906
len local_batched_seeds_list  4
partition total batch output list spend :  0.6245245933532715
self.buckets_partition() spend  sec:  0.48955512046813965
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04277753829956055

in edges time spent  0.14780259132385254
local to global src and eids time spent  0.28742051124572754
time gen tails  0.06651830673217773
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12614178657531738

in edges time spent  0.5390458106994629
local to global src and eids time spent  0.8580741882324219
time gen tails  0.13736319541931152
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09398412704467773  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.961638927459717  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.960693359375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403514862060547  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142313480377197  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14599084854126  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09865093231201172  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320616245269775  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324359893798828  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10236406326293945  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181931972503662  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185332775115967  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11071968078613281  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1008031368255615
pure train time :  0.497875452041626
train time :  0.7612855434417725
end to end time :  5.310046911239624
connection check time:  2.5529205799102783
block generation time  1.3574225902557373
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042057037353515625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014683961868286133
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5127935409545898
len local_batched_seeds_list  4
partition total batch output list spend :  0.6665463447570801
self.buckets_partition() spend  sec:  0.5275099277496338
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04307818412780762

in edges time spent  0.14729905128479004
local to global src and eids time spent  0.2871408462524414
time gen tails  0.06704497337341309
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12775731086730957

in edges time spent  0.5366737842559814
local to global src and eids time spent  0.8240790367126465
time gen tails  0.10058903694152832
res  length 4
block collection to dataloader spend  1.239776611328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09399795532226562  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9333815574646  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.933197975158691  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388399124145508  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.139525413513184  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143202781677246  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831714630126953  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325685977935791  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329086780548096  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1023569107055664  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.167387962341309  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.170788764953613  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11182785034179688  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0988144874572754
pure train time :  0.47788333892822266
train time :  0.7557833194732666
end to end time :  5.278568506240845
connection check time:  2.48310923576355
block generation time  1.357323408126831
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00033545494079589844
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013907909393310547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.21429920196533203
len local_batched_seeds_list  4
partition total batch output list spend :  0.2721405029296875
self.buckets_partition() spend  sec:  0.22823810577392578
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.024641036987304688

in edges time spent  0.0815274715423584
local to global src and eids time spent  0.13022446632385254
time gen tails  0.041045427322387695
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.08471941947937012

in edges time spent  0.30277013778686523
local to global src and eids time spent  0.3590211868286133
time gen tails  0.08163833618164062
res  length 4
block collection to dataloader spend  7.867813110351562e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0945744514465332  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927157878875732  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926212310791016  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09380054473876953  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.12918758392334  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132864952087402  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09910821914672852  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32377815246582  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327178955078125  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10351419448852539  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190781116485596  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.194362163543701  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1125187873840332  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0953114032745361
pure train time :  0.4803783893585205
train time :  0.7492244243621826
end to end time :  3.28082013130188
connection check time:  1.2750651836395264
block generation time  0.9718189239501953
Run 00 | Epoch 00145 | Loss 1.0953 | Test 0.6264
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00043082237243652344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026404380798339844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5645890235900879
len local_batched_seeds_list  4
partition total batch output list spend :  0.7304537296295166
self.buckets_partition() spend  sec:  0.5910301208496094
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04610610008239746

in edges time spent  0.16416501998901367
local to global src and eids time spent  0.2917945384979248
time gen tails  0.06790471076965332
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12882065773010254

in edges time spent  0.612159013748169
local to global src and eids time spent  0.94693922996521
time gen tails  0.15023207664489746
res  length 4
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389352798461914  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9233598709106445  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922413349151611  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395170211791992  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.161818981170654  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.165496349334717  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982208251953125  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322078704833984  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325479507446289  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10241508483886719  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184144496917725  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18754529953003  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11076784133911133  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0928276777267456
pure train time :  0.5295224189758301
train time :  0.7868409156799316
end to end time :  5.775449752807617
connection check time:  2.7824037075042725
block generation time  1.4518346786499023
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00045228004455566406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01416158676147461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5438926219940186
len local_batched_seeds_list  4
partition total batch output list spend :  0.6982030868530273
self.buckets_partition() spend  sec:  0.5580933094024658
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043755531311035156

in edges time spent  0.15650606155395508
local to global src and eids time spent  0.288210391998291
time gen tails  0.06713128089904785
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12711358070373535

in edges time spent  0.5623035430908203
local to global src and eids time spent  0.8742771148681641
time gen tails  0.13807249069213867
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393501281738281  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924124240875244  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923177719116211  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939631462097168  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152463436126709  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.156140804290771  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09820890426635742  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323304653167725  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32670545578003  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10346031188964844  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190225601196289  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.193806648254395  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11162233352661133  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0946646928787231
pure train time :  0.5126457214355469
train time :  0.7669258117675781
end to end time :  5.454998970031738
connection check time:  2.608581066131592
block generation time  1.3655891418457031
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004992485046386719
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014609813690185547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.526106595993042
len local_batched_seeds_list  4
partition total batch output list spend :  0.6796391010284424
self.buckets_partition() spend  sec:  0.5407493114471436
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04316568374633789

in edges time spent  0.14827966690063477
local to global src and eids time spent  0.2872028350830078
time gen tails  0.06712722778320312
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12752962112426758

in edges time spent  0.5429675579071045
local to global src and eids time spent  0.8547348976135254
time gen tails  0.13600897789001465
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395647048950195  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.93286657333374  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.93268346786499  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393930435180664  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145890235900879  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149250030517578  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09831762313842773  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325424671173096  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.3288254737854  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1033167839050293  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182936191558838  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186517238616943  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11188268661499023  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0956658124923706
pure train time :  0.5227935314178467
train time :  0.7707011699676514
end to end time :  5.38296914100647
connection check time:  2.5564684867858887
block generation time  1.3632118701934814
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004487037658691406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013941049575805664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.517845630645752
len local_batched_seeds_list  4
partition total batch output list spend :  0.6689586639404297
self.buckets_partition() spend  sec:  0.5318179130554199
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04275846481323242

in edges time spent  0.14728260040283203
local to global src and eids time spent  0.2868025302886963
time gen tails  0.06691527366638184
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12464380264282227

in edges time spent  0.5369510650634766
local to global src and eids time spent  0.8563292026519775
time gen tails  0.13724899291992188
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09425497055053711  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920889854431152  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919944763183594  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939936637878418  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.158966541290283  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.162643909454346  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828805923461914  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324697017669678  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328097820281982  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1034698486328125  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187599658966064  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19118070602417  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11164522171020508  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.09014892578125
pure train time :  0.5136260986328125
train time :  0.7667515277862549
end to end time :  5.366084575653076
connection check time:  2.547933340072632
block generation time  1.3636081218719482
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004439353942871094
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014525175094604492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5135226249694824
len local_batched_seeds_list  4
partition total batch output list spend :  0.6654031276702881
self.buckets_partition() spend  sec:  0.5280911922454834
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04284501075744629

in edges time spent  0.14825749397277832
local to global src and eids time spent  0.2873866558074951
time gen tails  0.06676316261291504
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12415027618408203

in edges time spent  0.5291879177093506
local to global src and eids time spent  0.8567616939544678
time gen tails  0.1367785930633545
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388446807861328  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.917051315307617  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.916104793548584  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09380388259887695  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.117580890655518  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.12125825881958  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09908819198608398  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323615074157715  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32701587677002  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10262298583984375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181621074676514  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185364723205566  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11132049560546875  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0913140773773193
pure train time :  0.5246305465698242
train time :  0.7786316871643066
end to end time :  5.357306241989136
connection check time:  2.54007887840271
block generation time  1.3581578731536865
Run 00 | Epoch 00150 | Loss 1.0913 | Test 0.6267
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004055500030517578
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015568733215332031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4823448657989502
len local_batched_seeds_list  4
partition total batch output list spend :  0.6322388648986816
self.buckets_partition() spend  sec:  0.49794673919677734
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04594993591308594

in edges time spent  0.15964388847351074
local to global src and eids time spent  0.2915925979614258
time gen tails  0.0675511360168457
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12827396392822266

in edges time spent  0.5950045585632324
local to global src and eids time spent  0.8779025077819824
time gen tails  0.1388404369354248
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09456825256347656  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9330267906188965  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9322123527526855  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389734268188477  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144487380981445  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148164749145508  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821367263793945  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.31947946548462  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322880268096924  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10239267349243164  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188602924346924  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.192003726959229  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1110992431640625  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.086303472518921
pure train time :  0.5012609958648682
train time :  0.777341365814209
end to end time :  5.457132577896118
connection check time:  2.6553990840911865
block generation time  1.3733549118041992
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004279613494873047
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014418601989746094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48190736770629883
len local_batched_seeds_list  4
partition total batch output list spend :  0.6310069561004639
self.buckets_partition() spend  sec:  0.49635887145996094
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043001651763916016

in edges time spent  0.15683531761169434
local to global src and eids time spent  0.29104113578796387
time gen tails  0.06685447692871094
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12992596626281738

in edges time spent  0.5542688369750977
local to global src and eids time spent  0.8556580543518066
time gen tails  0.1408076286315918
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09428596496582031  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9208455085754395  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9198994636535645  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389114379882812  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13863468170166  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142312049865723  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09822750091552734  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323888301849365  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32728910446167  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10271644592285156  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151381015777588  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.15512466430664  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11225366592407227  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.088883638381958
pure train time :  0.5112142562866211
train time :  0.7715084552764893
end to end time :  5.376189231872559
connection check time:  2.5899746417999268
block generation time  1.3641180992126465
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005142688751220703
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014342784881591797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3966524600982666
len local_batched_seeds_list  4
partition total batch output list spend :  0.545466423034668
self.buckets_partition() spend  sec:  0.41103148460388184
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042848825454711914

in edges time spent  0.1498265266418457
local to global src and eids time spent  0.28726911544799805
time gen tails  0.06699848175048828
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12660646438598633

in edges time spent  0.5600435733795166
local to global src and eids time spent  0.8928961753845215
time gen tails  0.14232230186462402
res  length 4
block collection to dataloader spend  1.6450881958007812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09465742111206055  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.966325759887695  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.965458393096924  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09408712387084961  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147067546844482  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.150427341461182  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09824275970458984  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323174476623535  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32657527923584  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10332584381103516  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.146423816680908  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.150004863739014  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11214876174926758  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.084172010421753
pure train time :  0.5065407752990723
train time :  0.7576737403869629
end to end time :  5.35763144493103
connection check time:  2.6278977394104004
block generation time  1.4138848781585693
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.000431060791015625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014321565628051758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5400218963623047
len local_batched_seeds_list  4
partition total batch output list spend :  0.6932880878448486
self.buckets_partition() spend  sec:  0.5543766021728516
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043118953704833984

in edges time spent  0.15027999877929688
local to global src and eids time spent  0.28748059272766113
time gen tails  0.06677794456481934
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12626314163208008

in edges time spent  0.5320861339569092
local to global src and eids time spent  0.8589394092559814
time gen tails  0.1372849941253662
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09465551376342773  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920864582061768  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919919967651367  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09386682510375977  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133224964141846  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136902332305908  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823989868164062  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319846630096436  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32324743270874  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10275888442993164  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189987182617188  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19373083114624  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11105966567993164  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.086167335510254
pure train time :  0.5001749992370605
train time :  0.7566812038421631
end to end time :  5.381077766418457
connection check time:  2.5501952171325684
block generation time  1.3660004138946533
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004162788391113281
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014230012893676758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5001745223999023
len local_batched_seeds_list  4
partition total batch output list spend :  0.6515700817108154
self.buckets_partition() spend  sec:  0.5144455432891846
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043138742446899414

in edges time spent  0.14887690544128418
local to global src and eids time spent  0.28711915016174316
time gen tails  0.06705570220947266
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12631630897521973

in edges time spent  0.5469062328338623
local to global src and eids time spent  0.8562889099121094
time gen tails  0.13768935203552246
res  length 4
block collection to dataloader spend  8.821487426757812e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0942392349243164  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930480480194092  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929599761962891  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09382963180541992  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.123895645141602  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127573013305664  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823322296142578  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320677757263184  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324078559875488  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024332046508789  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1806001663208  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184000968933105  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11100959777832031  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.085428237915039
pure train time :  0.5049083232879639
train time :  0.7659687995910645
end to end time :  5.350241184234619
connection check time:  2.5608737468719482
block generation time  1.3584489822387695
Run 00 | Epoch 00155 | Loss 1.0854 | Test 0.6236
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004677772521972656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0167543888092041
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5386114120483398
len local_batched_seeds_list  4
partition total batch output list spend :  0.6281216144561768
self.buckets_partition() spend  sec:  0.5554013252258301
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.028774261474609375

in edges time spent  0.09221291542053223
local to global src and eids time spent  0.3049454689025879
time gen tails  0.06879353523254395
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13097119331359863

in edges time spent  0.6149272918701172
local to global src and eids time spent  0.9418292045593262
time gen tails  0.14094305038452148
res  length 4
block collection to dataloader spend  1.8596649169921875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09407567977905273  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923893928527832  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922947406768799  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09383010864257812  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143947124481201  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.147624492645264  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.099151611328125  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.33561897277832  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.339019775390625  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1034555435180664  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184396266937256  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187977313995361  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11230134963989258  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0828579664230347
pure train time :  0.5274887084960938
train time :  0.7975201606750488
end to end time :  5.521629810333252
connection check time:  2.6836588382720947
block generation time  1.3905704021453857
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004119873046875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015571117401123047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5241589546203613
len local_batched_seeds_list  4
partition total batch output list spend :  0.6746814250946045
self.buckets_partition() spend  sec:  0.5397660732269287
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.044483184814453125

in edges time spent  0.16802215576171875
local to global src and eids time spent  0.2892029285430908
time gen tails  0.06690263748168945
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12589097023010254

in edges time spent  0.5518224239349365
local to global src and eids time spent  0.8587839603424072
time gen tails  0.13814783096313477
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09460639953613281  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923954963684082  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923008918762207  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939178466796875  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127102375030518  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13077974319458  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09843921661376953  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328877449035645  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.33227825164795  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024022102355957  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184451580047607  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187852382659912  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11139869689941406  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0834506750106812
pure train time :  0.5139374732971191
train time :  0.7747619152069092
end to end time :  5.430423259735107
connection check time:  2.5921106338500977
block generation time  1.3757543563842773
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005075931549072266
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014011621475219727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5167708396911621
len local_batched_seeds_list  4
partition total batch output list spend :  0.7055585384368896
self.buckets_partition() spend  sec:  0.530813455581665
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0429995059967041

in edges time spent  0.1586759090423584
local to global src and eids time spent  0.2943403720855713
time gen tails  0.07054281234741211
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12969613075256348

in edges time spent  0.5735456943511963
local to global src and eids time spent  0.9324619770050049
time gen tails  0.14770746231079102
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09416675567626953  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919410705566406  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9184651374816895  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390449523925781  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142575740814209  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145935535430908  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09840965270996094  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327019691467285  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.33042049407959  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10344552993774414  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183703899383545  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18728494644165  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1126866340637207  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0795619487762451
pure train time :  0.5214712619781494
train time :  0.7886595726013184
end to end time :  5.646798849105835
connection check time:  2.7223448753356934
block generation time  1.4144713878631592
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004267692565917969
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014525413513183594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5242035388946533
len local_batched_seeds_list  4
partition total batch output list spend :  0.6767804622650146
self.buckets_partition() spend  sec:  0.5387623310089111
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04496264457702637

in edges time spent  0.16393733024597168
local to global src and eids time spent  0.298809289932251
time gen tails  0.07075047492980957
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13176250457763672

in edges time spent  0.5703587532043457
local to global src and eids time spent  0.8892881870269775
time gen tails  0.1382312774658203
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09458541870117188  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921626567840576  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920765399932861  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09415817260742188  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.143284320831299  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.146961688995361  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09912490844726562  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322316646575928  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325717449188232  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10239124298095703  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19592571258545  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.199326515197754  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11148214340209961  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0806267261505127
pure train time :  0.49184370040893555
train time :  0.7658390998840332
end to end time :  5.563266277313232
connection check time:  2.6843771934509277
block generation time  1.411992073059082
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00043845176696777344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014323949813842773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5513119697570801
len local_batched_seeds_list  4
partition total batch output list spend :  0.7042629718780518
self.buckets_partition() spend  sec:  0.5656833648681641
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04324603080749512

in edges time spent  0.14950942993164062
local to global src and eids time spent  0.2877044677734375
time gen tails  0.06699728965759277
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12618684768676758

in edges time spent  0.5376977920532227
local to global src and eids time spent  0.8609392642974854
time gen tails  0.13817167282104492
res  length 4
block collection to dataloader spend  1.1444091796875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09461069107055664  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9253458976745605  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924466609954834  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09409141540527344  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.129439353942871  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133116722106934  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09901857376098633  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322875022888184  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326275825500488  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1023263931274414  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185566425323486  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.188967227935791  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11107206344604492  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0778878927230835
pure train time :  0.4701690673828125
train time :  0.7570176124572754
end to end time :  5.422954559326172
connection check time:  2.559687852859497
block generation time  1.385061502456665
Run 00 | Epoch 00160 | Loss 1.0779 | Test 0.6213
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004036426544189453
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014901161193847656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5156776905059814
len local_batched_seeds_list  4
partition total batch output list spend :  0.6662657260894775
self.buckets_partition() spend  sec:  0.5306143760681152
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.046323299407958984

in edges time spent  0.15846562385559082
local to global src and eids time spent  0.2897837162017822
time gen tails  0.06850624084472656
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12909817695617676

in edges time spent  0.5546717643737793
local to global src and eids time spent  0.8602499961853027
time gen tails  0.13808965682983398
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09433507919311523  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9255523681640625  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924606800079346  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09400320053100586  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141776084899902  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145453453063965  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09812307357788086  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318242073059082  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322589874267578  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10273551940917969  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183530807495117  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18727445602417  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11135482788085938  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0768382549285889
pure train time :  0.4965658187866211
train time :  0.7753050327301025
end to end time :  5.4469521045684814
connection check time:  2.5947980880737305
block generation time  1.3913769721984863
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004069805145263672
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01586461067199707
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48620152473449707
len local_batched_seeds_list  4
partition total batch output list spend :  0.637152910232544
self.buckets_partition() spend  sec:  0.5020976066589355
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04508495330810547

in edges time spent  0.18744111061096191
local to global src and eids time spent  0.28681278228759766
time gen tails  0.06807422637939453
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12965703010559082

in edges time spent  0.5414261817932129
local to global src and eids time spent  0.8695907592773438
time gen tails  0.1419382095336914
res  length 4
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09449577331542969  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921851634979248  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920906066894531  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395790100097656  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145615100860596  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149292469024658  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09833669662475586  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321374416351318  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324775218963623  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10240840911865234  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183545112609863  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186945915222168  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11076784133911133  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0783331394195557
pure train time :  0.4901881217956543
train time :  0.7675435543060303
end to end time :  5.436368942260742
connection check time:  2.629232883453369
block generation time  1.380028247833252
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004773139953613281
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014471292495727539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48036861419677734
len local_batched_seeds_list  4
partition total batch output list spend :  0.6284904479980469
self.buckets_partition() spend  sec:  0.4948723316192627
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043804168701171875

in edges time spent  0.15801644325256348
local to global src and eids time spent  0.28774476051330566
time gen tails  0.06729674339294434
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12691950798034668

in edges time spent  0.5851180553436279
local to global src and eids time spent  0.8674840927124023
time gen tails  0.1367945671081543
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09406089782714844  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.958980083465576  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.958034038543701  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939188003540039  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.127896785736084  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.131256580352783  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09817218780517578  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.316890716552734  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320291519165039  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10274314880371094  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180273056030273  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18338918685913  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11117935180664062  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0771677494049072
pure train time :  0.4932856559753418
train time :  0.7606801986694336
end to end time :  5.382535934448242
connection check time:  2.621399164199829
block generation time  1.3585541248321533
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041031837463378906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014168024063110352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4856243133544922
len local_batched_seeds_list  4
partition total batch output list spend :  0.6343784332275391
self.buckets_partition() spend  sec:  0.49982619285583496
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04297924041748047

in edges time spent  0.15117120742797852
local to global src and eids time spent  0.2874419689178467
time gen tails  0.06718039512634277
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12444901466369629

in edges time spent  0.5552511215209961
local to global src and eids time spent  0.8782021999359131
time gen tails  0.13747715950012207
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09379386901855469  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.917245388031006  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.916300296783447  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389972686767578  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14798641204834  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151663780212402  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09843826293945312  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.332269668579102  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.335670471191406  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10338449478149414  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186365604400635  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18994665145874  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11217403411865234  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.073572039604187
pure train time :  0.5005815029144287
train time :  0.7628927230834961
end to end time :  5.366827487945557
connection check time:  2.596867799758911
block generation time  1.3597261905670166
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.000400543212890625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014245986938476562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.39637112617492676
len local_batched_seeds_list  4
partition total batch output list spend :  0.5458998680114746
self.buckets_partition() spend  sec:  0.4106602668762207
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04318094253540039

in edges time spent  0.14993786811828613
local to global src and eids time spent  0.2887239456176758
time gen tails  0.06712865829467773
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1254258155822754

in edges time spent  0.5361008644104004
local to global src and eids time spent  0.87259840965271
time gen tails  0.13692784309387207
res  length 4
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09460830688476562  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925313949584961  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924434661865234  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09412336349487305  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137429237365723  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140918254852295  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09920644760131836  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320574283599854  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.323975086212158  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10240459442138672  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180962085723877  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184362888336182  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11074972152709961  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0699725151062012
pure train time :  0.5072178840637207
train time :  0.7688360214233398
end to end time :  5.277437686920166
connection check time:  2.579604387283325
block generation time  1.3687505722045898
Run 00 | Epoch 00165 | Loss 1.0700 | Test 0.6229
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004210472106933594
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015271186828613281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.39797258377075195
len local_batched_seeds_list  4
partition total batch output list spend :  0.5490283966064453
self.buckets_partition() spend  sec:  0.41327929496765137
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04593467712402344

in edges time spent  0.15909862518310547
local to global src and eids time spent  0.29285359382629395
time gen tails  0.06864023208618164
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12706804275512695

in edges time spent  0.5972018241882324
local to global src and eids time spent  0.875295877456665
time gen tails  0.13780927658081055
res  length 4
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394264221191406  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919678211212158  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918732643127441  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09396219253540039  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.151308536529541  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.154985904693604  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09825515747070312  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322366714477539  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325767517089844  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1034708023071289  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182330131530762  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185911178588867  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11164140701293945  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0694950819015503
pure train time :  0.5133061408996582
train time :  0.781538724899292
end to end time :  5.394707918167114
connection check time:  2.652940511703491
block generation time  1.3881523609161377
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040435791015625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014635086059570312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5274510383605957
len local_batched_seeds_list  4
partition total batch output list spend :  0.677269697189331
self.buckets_partition() spend  sec:  0.542119026184082
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043109893798828125

in edges time spent  0.15410637855529785
local to global src and eids time spent  0.2880532741546631
time gen tails  0.06736326217651367
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1270766258239746

in edges time spent  0.5545032024383545
local to global src and eids time spent  0.8563153743743896
time gen tails  0.13904547691345215
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939178466796875  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92534065246582  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924394607543945  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09418106079101562  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152044773101807  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.15572214126587  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821128845214844  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318835258483887  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322236061096191  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024179458618164  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19685697555542  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.200257778167725  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11076879501342773  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.067288875579834
pure train time :  0.4989748001098633
train time :  0.7634286880493164
end to end time :  5.39481258392334
connection check time:  2.577815055847168
block generation time  1.3598322868347168
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004036426544189453
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014201879501342773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47721266746520996
len local_batched_seeds_list  4
partition total batch output list spend :  0.6251730918884277
self.buckets_partition() spend  sec:  0.49144625663757324
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043010711669921875

in edges time spent  0.15033888816833496
local to global src and eids time spent  0.286818265914917
time gen tails  0.06670475006103516
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12744712829589844

in edges time spent  0.533583402633667
local to global src and eids time spent  0.855494499206543
time gen tails  0.13642573356628418
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09387445449829102  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92716646194458  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926220417022705  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09375190734863281  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1265287399292  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.130206108093262  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.099029541015625  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.330142498016357  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.333543300628662  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10327863693237305  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1858229637146  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189404010772705  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1117706298828125  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0716214179992676
pure train time :  0.48886632919311523
train time :  0.7624368667602539
end to end time :  5.310626029968262
connection check time:  2.547191619873047
block generation time  1.3591587543487549
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041604042053222656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01426553726196289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48007845878601074
len local_batched_seeds_list  4
partition total batch output list spend :  0.6293244361877441
self.buckets_partition() spend  sec:  0.49437594413757324
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04285788536071777

in edges time spent  0.15004730224609375
local to global src and eids time spent  0.286879301071167
time gen tails  0.06675052642822266
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.13148093223571777

in edges time spent  0.5526752471923828
local to global src and eids time spent  0.8551244735717773
time gen tails  0.13703560829162598
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09423351287841797  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.9288811683654785  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92793607711792  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390592575073242  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.146098613739014  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149775981903076  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828472137451172  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328517436981201  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331918239593506  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10227727890014648  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.17370891571045  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.177109718322754  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11148881912231445  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0665395259857178
pure train time :  0.4850735664367676
train time :  0.7590298652648926
end to end time :  5.350706577301025
connection check time:  2.5729916095733643
block generation time  1.3721179962158203
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003991127014160156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014368057250976562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4828011989593506
len local_batched_seeds_list  4
partition total batch output list spend :  0.6318423748016357
self.buckets_partition() spend  sec:  0.4972100257873535
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042676687240600586

in edges time spent  0.14982175827026367
local to global src and eids time spent  0.2879025936126709
time gen tails  0.06672430038452148
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12542462348937988

in edges time spent  0.5302999019622803
local to global src and eids time spent  0.8728487491607666
time gen tails  0.14386749267578125
res  length 4
block collection to dataloader spend  9.298324584960938e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393119812011719  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.917260646820068  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.916316032409668  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09386348724365234  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145661354064941  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149338722229004  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09842586517333984  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331835746765137  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.335236549377441  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10332632064819336  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149430274963379  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.153011322021484  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1124114990234375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.063843846321106
pure train time :  0.4974818229675293
train time :  0.7662918567657471
end to end time :  5.349754571914673
connection check time:  2.573955774307251
block generation time  1.363896369934082
Run 00 | Epoch 00170 | Loss 1.0638 | Test 0.6225
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040793418884277344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014046192169189453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5153799057006836
len local_batched_seeds_list  4
partition total batch output list spend :  0.6630458831787109
self.buckets_partition() spend  sec:  0.5294618606567383
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04375267028808594

in edges time spent  0.16287922859191895
local to global src and eids time spent  0.2952537536621094
time gen tails  0.06871151924133301
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12618732452392578

in edges time spent  0.5901579856872559
local to global src and eids time spent  0.8635978698730469
time gen tails  0.1394946575164795
res  length 4
block collection to dataloader spend  1.1682510375976562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392595291137695  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918797969818115  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918716907501221  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09389162063598633  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138390064239502  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.142133712768555  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982513427734375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322139739990234  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325540542602539  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024618148803711  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.180953979492188  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184354782104492  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11146402359008789  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.064523458480835
pure train time :  0.5070071220397949
train time :  0.7752771377563477
end to end time :  5.469331979751587
connection check time:  2.6393439769744873
block generation time  1.372025489807129
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040030479431152344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013978719711303711
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4856855869293213
len local_batched_seeds_list  4
partition total batch output list spend :  0.6343510150909424
self.buckets_partition() spend  sec:  0.4996969699859619
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04283761978149414

in edges time spent  0.15224385261535645
local to global src and eids time spent  0.28868961334228516
time gen tails  0.06737184524536133
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12771034240722656

in edges time spent  0.5461273193359375
local to global src and eids time spent  0.8571665287017822
time gen tails  0.13701891899108887
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09454011917114258  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923933982849121  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923053741455078  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09382820129394531  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.136930465698242  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140607833862305  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09821033477783203  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.308687210083008  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.312088012695312  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10350465774536133  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184250354766846  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187831401824951  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11197042465209961  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0647004842758179
pure train time :  0.5054631233215332
train time :  0.767327070236206
end to end time :  5.354558944702148
connection check time:  2.5678162574768066
block generation time  1.3633348941802979
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004878044128417969
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014328956604003906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5031182765960693
len local_batched_seeds_list  4
partition total batch output list spend :  0.6554112434387207
self.buckets_partition() spend  sec:  0.5174798965454102
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04303884506225586

in edges time spent  0.1493678092956543
local to global src and eids time spent  0.28681278228759766
time gen tails  0.06688690185546875
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12852859497070312

in edges time spent  0.5371487140655518
local to global src and eids time spent  0.8536360263824463
time gen tails  0.1368086338043213
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09427547454833984  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921624660491943  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.92067813873291  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09391403198242188  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145098209381104  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148775577545166  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09827184677124023  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321697235107422  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325098037719727  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10237836837768555  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18584156036377  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189242362976074  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11072254180908203  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0616626739501953
pure train time :  0.48958587646484375
train time :  0.763758659362793
end to end time :  5.352336406707764
connection check time:  2.5515496730804443
block generation time  1.3659486770629883
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004260540008544922
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014215469360351562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48374056816101074
len local_batched_seeds_list  4
partition total batch output list spend :  0.6328413486480713
self.buckets_partition() spend  sec:  0.4979875087738037
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04354047775268555

in edges time spent  0.14946889877319336
local to global src and eids time spent  0.287839412689209
time gen tails  0.06712603569030762
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12949419021606445

in edges time spent  0.5302538871765137
local to global src and eids time spent  0.8553743362426758
time gen tails  0.13716959953308105
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09403657913208008  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.962385177612305  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.961439609527588  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09379243850708008  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.12877893447876  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.132456302642822  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09826326370239258  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.3251051902771  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328505992889404  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10343074798583984  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19699239730835  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.200108528137207  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11084699630737305  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0591152906417847
pure train time :  0.4877603054046631
train time :  0.7636163234710693
end to end time :  5.325060129165649
connection check time:  2.548866033554077
block generation time  1.3667163848876953
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042319297790527344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014199256896972656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48128199577331543
len local_batched_seeds_list  4
partition total batch output list spend :  0.6308803558349609
self.buckets_partition() spend  sec:  0.49552369117736816
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.043290138244628906

in edges time spent  0.14957785606384277
local to global src and eids time spent  0.28669047355651855
time gen tails  0.06713604927062988
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12662005424499512

in edges time spent  0.5267477035522461
local to global src and eids time spent  0.8555507659912109
time gen tails  0.13672089576721191
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392356872558594  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.923438549041748  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.922492027282715  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388160705566406  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.128893852233887  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13257122039795  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09823274612426758  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.319000244140625  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32240104675293  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024174690246582  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.198577880859375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.20197868347168  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11137866973876953  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0578124523162842
pure train time :  0.500173807144165
train time :  0.766765832901001
end to end time :  5.31631326675415
connection check time:  2.541349411010742
block generation time  1.3642654418945312
Run 00 | Epoch 00175 | Loss 1.0578 | Test 0.6258
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004525184631347656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015212059020996094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5251736640930176
len local_batched_seeds_list  4
partition total batch output list spend :  0.6799099445343018
self.buckets_partition() spend  sec:  0.5404195785522461
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04628276824951172

in edges time spent  0.15975236892700195
local to global src and eids time spent  0.28850507736206055
time gen tails  0.06865072250366211
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1277453899383545

in edges time spent  0.5946352481842041
local to global src and eids time spent  0.9038422107696533
time gen tails  0.13833308219909668
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0945582389831543  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926268577575684  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925363540649414  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395074844360352  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.154463768005371  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.158141136169434  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09901714324951172  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.315030574798584  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318431377410889  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024179458618164  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18360948562622  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187010288238525  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11077260971069336  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0585050582885742
pure train time :  0.5103960037231445
train time :  0.7721643447875977
end to end time :  5.516475200653076
connection check time:  2.6769003868103027
block generation time  1.3698530197143555
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00044465065002441406
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01456141471862793
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5062768459320068
len local_batched_seeds_list  4
partition total batch output list spend :  0.6625142097473145
self.buckets_partition() spend  sec:  0.5208694934844971
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.0434112548828125

in edges time spent  0.15190362930297852
local to global src and eids time spent  0.28774142265319824
time gen tails  0.06722831726074219
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1268470287322998

in edges time spent  0.5851922035217285
local to global src and eids time spent  0.8710508346557617
time gen tails  0.14188504219055176
res  length 4
block collection to dataloader spend  1.71661376953125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09395599365234375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.928041458129883  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927095413208008  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09402704238891602  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.138354301452637  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141714096069336  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09820938110351562  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.321362495422363  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324763298034668  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10236740112304688  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18009090423584  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.183491706848145  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11090326309204102  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0568420886993408
pure train time :  0.5108258724212646
train time :  0.7906386852264404
end to end time :  5.507495880126953
connection check time:  2.669337511062622
block generation time  1.3645591735839844
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.000522613525390625
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014114618301391602
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3926520347595215
len local_batched_seeds_list  4
partition total batch output list spend :  0.542212724685669
self.buckets_partition() spend  sec:  0.40680384635925293
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04349207878112793

in edges time spent  0.15028643608093262
local to global src and eids time spent  0.2870168685913086
time gen tails  0.06728625297546387
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12659120559692383

in edges time spent  0.5501317977905273
local to global src and eids time spent  0.8567371368408203
time gen tails  0.1370072364807129
res  length 4
block collection to dataloader spend  1.2636184692382812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09375953674316406  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.904524326324463  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.903579235076904  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09393501281738281  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144213676452637  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.1478910446167  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09828662872314453  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.3223237991333  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325724601745605  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10232019424438477  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18157434463501  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184975147247314  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11133956909179688  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.056445837020874
pure train time :  0.4884989261627197
train time :  0.7588217258453369
end to end time :  5.2578301429748535
connection check time:  2.5664496421813965
block generation time  1.369558334350586
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00041556358337402344
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01432037353515625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5085225105285645
len local_batched_seeds_list  4
partition total batch output list spend :  0.6578545570373535
self.buckets_partition() spend  sec:  0.5228750705718994
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04295754432678223

in edges time spent  0.15035653114318848
local to global src and eids time spent  0.28732991218566895
time gen tails  0.06709671020507812
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1261589527130127

in edges time spent  0.5169210433959961
local to global src and eids time spent  0.763585090637207
time gen tails  0.10096597671508789
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09462165832519531  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.925620079040527  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.924740314483643  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09412479400634766  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.150434494018555  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.154111862182617  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09829521179199219  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327436923980713  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.330837726593018  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10347652435302734  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18261432647705  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.186195373535156  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1116490364074707  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.056312084197998
pure train time :  0.4946143627166748
train time :  0.761305570602417
end to end time :  5.205459117889404
connection check time:  2.404419183731079
block generation time  1.3695094585418701
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00042366981506347656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015565872192382812
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4532735347747803
len local_batched_seeds_list  4
partition total batch output list spend :  0.5382742881774902
self.buckets_partition() spend  sec:  0.46888303756713867
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.024143457412719727

in edges time spent  0.08346033096313477
local to global src and eids time spent  0.11291289329528809
time gen tails  0.03989672660827637
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.08512234687805176

in edges time spent  0.3069584369659424
local to global src and eids time spent  0.3589763641357422
time gen tails  0.08328461647033691
res  length 4
block collection to dataloader spend  7.867813110351562e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09407567977905273  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.930281162261963  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929335117340088  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0939183235168457  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.145963191986084  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149640560150146  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09825706481933594  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322286128997803  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325686931610107  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10225057601928711  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.179153442382812  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.182554244995117  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11173009872436523  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0546619892120361
pure train time :  0.4619896411895752
train time :  0.7399232387542725
end to end time :  3.5313637256622314
connection check time:  1.254249095916748
block generation time  0.9879095554351807
Run 00 | Epoch 00180 | Loss 1.0547 | Test 0.6224
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00036907196044921875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013158559799194336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.20181846618652344
len local_batched_seeds_list  4
partition total batch output list spend :  0.2578556537628174
self.buckets_partition() spend  sec:  0.21500349044799805
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.024269580841064453

in edges time spent  0.08455920219421387
local to global src and eids time spent  0.11268925666809082
time gen tails  0.040222883224487305
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.08565521240234375

in edges time spent  0.3031430244445801
local to global src and eids time spent  0.35698461532592773
time gen tails  0.08375930786132812
res  length 4
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09456014633178711  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.916482925415039  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.915640354156494  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09398126602172852  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.16019344329834  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.163553237915039  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09829092025756836  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.326674938201904  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.330075740814209  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10338926315307617  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190314769744873  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.193895816802979  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11190080642700195  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.054398775100708
pure train time :  0.47359442710876465
train time :  0.7428257465362549
end to end time :  3.251429796218872
connection check time:  1.2513809204101562
block generation time  0.9917593002319336
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0003800392150878906
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013571500778198242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2052931785583496
len local_batched_seeds_list  4
partition total batch output list spend :  0.2620885372161865
self.buckets_partition() spend  sec:  0.21888947486877441
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.024145126342773438

in edges time spent  0.0834500789642334
local to global src and eids time spent  0.11354780197143555
time gen tails  0.04002737998962402
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.08473515510559082

in edges time spent  0.5261886119842529
local to global src and eids time spent  0.7657465934753418
time gen tails  0.10157561302185059
res  length 4
block collection to dataloader spend  9.775161743164062e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09428834915161133  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918210506439209  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.917264938354492  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09390449523925781  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.131031036376953  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.134708404541016  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.098297119140625  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.322449684143066  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.325850486755371  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.102386474609375  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18626594543457  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.189666748046875  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1110224723815918  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.052962303161621
pure train time :  0.46780824661254883
train time :  0.7394452095031738
end to end time :  4.312867879867554
connection check time:  2.0235471725463867
block generation time  1.2746434211730957
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004532337188720703
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013382196426391602
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.20678114891052246
len local_batched_seeds_list  4
partition total batch output list spend :  0.2626302242279053
self.buckets_partition() spend  sec:  0.22018933296203613
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.024384260177612305

in edges time spent  0.08320927619934082
local to global src and eids time spent  0.11321163177490234
time gen tails  0.04005551338195801
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.08482694625854492

in edges time spent  0.30431199073791504
local to global src and eids time spent  0.35955357551574707
time gen tails  0.11332988739013672
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09420633316040039  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.919735908508301  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.918789863586426  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09383773803710938  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.133563041687012  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.137240409851074  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09840106964111328  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.33123779296875  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.335585594177246  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10291099548339844  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.191473484039307  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.19521713256836  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1115427017211914  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0486772060394287
pure train time :  0.5032763481140137
train time :  0.7641479969024658
end to end time :  3.714250087738037
connection check time:  1.4068183898925781
block generation time  1.2715134620666504
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004220008850097656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013870000839233398
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4844675064086914
len local_batched_seeds_list  4
partition total batch output list spend :  0.6327672004699707
self.buckets_partition() spend  sec:  0.4983687400817871
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.042754173278808594

in edges time spent  0.14891290664672852
local to global src and eids time spent  0.28551745414733887
time gen tails  0.06716203689575195
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12585139274597168

in edges time spent  0.5283219814300537
local to global src and eids time spent  0.8549997806549072
time gen tails  0.13771963119506836
res  length 4
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09375810623168945  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.909648418426514  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.908701419830322  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09400129318237305  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152569770812988  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.15624713897705  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09918689727783203  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.327649116516113  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.331049919128418  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10337400436401367  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.181040287017822  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.184621334075928  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.111541748046875  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.049361228942871
pure train time :  0.5068931579589844
train time :  0.7720720767974854
end to end time :  5.323675870895386
connection check time:  2.5396432876586914
block generation time  1.3668644428253174
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004143714904785156
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013888359069824219
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4813692569732666
len local_batched_seeds_list  4
partition total batch output list spend :  0.6304693222045898
self.buckets_partition() spend  sec:  0.4953012466430664
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04256725311279297

in edges time spent  0.14962482452392578
local to global src and eids time spent  0.28528857231140137
time gen tails  0.06709885597229004
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1270430088043213

in edges time spent  0.5346653461456299
local to global src and eids time spent  0.8550014495849609
time gen tails  0.13750362396240234
res  length 4
block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397602081298828  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.929398059844971  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.928452491760254  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09394359588623047  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.141106128692627  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144465923309326  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09832906723022461  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.328607082366943  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.332007884979248  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10328817367553711  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140627384185791  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144208431243896  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11156558990478516  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0481492280960083
pure train time :  0.4939403533935547
train time :  0.7750029563903809
end to end time :  5.353628635406494
connection check time:  2.551762104034424
block generation time  1.3799428939819336
Run 00 | Epoch 00185 | Loss 1.0481 | Test 0.6247
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00040841102600097656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014164209365844727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4823288917541504
len local_batched_seeds_list  4
partition total batch output list spend :  0.6320955753326416
self.buckets_partition() spend  sec:  0.4965248107910156
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.045850276947021484

in edges time spent  0.1602461338043213
local to global src and eids time spent  0.2904953956604004
time gen tails  0.0684657096862793
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12865829467773438

in edges time spent  0.5638837814331055
local to global src and eids time spent  0.8615128993988037
time gen tails  0.13840436935424805
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09398984909057617  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.927218437194824  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.926340579986572  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09450769424438477  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.140754699707031  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.14411449432373  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0982365608215332  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32076644897461  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324167251586914  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10236310958862305  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18690013885498  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190300941467285  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11104869842529297  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0467983484268188
pure train time :  0.4820854663848877
train time :  0.7568035125732422
end to end time :  5.391394853591919
connection check time:  2.606999635696411
block generation time  1.379117727279663
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0004253387451171875
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01432037353515625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4855074882507324
len local_batched_seeds_list  4
partition total batch output list spend :  0.6352541446685791
self.buckets_partition() spend  sec:  0.4998602867126465
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04485821723937988

in edges time spent  0.1518397331237793
local to global src and eids time spent  0.28823304176330566
time gen tails  0.06713485717773438
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.12835049629211426

in edges time spent  0.5336716175079346
local to global src and eids time spent  0.8547451496124268
time gen tails  0.13734769821166992
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09425783157348633  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921924591064453  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920978546142578  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09388446807861328  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.149324417114258  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.152684211730957  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09818553924560547  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.320882320404053  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.324283123016357  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1024174690246582  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.187461853027344  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.190862655639648  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.1114053726196289  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0485774278640747
pure train time :  0.5242903232574463
train time :  0.7712998390197754
end to end time :  5.3514063358306885
connection check time:  2.554095983505249
block generation time  1.3767790794372559
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.0005207061767578125
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013906717300415039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5154886245727539
len local_batched_seeds_list  4
partition total batch output list spend :  0.6678950786590576
self.buckets_partition() spend  sec:  0.5294268131256104
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04259991645812988

in edges time spent  0.1492316722869873
local to global src and eids time spent  0.28663110733032227
time gen tails  0.06718325614929199
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1271839141845703

in edges time spent  0.5348718166351318
local to global src and eids time spent  0.8585324287414551
time gen tails  0.13842320442199707
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.0944972038269043  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.951992988586426  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.951113224029541  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09397506713867188  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13061237335205  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.13397216796875  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09819984436035156  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.318121910095215  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.32152271270752  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10231590270996094  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.193809986114502  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.197210788726807  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11065530776977539  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0458934307098389
pure train time :  0.4915344715118408
train time :  0.7541353702545166
end to end time :  5.353215932846069
connection check time:  2.5531699657440186
block generation time  1.3648874759674072
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3120
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [605 530 518 507 480 480]

remove bucket_id:  [3, 11, 12, 13, 14, 15]
original bucket_id :,  [7, 12, 13, 14, 0, 16]
remove weights:  [605 530 518 507 480 480], 		------------sum 3120

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [591 587 545 476 464 457]

remove bucket_id:  [4, 5, 9, 10, 11, 12]
original bucket_id :,  [8, 9, 1, 15, 17, 18]
remove weights:  [591 587 545 476 464 457], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 591, 587, 586, 560, 557, 545, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
res_tmp  [618 617 602 449 434 400]

remove bucket_id:  [0, 1, 3, 7, 8, 9]
original bucket_id :,  [5, 4, 3, 19, 20, 22]
remove weights:  [618 617 602 449 434 400], 		------------sum 3120

before remove weights,  [618, 617, 609, 602, 586, 560, 557, 449, 434, 400, 396, 394]
after remove pre pack weights,  [609, 586, 560, 557, 396, 394]
G_BUCKET_ID_list [[7, 12, 13, 14, 0, 16], [8, 9, 1, 15, 17, 18], [5, 4, 3, 19, 20, 22], [6, 2, 11, 10, 23, 21]]
Groups_mem_list  [[605, 530, 518, 507, 480, 480], [591, 587, 545, 476, 464, 457], [618, 617, 602, 449, 434, 400], [609, 586, 560, 557, 396, 394]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  3.1222821838204387
current group_mem  3.121879485129137
current group_mem  3.1221729978693658
current group_mem  3.1056644415633636
batches output list generation spend  0.00043892860412597656
self.weights_list  [0.27131876711274344, 0.24786399973609263, 0.25090993061435435, 0.22990730253680958]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013902664184570312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48397111892700195
len local_batched_seeds_list  4
partition total batch output list spend :  0.632094144821167
self.buckets_partition() spend  sec:  0.49790453910827637
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.04303288459777832

in edges time spent  0.15285992622375488
local to global src and eids time spent  0.28747081756591797
time gen tails  0.06747269630432129
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.1262836456298828

in edges time spent  0.5687277317047119
local to global src and eids time spent  0.911937952041626
time gen tails  0.14580464363098145
res  length 4
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09392833709716797  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.921901702880859  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 7.920956134796143  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09414196014404297  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.144888401031494  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.148632049560547  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.09837102890014648  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.329079627990723  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.332480430603027  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.10247135162353516  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.185826778411865  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 8.18922758102417  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 13.484375 GB
    Memory Allocated: 0.11149930953979492  GigaBytes
Max Memory Allocated: 8.561143398284912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0453380346298218
pure train time :  0.5449073314666748
train time :  0.7808468341827393
end to end time :  5.530831813812256
connection check time:  2.668802499771118
block generation time  1.435953140258789
end to end time  5.598714113235474
Total (block generation + training)time/epoch 5.598714113235474
pure train time per /epoch  [0.9281857013702393, 0.531644344329834, 0.5276615619659424, 0.4986259937286377, 0.4930081367492676, 0.49849462509155273, 0.4982311725616455, 0.5124258995056152, 0.4848177433013916, 0.5015079975128174, 0.4958009719848633, 0.49532198905944824, 0.48667454719543457, 0.5097296237945557, 0.5001764297485352, 0.49605369567871094, 0.4933359622955322, 0.5406982898712158, 0.5643160343170166, 0.5329861640930176, 0.5369598865509033, 0.4906172752380371, 0.5063068866729736, 0.4850132465362549, 0.5045876502990723, 0.510772705078125, 0.49995946884155273, 0.5159029960632324, 0.48191189765930176, 0.48061323165893555, 0.5040233135223389, 0.5006005764007568, 0.4994332790374756, 0.4887123107910156, 0.5113623142242432, 0.5073943138122559, 0.501469612121582, 0.5083792209625244, 0.529395341873169, 0.48647236824035645, 0.5164170265197754, 0.48905491828918457, 0.4933583736419678, 0.5122265815734863, 0.5073366165161133, 0.5010623931884766, 0.4851808547973633, 0.49564576148986816, 0.4942631721496582, 0.48323774337768555, 0.49634528160095215, 0.49315905570983887, 0.5046145915985107, 0.49779844284057617, 0.5102941989898682, 0.5310459136962891, 0.49810075759887695, 0.5001316070556641, 0.5162978172302246, 0.4956228733062744, 0.5199329853057861, 0.512995719909668, 0.5038056373596191, 0.504178524017334, 0.523836612701416, 0.4950838088989258, 0.503291130065918, 0.4734318256378174, 0.48017191886901855, 0.5181598663330078, 0.5108070373535156, 0.5212802886962891, 0.5058712959289551, 0.5028927326202393, 0.5001442432403564, 0.507239818572998, 0.5057835578918457, 0.49689364433288574, 0.490344762802124, 0.508589506149292, 0.5051298141479492, 0.5089082717895508, 0.5060436725616455, 0.4628126621246338, 0.5297958850860596, 0.49408912658691406, 0.4687964916229248, 0.47698974609375, 0.46903109550476074, 0.46790146827697754, 0.545382022857666, 0.46686792373657227, 0.5007266998291016, 0.5049138069152832, 0.5031905174255371, 0.4995768070220947, 0.5170238018035889, 0.530259370803833, 0.5347177982330322, 0.5081117153167725, 0.521376371383667, 0.5320262908935547, 0.5129203796386719, 0.5006768703460693, 0.5147578716278076, 0.5037133693695068, 0.49036455154418945, 0.5058889389038086, 0.5069150924682617, 0.5333530902862549, 0.4889659881591797, 0.492708683013916, 0.4990556240081787, 0.49601078033447266, 0.49925661087036133, 0.5302138328552246, 0.4907231330871582, 0.498044490814209, 0.4942471981048584, 0.4950733184814453, 0.502906322479248, 0.49088478088378906, 0.499117374420166, 0.49632692337036133, 0.4845914840698242, 0.48743152618408203, 0.5057878494262695, 0.49704623222351074, 0.5935652256011963, 0.49768972396850586, 0.5004410743713379, 0.48825693130493164, 0.4943428039550781, 0.5061886310577393, 0.5246264934539795, 0.5086827278137207, 0.4991276264190674, 0.4753870964050293, 0.5157625675201416, 0.498309850692749, 0.5064854621887207, 0.5717475414276123, 0.4826996326446533, 0.497875452041626, 0.47788333892822266, 0.4803783893585205, 0.5295224189758301, 0.5126457214355469, 0.5227935314178467, 0.5136260986328125, 0.5246305465698242, 0.5012609958648682, 0.5112142562866211, 0.5065407752990723, 0.5001749992370605, 0.5049083232879639, 0.5274887084960938, 0.5139374732971191, 0.5214712619781494, 0.49184370040893555, 0.4701690673828125, 0.4965658187866211, 0.4901881217956543, 0.4932856559753418, 0.5005815029144287, 0.5072178840637207, 0.5133061408996582, 0.4989748001098633, 0.48886632919311523, 0.4850735664367676, 0.4974818229675293, 0.5070071220397949, 0.5054631233215332, 0.48958587646484375, 0.4877603054046631, 0.500173807144165, 0.5103960037231445, 0.5108258724212646, 0.4884989261627197, 0.4946143627166748, 0.4619896411895752, 0.47359442710876465, 0.46780824661254883, 0.5032763481140137, 0.5068931579589844, 0.4939403533935547, 0.4820854663848877, 0.5242903232574463, 0.4915344715118408, 0.5449073314666748]
pure train time average  0.5027844893035068
input num  average  571220.2631578947
