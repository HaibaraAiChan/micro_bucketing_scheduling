main start at this time 1691638242.4287024
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  4
the grouping_fanout_arxiv called successfully
capacity  6300
 
sorted_dict  {4: 1237, 5: 1233, 6: 1219, 7: 1211, 3: 1206, 8: 1184, 9: 1176, 2: 1174, 11: 1121, 10: 1116, 1: 1092, 12: 1061, 13: 1035, 14: 1013, 16: 960, 15: 955, 0: 928, 17: 928, 18: 916, 19: 900, 20: 868, 22: 800, 23: 795, 21: 787}

weights after sort [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1219 1092 1061 1013  960  955]

remove bucket_id:  [2, 10, 11, 13, 14, 15]
original bucket_id :,  [6, 1, 12, 14, 16, 15]
remove weights:  [1219 1092 1061 1013  960  955], 		------------sum 6300

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1035, 928, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1184 1121 1116 1035  928  916]

remove bucket_id:  [4, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 11, 10, 13, 0, 18]
remove weights:  [1184 1121 1116 1035  928  916], 		------------sum 6300

before remove weights,  [1237, 1233, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1035, 928, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1211, 1206, 1176, 1174, 928, 900, 868, 800, 795, 787]
res_tmp  [1237 1233 1206  928  900  795]

remove bucket_id:  [0, 1, 3, 6, 7, 10]
original bucket_id :,  [4, 5, 3, 0, 19, 23]
remove weights:  [1237 1233 1206  928  900  795], 		------------sum 6299

before remove weights,  [1237, 1233, 1211, 1206, 1176, 1174, 928, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1211, 1176, 1174, 868, 800, 787]
G_BUCKET_ID_list [[6, 1, 12, 14, 16, 15], [8, 11, 10, 13, 0, 18], [4, 5, 3, 0, 19, 23], [7, 9, 2, 20, 22, 21]]
Groups_mem_list  [[1219, 1092, 1061, 1013, 960, 955], [1184, 1121, 1116, 1035, 928, 916], [1237, 1233, 1206, 928, 900, 795], [1211, 1176, 1174, 868, 800, 787]]
G_BUCKET_ID_list length 4
len(g_bucket_nids_list)  4
len(local_split_batches_nid_list)  4
current group_mem  6.301913490222002
current group_mem  6.303814864294991
current group_mem  6.302347663239465
current group_mem  6.019397373772354
batches output list generation spend  0.0008552074432373047
self.weights_list  [0.22912657657162336, 0.25086594605293544, 0.3647419755665761, 0.18847384568016626]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01500558853149414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7665910720825195
len local_batched_seeds_list  4
partition total batch output list spend :  0.9225711822509766
self.buckets_partition() spend  sec:  0.7816295623779297
layer  0
 the number of batches:  4
check_connections_block*********************************

the find indices time spent  0.046242475509643555

in edges time spent  0.10763239860534668
local to global src and eids time spent  0.2076735496520996
time gen tails  0.05178189277648926
res  length 4
layer  1
num of batch  4
check_connections_block*********************************

the find indices time spent  0.10468649864196777

in edges time spent  0.4323699474334717
local to global src and eids time spent  0.6809573173522949
time gen tails  0.11709475517272949
res  length 4
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.517578125 GB
    Memory Allocated: 0.07058286666870117  GigaBytes
Max Memory Allocated: 0.07058286666870117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.775390625 GB
    Memory Allocated: 6.047693729400635  GigaBytes
Max Memory Allocated: 6.203280448913574  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.775390625 GB
    Memory Allocated: 6.051509380340576  GigaBytes
Max Memory Allocated: 6.203280448913574  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.033203125 GB
    Memory Allocated: 0.08067989349365234  GigaBytes
Max Memory Allocated: 6.203280448913574  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.375 GB
    Memory Allocated: 5.926987648010254  GigaBytes
Max Memory Allocated: 6.203280448913574  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.375 GB
    Memory Allocated: 5.93062162399292  GigaBytes
Max Memory Allocated: 6.203280448913574  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.376953125 GB
    Memory Allocated: 0.0862727165222168  GigaBytes
Max Memory Allocated: 6.203280448913574  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.650390625 GB
    Memory Allocated: 6.151120662689209  GigaBytes
Max Memory Allocated: 6.335264682769775  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.650390625 GB
    Memory Allocated: 6.156064033508301  GigaBytes
Max Memory Allocated: 6.335264682769775  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.90625 GB
    Memory Allocated: 0.08761453628540039  GigaBytes
Max Memory Allocated: 6.335264682769775  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.923828125 GB
    Memory Allocated: 5.8694748878479  GigaBytes
Max Memory Allocated: 6.335264682769775  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.923828125 GB
    Memory Allocated: 5.8726606369018555  GigaBytes
Max Memory Allocated: 6.335264682769775  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 8.92578125 GB
    Memory Allocated: 0.09799623489379883  GigaBytes
Max Memory Allocated: 6.335264682769775  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.950352668762207
pure train time :  0.8610308170318604
train time :  1.5976080894470215
end to end time :  5.6350624561309814
connection check time:  2.0286481380462646
block generation time  1.0667271614074707
Total (block generation + training)time/epoch nan
pure train time per /epoch  [0.8610308170318604]
pure train time average  nan
input num  average  531864.0
