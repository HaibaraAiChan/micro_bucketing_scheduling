main start at this time 1697835429.812528
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
25
25
[0.14765617268338813, 0.12872081899253363, 0.10201119407088112, 0.08049174739666377, 0.06841798528716421, 0.05352921124685236, 0.04447938773490505, 0.038178599311641616, 0.03272451369569281, 0.028578968781957533, 0.02422449720148228, 0.02129952386712264, 0.01820960842744197, 0.01576846526869069, 0.014174024917254044, 0.012216711934111127, 0.011326024565377553, 0.010424341056289243, 0.009192773336558867, 0.00887388526627154, 0.007884232634345345, 0.006113854037232931, 0.005706996844107718, 0.005772973686236131, 0.10402348775579771]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014619827270507812
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0001270771026611328
len local_batched_seeds_list  25
partition total batch output list spend :  0.8983116149902344
self.buckets_partition() spend  sec:  0.014755487442016602
layer  0
 the number of batches:  25
check_connections_block*********************************

the find indices time spent  0.04547882080078125

in edges time spent  0.11550545692443848
local to global src and eids time spent  0.1578526496887207
time gen tails  0.12929630279541016
res  length 25
layer  1
num of batch  25
check_connections_block*********************************

the find indices time spent  0.16469979286193848

in edges time spent  0.910714864730835
local to global src and eids time spent  1.5865356922149658
time gen tails  0.33995723724365234
res  length 25
block collection to dataloader spend  5.269050598144531e-05
redundancy ratio #input/#seeds/degree
4.5709711051534105
3.1962668716897316
2.836585102942762
2.6987704918032787
2.577917068466731
2.6378731854286497
2.6331626346459474
2.620751728110599
2.6412037037037037
2.6608695652173915
2.697478644823175
2.78489072448804
2.843738387216648
2.9392309224945206
2.971088699250065
3.025146264626463
3.0591090805254137
3.063525550867323
3.203160412994208
3.088909541511772
3.2097363352593478
3.4603499018966644
3.534891513780682
3.4212698412698415
0.5195560253699789
layer  0
{1: 13428, 2: 1514, 3: 1424, 4: 1036, 5: 890, 6: 712, 7: 552, 8: 442, 9: 392, 10: 3685}
layer  1
{1: 13428}

layer  0
{1: 1525, 2: 12162, 3: 2064, 4: 1606, 5: 1420, 6: 1110, 7: 954, 8: 766, 9: 639, 10: 5875}
layer  1
{2: 11706}

layer  0
{1: 1582, 2: 2280, 3: 9755, 4: 1987, 5: 1726, 6: 1356, 7: 1163, 8: 966, 9: 828, 10: 7423}
layer  1
{3: 9277}

layer  0
{1: 1251, 2: 1864, 3: 2112, 4: 7759, 5: 1867, 6: 1529, 7: 1277, 8: 1115, 9: 912, 10: 8511}
layer  1
{4: 7320}

layer  0
{1: 1076, 2: 1735, 3: 2034, 4: 2003, 5: 6670, 6: 1576, 7: 1397, 8: 1196, 9: 1033, 10: 9513}
layer  1
{5: 6222}

layer  0
{1: 904, 2: 1401, 3: 1546, 4: 1745, 5: 1668, 6: 5231, 7: 1341, 8: 1178, 9: 993, 10: 9999}
layer  1
{6: 4868}

layer  0
{1: 724, 2: 1210, 3: 1421, 4: 1525, 5: 1541, 6: 1424, 7: 4368, 8: 1150, 9: 1022, 10: 10305}
layer  1
{7: 4045}

layer  0
{1: 615, 2: 990, 3: 1214, 4: 1372, 5: 1431, 6: 1273, 7: 1220, 8: 3789, 9: 1041, 10: 10789}
layer  1
{8: 3472}

layer  0
{1: 519, 2: 890, 3: 1092, 4: 1243, 5: 1253, 6: 1154, 7: 1128, 8: 1065, 9: 3251, 10: 10836}
layer  1
{9: 2976}

layer  0
{1: 457, 2: 779, 3: 940, 4: 1085, 5: 1115, 6: 1112, 7: 1051, 8: 1002, 9: 910, 10: 13099}
layer  1
{10: 2599}

layer  0
{1: 373, 2: 610, 3: 837, 4: 910, 5: 994, 6: 944, 7: 952, 8: 949, 9: 857, 10: 12460}
layer  1
{11: 2203}

layer  0
{1: 345, 2: 621, 3: 789, 4: 892, 5: 968, 6: 980, 7: 898, 8: 920, 9: 813, 10: 12180}
layer  1
{12: 1937}

layer  0
{1: 357, 2: 566, 3: 685, 4: 775, 5: 803, 6: 793, 7: 797, 8: 819, 9: 733, 10: 11507}
layer  1
{13: 1656}

layer  0
{1: 279, 2: 460, 3: 602, 4: 672, 5: 713, 6: 780, 7: 730, 8: 740, 9: 657, 10: 11030}
layer  1
{14: 1434}

layer  0
{1: 280, 2: 457, 3: 563, 4: 621, 5: 651, 6: 667, 7: 663, 8: 707, 9: 659, 10: 10813}
layer  1
{15: 1289}

layer  0
{1: 195, 2: 356, 3: 454, 4: 544, 5: 576, 6: 610, 7: 579, 8: 589, 9: 572, 10: 10217}
layer  1
{16: 1111}

layer  0
{1: 205, 2: 377, 3: 470, 4: 546, 5: 572, 6: 590, 7: 564, 8: 547, 9: 612, 10: 10194}
layer  1
{17: 1030}

layer  0
{1: 204, 2: 315, 3: 373, 4: 487, 5: 485, 6: 570, 7: 536, 8: 542, 9: 542, 10: 9940}
layer  1
{18: 948}

layer  0
{1: 199, 2: 299, 3: 387, 4: 450, 5: 489, 6: 514, 7: 507, 8: 514, 9: 532, 10: 9413}
layer  1
{19: 836}

layer  0
{1: 143, 2: 272, 3: 351, 4: 424, 5: 444, 6: 496, 7: 474, 8: 532, 9: 494, 10: 9707}
layer  1
{20: 807}

layer  0
{1: 203, 2: 288, 3: 371, 4: 397, 5: 448, 6: 453, 7: 433, 8: 441, 9: 491, 10: 9029}
layer  1
{21: 717}

layer  0
{1: 105, 2: 206, 3: 255, 4: 308, 5: 307, 6: 349, 7: 377, 8: 386, 9: 342, 10: 7803}
layer  1
{22: 556}

layer  0
{1: 125, 2: 220, 3: 284, 4: 287, 5: 318, 6: 324, 7: 350, 8: 357, 9: 353, 10: 7787}
layer  1
{23: 519}

layer  0
{1: 115, 2: 197, 3: 259, 4: 313, 5: 337, 6: 338, 7: 332, 8: 333, 9: 373, 10: 7982}
layer  1
{24: 525}

layer  0
{1: 1567, 2: 2514, 3: 3143, 4: 3505, 5: 3653, 6: 3787, 7: 3660, 8: 3569, 9: 3467, 10: 51941}
layer  1
{25: 9460}

data_dict
[[{1: 13428, 2: 1514, 3: 1424, 4: 1036, 5: 890, 6: 712, 7: 552, 8: 442, 9: 392, 10: 3685}, {1: 13428}], [{1: 1525, 2: 12162, 3: 2064, 4: 1606, 5: 1420, 6: 1110, 7: 954, 8: 766, 9: 639, 10: 5875}, {2: 11706}], [{1: 1582, 2: 2280, 3: 9755, 4: 1987, 5: 1726, 6: 1356, 7: 1163, 8: 966, 9: 828, 10: 7423}, {3: 9277}], [{1: 1251, 2: 1864, 3: 2112, 4: 7759, 5: 1867, 6: 1529, 7: 1277, 8: 1115, 9: 912, 10: 8511}, {4: 7320}], [{1: 1076, 2: 1735, 3: 2034, 4: 2003, 5: 6670, 6: 1576, 7: 1397, 8: 1196, 9: 1033, 10: 9513}, {5: 6222}], [{1: 904, 2: 1401, 3: 1546, 4: 1745, 5: 1668, 6: 5231, 7: 1341, 8: 1178, 9: 993, 10: 9999}, {6: 4868}], [{1: 724, 2: 1210, 3: 1421, 4: 1525, 5: 1541, 6: 1424, 7: 4368, 8: 1150, 9: 1022, 10: 10305}, {7: 4045}], [{1: 615, 2: 990, 3: 1214, 4: 1372, 5: 1431, 6: 1273, 7: 1220, 8: 3789, 9: 1041, 10: 10789}, {8: 3472}], [{1: 519, 2: 890, 3: 1092, 4: 1243, 5: 1253, 6: 1154, 7: 1128, 8: 1065, 9: 3251, 10: 10836}, {9: 2976}], [{1: 457, 2: 779, 3: 940, 4: 1085, 5: 1115, 6: 1112, 7: 1051, 8: 1002, 9: 910, 10: 13099}, {10: 2599}], [{1: 373, 2: 610, 3: 837, 4: 910, 5: 994, 6: 944, 7: 952, 8: 949, 9: 857, 10: 12460}, {11: 2203}], [{1: 345, 2: 621, 3: 789, 4: 892, 5: 968, 6: 980, 7: 898, 8: 920, 9: 813, 10: 12180}, {12: 1937}], [{1: 357, 2: 566, 3: 685, 4: 775, 5: 803, 6: 793, 7: 797, 8: 819, 9: 733, 10: 11507}, {13: 1656}], [{1: 279, 2: 460, 3: 602, 4: 672, 5: 713, 6: 780, 7: 730, 8: 740, 9: 657, 10: 11030}, {14: 1434}], [{1: 280, 2: 457, 3: 563, 4: 621, 5: 651, 6: 667, 7: 663, 8: 707, 9: 659, 10: 10813}, {15: 1289}], [{1: 195, 2: 356, 3: 454, 4: 544, 5: 576, 6: 610, 7: 579, 8: 589, 9: 572, 10: 10217}, {16: 1111}], [{1: 205, 2: 377, 3: 470, 4: 546, 5: 572, 6: 590, 7: 564, 8: 547, 9: 612, 10: 10194}, {17: 1030}], [{1: 204, 2: 315, 3: 373, 4: 487, 5: 485, 6: 570, 7: 536, 8: 542, 9: 542, 10: 9940}, {18: 948}], [{1: 199, 2: 299, 3: 387, 4: 450, 5: 489, 6: 514, 7: 507, 8: 514, 9: 532, 10: 9413}, {19: 836}], [{1: 143, 2: 272, 3: 351, 4: 424, 5: 444, 6: 496, 7: 474, 8: 532, 9: 494, 10: 9707}, {20: 807}], [{1: 203, 2: 288, 3: 371, 4: 397, 5: 448, 6: 453, 7: 433, 8: 441, 9: 491, 10: 9029}, {21: 717}], [{1: 105, 2: 206, 3: 255, 4: 308, 5: 307, 6: 349, 7: 377, 8: 386, 9: 342, 10: 7803}, {22: 556}], [{1: 125, 2: 220, 3: 284, 4: 287, 5: 318, 6: 324, 7: 350, 8: 357, 9: 353, 10: 7787}, {23: 519}], [{1: 115, 2: 197, 3: 259, 4: 313, 5: 337, 6: 338, 7: 332, 8: 333, 9: 373, 10: 7982}, {24: 525}], [{1: 1567, 2: 2514, 3: 3143, 4: 3505, 5: 3653, 6: 3787, 7: 3660, 8: 3569, 9: 3467, 10: 51941}, {25: 9460}]]
estimated_mem_dict
{0: 0.9289283752441406, 1: 1.5136756896972656, 2: 1.8310604095458984, 3: 1.9792299270629883, 4: 2.1239662170410156, 5: 2.070270538330078, 6: 2.0462894439697266, 7: 2.0443239212036133, 8: 1.9855985641479492, 9: 1.9565534591674805, 10: 1.8317384719848633, 11: 1.7809267044067383, 12: 1.6502752304077148, 13: 1.5563936233520508, 14: 1.5076332092285156, 15: 1.3957786560058594, 16: 1.3882684707641602, 17: 1.3410186767578125, 18: 1.2671527862548828, 19: 1.2874774932861328, 20: 1.2000846862792969, 21: 1.0080127716064453, 22: 0.9984340667724609, 23: 1.02667236328125, 24: 9.860366821289062}
[0.9289283752441406, 1.5136756896972656, 1.8310604095458984, 1.9792299270629883, 2.1239662170410156, 2.070270538330078, 2.0462894439697266, 2.0443239212036133, 1.9855985641479492, 1.9565534591674805, 1.8317384719848633, 1.7809267044067383, 1.6502752304077148, 1.5563936233520508, 1.5076332092285156, 1.3957786560058594, 1.3882684707641602, 1.3410186767578125, 1.2671527862548828, 1.2874774932861328, 1.2000846862792969, 1.0080127716064453, 0.9984340667724609, 1.02667236328125]

 MM estimated memory/GB degree 0: 0.9289283752441406 * min( 4.5709711051534105*0.226,1
 MM estimated memory/GB degree 1: 1.5136756896972656 * min( 3.1962668716897316*0.226,1
 MM estimated memory/GB degree 2: 1.8310604095458984 * min( 2.836585102942762*0.226,1
 MM estimated memory/GB degree 3: 1.9792299270629883 * min( 2.6987704918032787*0.226,1
 MM estimated memory/GB degree 4: 2.1239662170410156 * min( 2.577917068466731*0.226,1
 MM estimated memory/GB degree 5: 2.070270538330078 * min( 2.6378731854286497*0.226,1
 MM estimated memory/GB degree 6: 2.0462894439697266 * min( 2.6331626346459474*0.226,1
 MM estimated memory/GB degree 7: 2.0443239212036133 * min( 2.620751728110599*0.226,1
 MM estimated memory/GB degree 8: 1.9855985641479492 * min( 2.6412037037037037*0.226,1
 MM estimated memory/GB degree 9: 1.9565534591674805 * min( 2.6608695652173915*0.226,1
 MM estimated memory/GB degree 10: 1.8317384719848633 * min( 2.697478644823175*0.226,1
 MM estimated memory/GB degree 11: 1.7809267044067383 * min( 2.78489072448804*0.226,1
 MM estimated memory/GB degree 12: 1.6502752304077148 * min( 2.843738387216648*0.226,1
 MM estimated memory/GB degree 13: 1.5563936233520508 * min( 2.9392309224945206*0.226,1
 MM estimated memory/GB degree 14: 1.5076332092285156 * min( 2.971088699250065*0.226,1
 MM estimated memory/GB degree 15: 1.3957786560058594 * min( 3.025146264626463*0.226,1
 MM estimated memory/GB degree 16: 1.3882684707641602 * min( 3.0591090805254137*0.226,1
 MM estimated memory/GB degree 17: 1.3410186767578125 * min( 3.063525550867323*0.226,1
 MM estimated memory/GB degree 18: 1.2671527862548828 * min( 3.203160412994208*0.226,1
 MM estimated memory/GB degree 19: 1.2874774932861328 * min( 3.088909541511772*0.226,1
 MM estimated memory/GB degree 20: 1.2000846862792969 * min( 3.2097363352593478*0.226,1
 MM estimated memory/GB degree 21: 1.0080127716064453 * min( 3.4603499018966644*0.226,1
 MM estimated memory/GB degree 22: 0.9984340667724609 * min( 3.534891513780682*0.226,1
 MM estimated memory/GB degree 23: 1.02667236328125 * min( 3.4212698412698415*0.226,1
 MM estimated memory/GB degree 24: 9.860366821289062 * min( 0.5195560253699789*0.226,1

modified_estimated_mem_list 
[0.9289283752441406, 1.0934131902902935, 1.1738346617491942, 1.20717613514525, 1.2374423806090251, 1.2342111175595099, 1.2177361161981226, 1.2108323915445585, 1.1852276836633684, 1.1765861828016198, 1.1166830429041257, 1.1208890947815557, 1.0606069310134072, 1.033859659964498, 1.0123245098649671, 0.9542702167662923, 0.9597914188375205, 0.9284633655789534, 0.9173099631252111, 0.8987797420494619, 0.8705419255842082, 0.7883053783466022, 0.7976344807929926, 0.7938302416992188, 1.1578009367251245]

modified_mem [1, fanout-1]: 
[0.9289283752441406, 1.0934131902902935, 1.1738346617491942, 1.20717613514525, 1.2374423806090251, 1.2342111175595099, 1.2177361161981226, 1.2108323915445585, 1.1852276836633684, 1.1765861828016198, 1.1166830429041257, 1.1208890947815557, 1.0606069310134072, 1.033859659964498, 1.0123245098649671, 0.9542702167662923, 0.9597914188375205, 0.9284633655789534, 0.9173099631252111, 0.8987797420494619, 0.8705419255842082, 0.7883053783466022, 0.7976344807929926, 0.7938302416992188]
24.9186782061141
mem size of fanout degree bucket by formula (GB):  9.860366821289062

the modified memory estimation spend (sec) 0.13243365287780762
the time of number of fanout blocks generation (sec) 7.155907392501831
the time dict collection (sec) 0.13128304481506348
the time estimate mem (sec) 0.0005300045013427734
