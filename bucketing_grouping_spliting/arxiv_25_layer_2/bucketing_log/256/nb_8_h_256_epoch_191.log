main start at this time 1691120198.4894946
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0009191036224365234
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014966726303100586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5070583820343018
len local_batched_seeds_list  8
partition total batch output list spend :  0.7979104518890381
self.buckets_partition() spend  sec:  0.5220539569854736
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04287242889404297

in edges time spent  0.1516115665435791
local to global src and eids time spent  0.31510066986083984
time gen tails  0.07716703414916992
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1519179344177246

in edges time spent  0.8020696640014648
local to global src and eids time spent  1.307671308517456
time gen tails  0.22576642036437988
res  length 8
block collection to dataloader spend  2.0503997802734375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.513671875 GB
    Memory Allocated: 0.06765556335449219  GigaBytes
Max Memory Allocated: 0.06765556335449219  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.84765625 GB
    Memory Allocated: 5.197896957397461  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.84765625 GB
    Memory Allocated: 5.20051383972168  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.04296875 GB
    Memory Allocated: 0.07041120529174805  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.884765625 GB
    Memory Allocated: 5.064934730529785  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.884765625 GB
    Memory Allocated: 5.066061019897461  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.88671875 GB
    Memory Allocated: 0.0784139633178711  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.88671875 GB
    Memory Allocated: 5.086881637573242  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.88671875 GB
    Memory Allocated: 5.089938640594482  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.88671875 GB
    Memory Allocated: 0.07461977005004883  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.892578125 GB
    Memory Allocated: 4.996334075927734  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.892578125 GB
    Memory Allocated: 4.997341632843018  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.89453125 GB
    Memory Allocated: 0.07422018051147461  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.498046875 GB
    Memory Allocated: 5.0425190925598145  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.498046875 GB
    Memory Allocated: 5.043522834777832  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.5 GB
    Memory Allocated: 0.08148813247680664  GigaBytes
Max Memory Allocated: 5.311089038848877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.73046875 GB
    Memory Allocated: 5.241695880889893  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.73046875 GB
    Memory Allocated: 5.243359565734863  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.73046875 GB
    Memory Allocated: 0.0882730484008789  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.73046875 GB
    Memory Allocated: 5.228075981140137  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.73046875 GB
    Memory Allocated: 5.231070041656494  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.73046875 GB
    Memory Allocated: 0.08632040023803711  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.76171875 GB
    Memory Allocated: 4.871308326721191  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.76171875 GB
    Memory Allocated: 4.872778415679932  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.09588098526000977  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.8321094512939453
pure train time :  1.216118574142456
train time :  2.0698959827423096
end to end time :  8.321600914001465
connection check time:  3.6442959308624268
block generation time  1.7864744663238525
Run 00 | Epoch 00000 | Loss 3.8321 | Test 0.0428
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004379749298095703
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015212059020996094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47132205963134766
len local_batched_seeds_list  8
partition total batch output list spend :  0.6182045936584473
self.buckets_partition() spend  sec:  0.4865686893463135
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04474329948425293

in edges time spent  0.15393471717834473
local to global src and eids time spent  0.3167290687561035
time gen tails  0.07843756675720215
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15205693244934082

in edges time spent  0.8135004043579102
local to global src and eids time spent  1.118945837020874
time gen tails  0.17459917068481445
res  length 8
block collection to dataloader spend  2.3603439331054688e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.07983160018920898  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.214242458343506  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.213973522186279  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.07551908493041992  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.078714370727539  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.079944133758545  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.08401346206665039  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.097923278808594  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.100980281829834  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.07950782775878906  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.033303737640381  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.034311294555664  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.07958698272705078  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.047408580780029  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.0484161376953125  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.08702421188354492  GigaBytes
Max Memory Allocated: 5.352570056915283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.247800827026367  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.249724864959717  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.09406661987304688  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.2279863357543945  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 5.231414318084717  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.763671875 GB
    Memory Allocated: 0.09269046783447266  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.765625 GB
    Memory Allocated: 4.873961925506592  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.765625 GB
    Memory Allocated: 4.875781536102295  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09643936157226562  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.578460454940796
pure train time :  0.7361698150634766
train time :  1.084956169128418
end to end time :  6.883876800537109
connection check time:  3.3065361976623535
block generation time  1.8516826629638672
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004825592041015625
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016033172607421875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46081113815307617
len local_batched_seeds_list  8
partition total batch output list spend :  0.6015748977661133
self.buckets_partition() spend  sec:  0.47687840461730957
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04299211502075195

in edges time spent  0.15745186805725098
local to global src and eids time spent  0.3153841495513916
time gen tails  0.0776057243347168
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15641379356384277

in edges time spent  0.7830455303192139
local to global src and eids time spent  1.0551507472991943
time gen tails  0.17882394790649414
res  length 8
block collection to dataloader spend  1.9311904907226562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07983779907226562  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.225356578826904  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.225088596343994  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07563352584838867  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.079174995422363  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.080404758453369  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08416271209716797  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.098878860473633  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.101935863494873  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07948541641235352  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.008368492126465  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.009361743927002  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07963848114013672  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.050670146942139  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.051669597625732  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08702611923217773  GigaBytes
Max Memory Allocated: 5.359405994415283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.252413749694824  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.254328727722168  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09398937225341797  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.233575820922852  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.237003803253174  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0920400619506836  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.8757452964782715  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.877215385437012  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09595680236816406  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3659207820892334
pure train time :  0.7572329044342041
train time :  1.0759539604187012
end to end time :  6.707179069519043
connection check time:  3.212681770324707
block generation time  1.8008348941802979
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048351287841796875
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015584230422973633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.45290637016296387
len local_batched_seeds_list  8
partition total batch output list spend :  0.5909953117370605
self.buckets_partition() spend  sec:  0.468519926071167
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.026800155639648438

in edges time spent  0.08487987518310547
local to global src and eids time spent  0.11680936813354492
time gen tails  0.04323935508728027
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10804128646850586

in edges time spent  0.44176650047302246
local to global src and eids time spent  0.5202572345733643
time gen tails  0.12252140045166016
res  length 8
block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07983875274658203  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.222506046295166  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.222237586975098  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07539939880371094  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.073812961578369  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.074925899505615  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08484792709350586  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.128912448883057  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.131969451904297  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07951116561889648  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.033218860626221  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.034226417541504  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07959794998168945  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.040321350097656  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.041323661804199  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08711814880371094  GigaBytes
Max Memory Allocated: 5.362488746643066  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.254408359527588  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.25624942779541  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09398937225341797  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.236572742462158  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2400007247924805  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09263277053833008  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.89801549911499  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.899935245513916  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09579229354858398  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2188568115234375
pure train time :  0.729905366897583
train time :  1.0580344200134277
end to end time :  4.614526987075806
connection check time:  1.6643040180206299
block generation time  1.2876646518707275
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005507469177246094
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014250993728637695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4842808246612549
len local_batched_seeds_list  8
partition total batch output list spend :  0.7748572826385498
self.buckets_partition() spend  sec:  0.4985630512237549
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.048148155212402344

in edges time spent  0.15720510482788086
local to global src and eids time spent  0.31867170333862305
time gen tails  0.07666778564453125
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15661382675170898

in edges time spent  0.7485730648040771
local to global src and eids time spent  1.240180492401123
time gen tails  0.21300768852233887
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08052635192871094  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.208064079284668  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.208436012268066  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07561492919921875  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.077228546142578  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.078542232513428  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08481454849243164  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.125596523284912  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.128653526306152  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07955026626586914  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.0361328125  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.037140369415283  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07977676391601562  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.058477401733398  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.059484958648682  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08704710006713867  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2403435707092285  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.242191314697266  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0936131477355957  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.237163543701172  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.240591526031494  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09273719787597656  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.903220176696777  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.905032634735107  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0961771011352539  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1723289489746094
pure train time :  0.7381777763366699
train time :  1.078526258468628
end to end time :  7.094079256057739
connection check time:  3.428354263305664
block generation time  1.7990162372589111
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005712509155273438
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015051126480102539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41671133041381836
len local_batched_seeds_list  8
partition total batch output list spend :  0.7116751670837402
self.buckets_partition() spend  sec:  0.43179750442504883
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.050257205963134766

in edges time spent  0.1580510139465332
local to global src and eids time spent  0.3382117748260498
time gen tails  0.07858586311340332
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15790081024169922

in edges time spent  0.7556912899017334
local to global src and eids time spent  1.076742172241211
time gen tails  0.17573142051696777
res  length 8
block collection to dataloader spend  1.9788742065429688e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08011484146118164  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.220248222351074  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2206573486328125  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07548236846923828  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.069051742553711  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.070281505584717  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0841069221496582  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.1287360191345215  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.131793022155762  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07951593399047852  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.018335819244385  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.019343376159668  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07968378067016602  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.048592567443848  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.049600124359131  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0871129035949707  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.236420154571533  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.23826789855957  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0936117172241211  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.236888408660889  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.240316390991211  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09205436706542969  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.872395992279053  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.8743367195129395  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09632587432861328  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.120285987854004
pure train time :  0.7461512088775635
train time :  1.0793113708496094
end to end time :  6.886354923248291
connection check time:  3.2747857570648193
block generation time  1.8048577308654785
Run 00 | Epoch 00005 | Loss 3.1203 | Test 0.2350
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005481243133544922
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01732039451599121
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4983797073364258
len local_batched_seeds_list  8
partition total batch output list spend :  0.6365578174591064
self.buckets_partition() spend  sec:  0.5157370567321777
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.03232097625732422

in edges time spent  0.08852624893188477
local to global src and eids time spent  0.21901631355285645
time gen tails  0.0581355094909668
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1558535099029541

in edges time spent  0.8551039695739746
local to global src and eids time spent  1.262061357498169
time gen tails  0.2091054916381836
res  length 8
block collection to dataloader spend  2.2649765014648438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08024740219116211  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.1902337074279785  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.190642833709717  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07555532455444336  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.07466983795166  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.075782775878906  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08416557312011719  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.109645366668701  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.112702369689941  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07938909530639648  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.013438701629639  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.014443397521973  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07970142364501953  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.041602611541748  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.042613983154297  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08703088760375977  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.240053176879883  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.242147445678711  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09363794326782227  GigaBytes
Max Memory Allocated: 5.364689826965332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.248601913452148  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.252029895782471  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09272050857543945  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.869803428649902  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.871383190155029  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09590911865234375  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0595507621765137
pure train time :  0.8187470436096191
train time :  1.1257390975952148
end to end time :  6.917579889297485
connection check time:  3.3245043754577637
block generation time  1.8068106174468994
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005381107330322266
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016505718231201172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13756799697875977
len local_batched_seeds_list  8
partition total batch output list spend :  0.23416996002197266
self.buckets_partition() spend  sec:  0.15410518646240234
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.03363513946533203

in edges time spent  0.09116435050964355
local to global src and eids time spent  0.12093305587768555
time gen tails  0.05849432945251465
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1600959300994873

in edges time spent  0.7632458209991455
local to global src and eids time spent  1.3556067943572998
time gen tails  0.2260115146636963
res  length 8
block collection to dataloader spend  1.7642974853515625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07982587814331055  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.178791522979736  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.179033279418945  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07578325271606445  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.090785026550293  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.09226655960083  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08400678634643555  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.117598056793213  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.120655059814453  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0793294906616211  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.012689590454102  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.013697147369385  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07956361770629883  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.041659832000732  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.042662620544434  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08704090118408203  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.253350257873535  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.254970073699951  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09377336502075195  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2418718338012695  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.245299816131592  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09276533126831055  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.904044151306152  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.906062602996826  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0963740348815918  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.00361704826355
pure train time :  0.7587013244628906
train time :  1.132537603378296
end to end time :  6.593973875045776
connection check time:  3.3519949913024902
block generation time  1.8615949153900146
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00049591064453125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015329122543334961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5424156188964844
len local_batched_seeds_list  8
partition total batch output list spend :  0.8264095783233643
self.buckets_partition() spend  sec:  0.5577788352966309
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04581880569458008

in edges time spent  0.15878844261169434
local to global src and eids time spent  0.3192250728607178
time gen tails  0.07833528518676758
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15696001052856445

in edges time spent  0.802776575088501
local to global src and eids time spent  1.2875926494598389
time gen tails  0.2240910530090332
res  length 8
block collection to dataloader spend  2.2411346435546875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08028173446655273  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.217888832092285  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2176194190979  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07536840438842773  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.079078674316406  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.081117153167725  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08412694931030273  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.104365348815918  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.107422351837158  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07945442199707031  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.984158515930176  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.98515510559082  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07960224151611328  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.041323661804199  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.04236364364624  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08706331253051758  GigaBytes
Max Memory Allocated: 5.366444110870361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.260183811187744  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2619524002075195  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09391927719116211  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.235720157623291  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.239148139953613  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09211540222167969  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.886044979095459  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.888097763061523  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09610223770141602  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9598076343536377
pure train time :  0.7542109489440918
train time :  1.1037318706512451
end to end time :  7.394991397857666
connection check time:  3.603689432144165
block generation time  1.8372318744659424
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004684925079345703
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016277790069580078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5284867286682129
len local_batched_seeds_list  8
partition total batch output list spend :  0.8118622303009033
self.buckets_partition() spend  sec:  0.5447986125946045
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04691290855407715

in edges time spent  0.16002368927001953
local to global src and eids time spent  0.32097339630126953
time gen tails  0.07903718948364258
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15569376945495605

in edges time spent  0.76920485496521
local to global src and eids time spent  1.2540562152862549
time gen tails  0.20769810676574707
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0802454948425293  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2232561111450195  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.223665237426758  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07568836212158203  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.078699588775635  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.079843997955322  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08397388458251953  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.08359432220459  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.086771488189697  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07956695556640625  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.016306400299072  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.017308235168457  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0797886848449707  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.043942928314209  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.044944763183594  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08702611923217773  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.234320640563965  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.236168384552002  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09363126754760742  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.244479179382324  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2479071617126465  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09267282485961914  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.873641490936279  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 4.875131607055664  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.09582853317260742  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9132566452026367
pure train time :  0.7617897987365723
train time :  1.1516549587249756
end to end time :  7.236962795257568
connection check time:  3.4412379264831543
block generation time  1.809786319732666
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005724430084228516
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01616215705871582
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5599586963653564
len local_batched_seeds_list  8
partition total batch output list spend :  0.6958675384521484
self.buckets_partition() spend  sec:  0.5761523246765137
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.028584957122802734

in edges time spent  0.08671689033508301
local to global src and eids time spent  0.2734541893005371
time gen tails  0.07848095893859863
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15615272521972656

in edges time spent  0.7748017311096191
local to global src and eids time spent  1.2975683212280273
time gen tails  0.22401762008666992
res  length 8
block collection to dataloader spend  1.9073486328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.0798349380493164  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.217511177062988  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.2178239822387695  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07563495635986328  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.065797805786133  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.067152500152588  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.08432722091674805  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.1224236488342285  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.125480651855469  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07937812805175781  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.009702682495117  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 5.0107102394104  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.767578125 GB
    Memory Allocated: 0.07990121841430664  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.058873176574707  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.060353755950928  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08711957931518555  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.242985725402832  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.24483060836792  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09399223327636719  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.237333297729492  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2407612800598145  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09195280075073242  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.891880989074707  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.893986225128174  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0958094596862793  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8657913208007812
pure train time :  0.782778263092041
train time :  1.0991697311401367
end to end time :  7.080113172531128
connection check time:  3.3820960521698
block generation time  1.8811564445495605
Run 00 | Epoch 00010 | Loss 2.8658 | Test 0.2723
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048422813415527344
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015848398208618164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5447769165039062
len local_batched_seeds_list  8
partition total batch output list spend :  0.8461606502532959
self.buckets_partition() spend  sec:  0.5606615543365479
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.050760507583618164

in edges time spent  0.17572784423828125
local to global src and eids time spent  0.31859922409057617
time gen tails  0.07990097999572754
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15479350090026855

in edges time spent  0.8076169490814209
local to global src and eids time spent  1.2801809310913086
time gen tails  0.21299529075622559
res  length 8
block collection to dataloader spend  2.1457672119140625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07984304428100586  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.218194484710693  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217926502227783  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07540750503540039  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.082515716552734  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.083775043487549  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08408641815185547  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.107826232910156  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.1108832359313965  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08051538467407227  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.042191028594971  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.043198585510254  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0795583724975586  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0462164878845215  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.047224044799805  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0870356559753418  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.242291450500488  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.244377613067627  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09414291381835938  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.248588562011719  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.252016544342041  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09261941909790039  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.875401020050049  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.87770938873291  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09645414352416992  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8159914016723633
pure train time :  0.7528619766235352
train time :  1.0845894813537598
end to end time :  7.329620122909546
connection check time:  3.563448429107666
block generation time  1.818556308746338
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005254745483398438
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01606583595275879
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5257513523101807
len local_batched_seeds_list  8
partition total batch output list spend :  0.6630456447601318
self.buckets_partition() spend  sec:  0.5418519973754883
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04728221893310547

in edges time spent  0.16252923011779785
local to global src and eids time spent  0.3377814292907715
time gen tails  0.08610796928405762
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16151976585388184

in edges time spent  0.831779956817627
local to global src and eids time spent  1.2714509963989258
time gen tails  0.22672748565673828
res  length 8
block collection to dataloader spend  2.4080276489257812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08033514022827148  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.223806858062744  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.223565578460693  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07536792755126953  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.071216583251953  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.072332859039307  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08397912979125977  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0844645500183105  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0876145362854  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07961845397949219  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.029994487762451  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.031002044677734  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07958650588989258  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.035508155822754  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.036515712738037  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08708047866821289  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.250413417816162  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2525954246521  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0942535400390625  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.230793476104736  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.234221458435059  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09236574172973633  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.9015913009643555  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.903388500213623  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09621667861938477  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7601468563079834
pure train time :  0.729363203048706
train time :  1.0846407413482666
end to end time :  7.262482643127441
connection check time:  3.6343517303466797
block generation time  1.8582711219787598
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005006790161132812
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014185190200805664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5422523021697998
len local_batched_seeds_list  8
partition total batch output list spend :  0.8298935890197754
self.buckets_partition() spend  sec:  0.5564732551574707
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04494357109069824

in edges time spent  0.16756296157836914
local to global src and eids time spent  0.31952834129333496
time gen tails  0.0777592658996582
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1683053970336914

in edges time spent  0.8339371681213379
local to global src and eids time spent  1.290625810623169
time gen tails  0.2161846160888672
res  length 8
block collection to dataloader spend  2.09808349609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0800924301147461  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217589378356934  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2179975509643555  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07558488845825195  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0797343254089355  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.080964088439941  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08420944213867188  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.121323108673096  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.124380111694336  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07958126068115234  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.028733730316162  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.029741287231445  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07967948913574219  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.055570125579834  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.056577682495117  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0870823860168457  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.235485553741455  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.237604141235352  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09412527084350586  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.222147464752197  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2255754470825195  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09260940551757812  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.876607894897461  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.878568172454834  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0962514877319336  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.701293706893921
pure train time :  0.741863489151001
train time :  1.090606451034546
end to end time :  7.35465931892395
connection check time:  3.5845437049865723
block generation time  1.8285841941833496
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005202293395996094
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015392065048217773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5386271476745605
len local_batched_seeds_list  8
partition total batch output list spend :  0.8220946788787842
self.buckets_partition() spend  sec:  0.5540547370910645
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04755997657775879

in edges time spent  0.13885712623596191
local to global src and eids time spent  0.31943440437316895
time gen tails  0.07825827598571777
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15674829483032227

in edges time spent  0.7647819519042969
local to global src and eids time spent  1.249074935913086
time gen tails  0.20935797691345215
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.080322265625  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.224328517913818  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2240777015686035  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07567358016967773  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.073332786560059  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.074631214141846  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08413362503051758  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.117144584655762  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.120201587677002  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07938098907470703  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.007789134979248  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.008796691894531  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07964515686035156  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.045158863067627  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.04616641998291  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08704900741577148  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.249600410461426  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.251510143280029  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09435176849365234  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.247853755950928  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.25128173828125  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09203529357910156  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.872805118560791  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.8748979568481445  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09619522094726562  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6541872024536133
pure train time :  0.7504348754882812
train time :  1.0940499305725098
end to end time :  7.165390253067017
connection check time:  3.417243003845215
block generation time  1.8167650699615479
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005865097045898438
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015341758728027344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4937915802001953
len local_batched_seeds_list  8
partition total batch output list spend :  0.79718017578125
self.buckets_partition() spend  sec:  0.5091695785522461
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04678916931152344

in edges time spent  0.16537189483642578
local to global src and eids time spent  0.20335006713867188
time gen tails  0.057175397872924805
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15659356117248535

in edges time spent  0.7984225749969482
local to global src and eids time spent  1.2587623596191406
time gen tails  0.20824623107910156
res  length 8
block collection to dataloader spend  2.288818359375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08013916015625  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2032341957092285  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.20296573638916  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07541179656982422  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.07972526550293  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.080838203430176  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08413553237915039  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.115533828735352  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.118590831756592  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07950544357299805  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.024902820587158  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.025895118713379  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07956790924072266  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.041402339935303  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.042840480804443  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08708763122558594  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.23814582824707  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.240212917327881  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09362983703613281  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2392168045043945  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.242644786834717  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09195280075073242  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.878944396972656  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.880810260772705  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0962224006652832  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6079185009002686
pure train time :  0.7522592544555664
train time :  1.0873491764068604
end to end time :  7.0717997550964355
connection check time:  3.352264881134033
block generation time  1.8137731552124023
Run 00 | Epoch 00015 | Loss 2.6079 | Test 0.2985
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048804283142089844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01692056655883789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.499570369720459
len local_batched_seeds_list  8
partition total batch output list spend :  0.6377005577087402
self.buckets_partition() spend  sec:  0.5165245532989502
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04776263236999512

in edges time spent  0.15873122215270996
local to global src and eids time spent  0.3336813449859619
time gen tails  0.07850885391235352
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15755605697631836

in edges time spent  0.8105993270874023
local to global src and eids time spent  1.255565881729126
time gen tails  0.2104947566986084
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0801081657409668  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.215330123901367  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.215061187744141  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07528829574584961  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.072775840759277  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.073888778686523  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08416748046875  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.12730073928833  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.13035774230957  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07942485809326172  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.021896839141846  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.022904396057129  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07955265045166016  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.042598247528076  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.043598651885986  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08701848983764648  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.232860088348389  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.23503303527832  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09412908554077148  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.235742568969727  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.239170551300049  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09275627136230469  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.907567501068115  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.90962028503418  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09592533111572266  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5467419624328613
pure train time :  0.7203876972198486
train time :  1.0668549537658691
end to end time :  7.05482292175293
connection check time:  3.5002124309539795
block generation time  1.830977201461792
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005526542663574219
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0162353515625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4660630226135254
len local_batched_seeds_list  8
partition total batch output list spend :  0.6038849353790283
self.buckets_partition() spend  sec:  0.4823324680328369
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04586529731750488

in edges time spent  0.10652542114257812
local to global src and eids time spent  0.1565556526184082
time gen tails  0.05641031265258789
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16010427474975586

in edges time spent  0.7233762741088867
local to global src and eids time spent  0.675790548324585
time gen tails  0.12334823608398438
res  length 8
block collection to dataloader spend  9.5367431640625e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07983875274658203  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.222478866577148  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.22288703918457  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07547855377197266  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.051673412322998  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.052903175354004  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0840158462524414  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.103555679321289  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.106612682342529  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07951879501342773  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.021840572357178  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.022848129272461  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07987117767333984  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.055341720581055  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.056434154510498  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08709907531738281  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.244851589202881  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.246515274047852  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09380960464477539  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.243337154388428  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.24676513671875  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09192132949829102  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.876312255859375  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.878375053405762  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09578084945678711  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4952731132507324
pure train time :  0.6860795021057129
train time :  1.031275987625122
end to end time :  5.353891849517822
connection check time:  2.3120837211608887
block generation time  1.393622875213623
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004119873046875
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01360630989074707
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.20845961570739746
len local_batched_seeds_list  8
partition total batch output list spend :  0.31075453758239746
self.buckets_partition() spend  sec:  0.2220907211303711
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.02707815170288086

in edges time spent  0.08482789993286133
local to global src and eids time spent  0.11936569213867188
time gen tails  0.04444408416748047
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.11206221580505371

in edges time spent  0.8031284809112549
local to global src and eids time spent  1.3167531490325928
time gen tails  0.21484041213989258
res  length 8
block collection to dataloader spend  2.0503997802734375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.079833984375  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.219264030456543  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.219672679901123  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07575225830078125  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.080450057983398  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.081564426422119  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08397054672241211  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.110861301422119  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.113918304443359  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07955265045166016  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0070481300354  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.008054256439209  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07968711853027344  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.044790267944336  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0457963943481445  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08703470230102539  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.249166965484619  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.251181602478027  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09421730041503906  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.246792793273926  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.250220775604248  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09231805801391602  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.900650978088379  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.902463436126709  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09619951248168945  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.448064088821411
pure train time :  0.7351682186126709
train time :  1.0705235004425049
end to end time :  6.317331552505493
connection check time:  3.1671407222747803
block generation time  1.756899356842041
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005247592926025391
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014404535293579102
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4132821559906006
len local_batched_seeds_list  8
partition total batch output list spend :  0.6674258708953857
self.buckets_partition() spend  sec:  0.4277207851409912
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04628777503967285

in edges time spent  0.15453672409057617
local to global src and eids time spent  0.3178529739379883
time gen tails  0.07857441902160645
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1560056209564209

in edges time spent  0.7671387195587158
local to global src and eids time spent  1.2845759391784668
time gen tails  0.218231201171875
res  length 8
block collection to dataloader spend  2.09808349609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08010673522949219  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.213692665100098  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.213423252105713  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07563352584838867  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0740203857421875  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.075918674468994  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08396100997924805  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0750346183776855  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.078273773193359  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07971906661987305  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.025385856628418  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.026393413543701  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0797872543334961  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.043700695037842  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.044775009155273  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08702850341796875  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.237194538116455  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.239042282104492  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09361457824707031  GigaBytes
Max Memory Allocated: 5.370389938354492  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.253012657165527  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.25644063949585  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09268474578857422  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.900723934173584  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.902521133422852  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09612846374511719  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4082303047180176
pure train time :  0.8597073554992676
train time :  1.1880526542663574
end to end time :  7.240034580230713
connection check time:  3.487975835800171
block generation time  1.8811702728271484
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005464553833007812
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014333963394165039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41436052322387695
len local_batched_seeds_list  8
partition total batch output list spend :  0.7034561634063721
self.buckets_partition() spend  sec:  0.42873430252075195
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04436159133911133

in edges time spent  0.1520085334777832
local to global src and eids time spent  0.3176131248474121
time gen tails  0.07693338394165039
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15827035903930664

in edges time spent  0.7405164241790771
local to global src and eids time spent  1.2387139797210693
time gen tails  0.20804643630981445
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08011531829833984  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.211289882659912  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.211021423339844  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07548952102661133  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.070821762084961  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.072854518890381  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0840902328491211  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.10797119140625  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.11102819442749  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07956409454345703  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0125298500061035  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.013526916503906  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07969903945922852  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.04844856262207  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.049543857574463  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08709716796875  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.230777263641357  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2326250076293945  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09360837936401367  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.235567569732666  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.238995552062988  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0920248031616211  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.901646137237549  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.903656005859375  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09622001647949219  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.363297462463379
pure train time :  0.7306132316589355
train time :  1.0589640140533447
end to end time :  7.209865093231201
connection check time:  3.632929563522339
block generation time  1.7969334125518799
Run 00 | Epoch 00020 | Loss 2.3633 | Test 0.4591
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005090236663818359
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015659332275390625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41184401512145996
len local_batched_seeds_list  8
partition total batch output list spend :  0.6941769123077393
self.buckets_partition() spend  sec:  0.4275352954864502
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04674482345581055

in edges time spent  0.1571056842803955
local to global src and eids time spent  0.31758737564086914
time gen tails  0.07947945594787598
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15993523597717285

in edges time spent  0.7727017402648926
local to global src and eids time spent  1.3044044971466064
time gen tails  0.22496986389160156
res  length 8
block collection to dataloader spend  1.8596649169921875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0801687240600586  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.209563732147217  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.210144996643066  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07550907135009766  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.078203201293945  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.079322338104248  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08412694931030273  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.104537010192871  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.107594013214111  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07965850830078125  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.023651123046875  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.024658679962158  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0795130729675293  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.044318199157715  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0457987785339355  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08750057220458984  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.230710506439209  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.23219108581543  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09425973892211914  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.250680446624756  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.254108428955078  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0928354263305664  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.9002909660339355  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.902088165283203  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09625530242919922  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3297524452209473
pure train time :  0.8574001789093018
train time :  1.1978223323822021
end to end time :  7.314254522323608
connection check time:  3.6004557609558105
block generation time  1.7974786758422852
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004892349243164062
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016215085983276367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38930368423461914
len local_batched_seeds_list  8
partition total batch output list spend :  0.52988600730896
self.buckets_partition() spend  sec:  0.4055473804473877
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04692721366882324

in edges time spent  0.15778446197509766
local to global src and eids time spent  0.3161470890045166
time gen tails  0.07709741592407227
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15811562538146973

in edges time spent  0.8221619129180908
local to global src and eids time spent  1.277353048324585
time gen tails  0.21671462059020996
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0800929069519043  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.213179588317871  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2129106521606445  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07558488845825195  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.076342582702637  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.077589988708496  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08396339416503906  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0823211669921875  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.085596084594727  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07976484298706055  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0326385498046875  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.033646106719971  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07968759536743164  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.054105758666992  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.055113315582275  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08706808090209961  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.245452880859375  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.247300624847412  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09361553192138672  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.24820613861084  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.251634120941162  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09261083602905273  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.872248649597168  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.873738765716553  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09646415710449219  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.291008710861206
pure train time :  0.7488400936126709
train time :  1.08461332321167
end to end time :  6.979010581970215
connection check time:  3.533656597137451
block generation time  1.808504343032837
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004792213439941406
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015988826751708984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5287938117980957
len local_batched_seeds_list  8
partition total batch output list spend :  0.8142490386962891
self.buckets_partition() spend  sec:  0.5448143482208252
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04680609703063965

in edges time spent  0.15647268295288086
local to global src and eids time spent  0.3225269317626953
time gen tails  0.07750511169433594
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15876317024230957

in edges time spent  0.860985279083252
local to global src and eids time spent  1.2420942783355713
time gen tails  0.2073376178741455
res  length 8
block collection to dataloader spend  1.7642974853515625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07983636856079102  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.21650505065918  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.216799736022949  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07574796676635742  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.085080146789551  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.086309909820557  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08442068099975586  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.119984149932861  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.123041152954102  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07956647872924805  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.027675628662109  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.028683185577393  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07969379425048828  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.042890548706055  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.043894290924072  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08702278137207031  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.22697114944458  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.228818893432617  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09361791610717773  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.244701385498047  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.248129367828369  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09209585189819336  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.8781843185424805  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.880492687225342  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09595823287963867  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2585840225219727
pure train time :  0.7415275573730469
train time :  1.0833263397216797
end to end time :  7.258312225341797
connection check time:  3.5265049934387207
block generation time  1.8111743927001953
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004982948303222656
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015733957290649414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5409722328186035
len local_batched_seeds_list  8
partition total batch output list spend :  0.8255009651184082
self.buckets_partition() spend  sec:  0.5567443370819092
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04728531837463379

in edges time spent  0.1575930118560791
local to global src and eids time spent  0.32465434074401855
time gen tails  0.08457040786743164
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16039395332336426

in edges time spent  0.8151421546936035
local to global src and eids time spent  1.1763439178466797
time gen tails  0.17695403099060059
res  length 8
block collection to dataloader spend  1.6689300537109375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07984018325805664  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217422962188721  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217154026031494  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07521390914916992  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.07367467880249  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.074787616729736  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08403825759887695  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.116708278656006  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.119765281677246  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07941532135009766  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.019105434417725  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.020183563232422  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07957983016967773  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.045629501342773  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.046637058258057  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08704280853271484  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.253915786743164  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.255940914154053  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09391927719116211  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.233102321624756  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.236104965209961  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09181356430053711  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.898785591125488  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.9002556800842285  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09598922729492188  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.211625337600708
pure train time :  0.7275857925415039
train time :  1.0624949932098389
end to end time :  7.110013484954834
connection check time:  3.401763439178467
block generation time  1.7976572513580322
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005366802215576172
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014988183975219727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5399250984191895
len local_batched_seeds_list  8
partition total batch output list spend :  0.8282530307769775
self.buckets_partition() spend  sec:  0.5549564361572266
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0458073616027832

in edges time spent  0.1620781421661377
local to global src and eids time spent  0.3198831081390381
time gen tails  0.07971024513244629
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15937423706054688

in edges time spent  0.8218860626220703
local to global src and eids time spent  1.2671239376068115
time gen tails  0.21376729011535645
res  length 8
block collection to dataloader spend  1.2874603271484375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0800013542175293  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217480659484863  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217212200164795  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0753011703491211  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.054237365722656  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.055880069732666  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0840916633605957  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.112153053283691  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.115210056304932  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07956600189208984  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0304436683654785  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.031451225280762  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07956361770629883  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.034073829650879  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.035113334655762  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08723306655883789  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.246150970458984  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2479987144470215  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09362411499023438  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.250869274139404  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.254297256469727  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09215450286865234  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.868107318878174  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.869577407836914  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09629440307617188  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1721417903900146
pure train time :  0.7342360019683838
train time :  1.0547845363616943
end to end time :  7.213249206542969
connection check time:  3.5255210399627686
block generation time  1.7885689735412598
Run 00 | Epoch 00025 | Loss 2.1721 | Test 0.4638
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004858970642089844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015659332275390625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5115716457366943
len local_batched_seeds_list  8
partition total batch output list spend :  0.6505396366119385
self.buckets_partition() spend  sec:  0.5272653102874756
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.047766923904418945

in edges time spent  0.16031837463378906
local to global src and eids time spent  0.3199284076690674
time gen tails  0.07888174057006836
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15719985961914062

in edges time spent  0.7781209945678711
local to global src and eids time spent  1.0897495746612549
time gen tails  0.18454194068908691
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08076667785644531  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2145795822143555  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.21498966217041  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0756235122680664  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.084349155426025  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.086287975311279  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08407974243164062  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0927205085754395  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.096636772155762  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08037137985229492  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.01786470413208  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.018866539001465  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07967472076416016  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.033653736114502  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.034655570983887  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08709049224853516  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.242438793182373  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.24420166015625  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09391117095947266  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.241002559661865  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2444305419921875  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09210824966430664  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.89657735824585  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.898673057556152  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09598302841186523  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.138057231903076
pure train time :  0.7212924957275391
train time :  1.0590901374816895
end to end time :  6.804872512817383
connection check time:  3.2622416019439697
block generation time  1.8181941509246826
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005650520324707031
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014727592468261719
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4994816780090332
len local_batched_seeds_list  8
partition total batch output list spend :  0.7851438522338867
self.buckets_partition() spend  sec:  0.514244556427002
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04783773422241211

in edges time spent  0.1582174301147461
local to global src and eids time spent  0.31673383712768555
time gen tails  0.07837176322937012
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15816903114318848

in edges time spent  0.7866299152374268
local to global src and eids time spent  1.235217571258545
time gen tails  0.21024227142333984
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07983970642089844  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.220865726470947  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.220596790313721  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07534265518188477  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.078207969665527  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.079369068145752  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08411693572998047  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.1225104331970215  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.125567436218262  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07933950424194336  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.014192581176758  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.015242099761963  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07959222793579102  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.03394889831543  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.034964084625244  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0870366096496582  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.234561443328857  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2364091873168945  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0936136245727539  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2313008308410645  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.234728813171387  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09264135360717773  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.899879455566406  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.901606559753418  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09606218338012695  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.095353603363037
pure train time :  0.742753267288208
train time :  1.0665912628173828
end to end time :  7.100867509841919
connection check time:  3.4386537075042725
block generation time  1.79720139503479
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004794597625732422
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013932943344116211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4916837215423584
len local_batched_seeds_list  8
partition total batch output list spend :  0.7714035511016846
self.buckets_partition() spend  sec:  0.5056462287902832
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.043790340423583984

in edges time spent  0.15202951431274414
local to global src and eids time spent  0.3159642219543457
time gen tails  0.07736039161682129
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16246628761291504

in edges time spent  0.7659375667572021
local to global src and eids time spent  1.0405030250549316
time gen tails  0.17486572265625
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0800943374633789  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.216250419616699  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.216659069061279  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07539653778076172  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.052138328552246  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.053368091583252  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08396291732788086  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.091230869293213  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.094287872314453  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0798344612121582  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0287675857543945  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.029775142669678  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07969522476196289  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.041849136352539  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.042856693267822  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0872030258178711  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.249888896942139  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.251452445983887  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0937042236328125  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.239473342895508  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.24290132522583  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09195613861083984  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.916187763214111  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.917657852172852  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09582328796386719  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0583324432373047
pure train time :  0.7221975326538086
train time :  1.0474638938903809
end to end time :  6.82567024230957
connection check time:  3.182451009750366
block generation time  1.810286521911621
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005168914794921875
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017054319381713867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4629030227661133
len local_batched_seeds_list  8
partition total batch output list spend :  0.600999116897583
self.buckets_partition() spend  sec:  0.4799933433532715
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045469045639038086

in edges time spent  0.1322488784790039
local to global src and eids time spent  0.12055039405822754
time gen tails  0.046306610107421875
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10684466361999512

in edges time spent  0.8279099464416504
local to global src and eids time spent  1.2709972858428955
time gen tails  0.21281886100769043
res  length 8
block collection to dataloader spend  2.5510787963867188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07984066009521484  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217278003692627  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.217008590698242  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0752725601196289  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.064723968505859  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0658369064331055  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0840754508972168  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.08613920211792  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.089506149291992  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0795292854309082  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.021154880523682  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.022162437438965  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07953786849975586  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.041031837463379  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.042154312133789  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08713388442993164  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.228883266448975  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.231004238128662  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09362220764160156  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.252752780914307  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.256180763244629  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09273147583007812  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.900996208190918  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.902721881866455  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09609794616699219  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0233094692230225
pure train time :  0.7356998920440674
train time :  1.078294277191162
end to end time :  6.692747116088867
connection check time:  3.14857816696167
block generation time  1.845665693283081
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005054473876953125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01490330696105957
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5335431098937988
len local_batched_seeds_list  8
partition total batch output list spend :  0.8244128227233887
self.buckets_partition() spend  sec:  0.5484867095947266
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045508384704589844

in edges time spent  0.16820955276489258
local to global src and eids time spent  0.31911802291870117
time gen tails  0.0775911808013916
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1592574119567871

in edges time spent  0.7891409397125244
local to global src and eids time spent  1.2470190525054932
time gen tails  0.2122344970703125
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08002471923828125  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.203649520874023  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.203380107879639  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07532453536987305  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.085079669952393  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.086192607879639  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08396673202514648  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.1100969314575195  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.11315393447876  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07970666885375977  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.020811080932617  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0218186378479  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07941627502441406  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.011046886444092  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.012054443359375  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08710050582885742  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.251652717590332  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.253325939178467  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09381580352783203  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.224487781524658  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2279157638549805  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09278583526611328  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.877780437469482  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.8795061111450195  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0959482192993164  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9878907203674316
pure train time :  0.7336807250976562
train time :  1.0626213550567627
end to end time :  7.192819118499756
connection check time:  3.465642213821411
block generation time  1.8226568698883057
Run 00 | Epoch 00030 | Loss 1.9879 | Test 0.4606
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005216598510742188
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017009258270263672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5105390548706055
len local_batched_seeds_list  8
partition total batch output list spend :  0.6493055820465088
self.buckets_partition() spend  sec:  0.5275843143463135
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.047783613204956055

in edges time spent  0.1568155288696289
local to global src and eids time spent  0.3201901912689209
time gen tails  0.07908082008361816
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1598834991455078

in edges time spent  0.7977840900421143
local to global src and eids time spent  1.281641960144043
time gen tails  0.21137404441833496
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08052682876586914  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.224039077758789  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2237701416015625  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07542562484741211  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.075482368469238  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.076603412628174  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08415937423706055  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.1206560134887695  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.12371301651001  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07971954345703125  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.021335601806641  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.022341251373291  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07967615127563477  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.043979167938232  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.044994354248047  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08703136444091797  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.246397018432617  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.248127460479736  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09386634826660156  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2251996994018555  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.228627681732178  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09210777282714844  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.88367223739624  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.885538101196289  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09596824645996094  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9474189281463623
pure train time :  0.661583662033081
train time :  1.0294275283813477
end to end time :  7.032840967178345
connection check time:  3.5008723735809326
block generation time  1.8359379768371582
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005505084991455078
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014457225799560547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5051395893096924
len local_batched_seeds_list  8
partition total batch output list spend :  0.6569976806640625
self.buckets_partition() spend  sec:  0.5196304321289062
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04582381248474121

in edges time spent  0.15607500076293945
local to global src and eids time spent  0.3167698383331299
time gen tails  0.07788872718811035
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15965914726257324

in edges time spent  0.7695934772491455
local to global src and eids time spent  1.256549596786499
time gen tails  0.21001076698303223
res  length 8
block collection to dataloader spend  1.9073486328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08078241348266602  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.219862937927246  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.2195940017700195  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07545328140258789  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.078370094299316  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.0794830322265625  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.084228515625  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.119485378265381  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.122542381286621  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.07967138290405273  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.042539119720459  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.043546676635742  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.0796518325805664  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.035920143127441  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.036921501159668  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.08702468872070312  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.237175941467285  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.239264488220215  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09363746643066406  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.239471435546875  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 5.242899417877197  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 0.09217405319213867  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.874277114868164  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.9609375 GB
    Memory Allocated: 4.876585483551025  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09679603576660156  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.923276662826538
pure train time :  0.6721432209014893
train time :  1.02949857711792
end to end time :  6.967715263366699
connection check time:  3.438302516937256
block generation time  1.8231754302978516
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005533695220947266
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014440536499023438
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5271267890930176
len local_batched_seeds_list  8
partition total batch output list spend :  0.8114078044891357
self.buckets_partition() spend  sec:  0.541602611541748
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04430842399597168

in edges time spent  0.15120697021484375
local to global src and eids time spent  0.3159065246582031
time gen tails  0.07756757736206055
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15685462951660156

in edges time spent  0.7524893283843994
local to global src and eids time spent  1.2822561264038086
time gen tails  0.21835565567016602
res  length 8
block collection to dataloader spend  1.5735626220703125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08022451400756836  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.188669204711914  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1890788078308105  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07550525665283203  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.060952663421631  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.062066555023193  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08434772491455078  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130148887634277  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.133205890655518  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08031177520751953  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023759841918945  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0247673988342285  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07981586456298828  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048539161682129  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049546718597412  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0871572494506836  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240511894226074  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242356777191162  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09399223327636719  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240710735321045  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24371337890625  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09170341491699219  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8666605949401855  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.868130683898926  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0960378646850586  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.888285517692566
pure train time :  0.7314047813415527
train time :  1.0601348876953125
end to end time :  7.172203063964844
connection check time:  3.4674527645111084
block generation time  1.8177027702331543
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004825592041015625
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015040397644042969
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4095923900604248
len local_batched_seeds_list  8
partition total batch output list spend :  0.6862866878509521
self.buckets_partition() spend  sec:  0.424668550491333
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04362845420837402

in edges time spent  0.1564788818359375
local to global src and eids time spent  0.25455260276794434
time gen tails  0.07860517501831055
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16424012184143066

in edges time spent  0.794501781463623
local to global src and eids time spent  1.2628107070922852
time gen tails  0.21715354919433594
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052587509155273  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2152018547058105  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2149338722229  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07559776306152344  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075784206390381  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077723026275635  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08415079116821289  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127327919006348  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1305928230285645  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0792546272277832  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.007125377655029  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0081329345703125  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965326309204102  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036963939666748  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037964820861816  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702945709228516  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2475504875183105  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249326705932617  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09392070770263672  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235683917999268  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23911190032959  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09209537506103516  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.914699554443359  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9161696434021  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09597396850585938  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8579533100128174
pure train time :  0.7442080974578857
train time :  1.0863518714904785
end to end time :  7.121045351028442
connection check time:  3.4843084812164307
block generation time  1.8416342735290527
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005691051483154297
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01430368423461914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.525625467300415
len local_batched_seeds_list  8
partition total batch output list spend :  0.6948912143707275
self.buckets_partition() spend  sec:  0.5399675369262695
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04433894157409668

in edges time spent  0.15620684623718262
local to global src and eids time spent  0.3286621570587158
time gen tails  0.08049702644348145
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1557149887084961

in edges time spent  0.7778820991516113
local to global src and eids time spent  1.338620901107788
time gen tails  0.23232316970825195
res  length 8
block collection to dataloader spend  2.6702880859375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984399795532227  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2214579582214355  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221188068389893  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07527303695678711  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057770729064941  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.059386730194092  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08412027359008789  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.107124328613281  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1101813316345215  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0794382095336914  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026068687438965  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027076244354248  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07987499237060547  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.053183078765869  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054254055023193  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703947067260742  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245728015899658  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247527122497559  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09392166137695312  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.178091049194336  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.181134223937988  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0924534797668457  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905373573303223  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907186031341553  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09630346298217773  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8337805271148682
pure train time :  0.7345623970031738
train time :  1.081162691116333
end to end time :  7.359346151351929
connection check time:  3.6510326862335205
block generation time  1.9116425514221191
Run 00 | Epoch 00035 | Loss 1.8338 | Test 0.4927
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005075931549072266
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016015291213989258
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38843870162963867
len local_batched_seeds_list  8
partition total batch output list spend :  0.5253434181213379
self.buckets_partition() spend  sec:  0.40448999404907227
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.048406362533569336

in edges time spent  0.168656587600708
local to global src and eids time spent  0.31783318519592285
time gen tails  0.07864570617675781
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15456271171569824

in edges time spent  0.7535223960876465
local to global src and eids time spent  1.239678144454956
time gen tails  0.20924043655395508
res  length 8
block collection to dataloader spend  1.8835067749023438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0800929069519043  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213644981384277  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213375568389893  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554340362548828  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.065431594848633  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.066558361053467  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0840296745300293  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127729415893555  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1309943199157715  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967853546142578  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033514976501465  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034522533416748  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07949495315551758  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041182041168213  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042211532592773  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702993392944336  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2363386154174805  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23843240737915  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09425926208496094  GigaBytes
Max Memory Allocated: 5.3711628913879395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2565226554870605  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.259950637817383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0928201675415039  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906728744506836  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.908308506011963  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09598731994628906  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8008486032485962
pure train time :  0.7277886867523193
train time :  1.0694019794464111
end to end time :  6.836088180541992
connection check time:  3.416860818862915
block generation time  1.8081164360046387
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005953311920166016
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016510963439941406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.530451774597168
len local_batched_seeds_list  8
partition total batch output list spend :  0.8187801837921143
self.buckets_partition() spend  sec:  0.546999454498291
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046898841857910156

in edges time spent  0.15834951400756836
local to global src and eids time spent  0.33628296852111816
time gen tails  0.08191585540771484
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15745830535888672

in edges time spent  0.8066000938415527
local to global src and eids time spent  1.2622296810150146
time gen tails  0.216996431350708
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798349380493164  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217231273651123  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216961860656738  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07565116882324219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078636169433594  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079780578613281  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402252197265625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.108254909515381  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111311912536621  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07973575592041016  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020595550537109  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021597385406494  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960319519042969  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036301136016846  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0373029708862305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702802658081055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244010925292969  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246091365814209  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09375762939453125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248963832855225  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252391815185547  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09266376495361328  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.878679275512695  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8804426193237305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09606647491455078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.780016303062439
pure train time :  0.7361879348754883
train time :  1.0737159252166748
end to end time :  7.222411394119263
connection check time:  3.5158748626708984
block generation time  1.8001692295074463
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00038695335388183594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01829838752746582
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.21042251586914062
len local_batched_seeds_list  8
partition total batch output list spend :  0.30734944343566895
self.buckets_partition() spend  sec:  0.2287435531616211
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.029280662536621094

in edges time spent  0.0859382152557373
local to global src and eids time spent  0.11598682403564453
time gen tails  0.04464125633239746
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10423564910888672

in edges time spent  0.44971632957458496
local to global src and eids time spent  0.5364398956298828
time gen tails  0.1289839744567871
res  length 8
block collection to dataloader spend  2.1219253540039062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07982540130615234  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.180556774139404  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.180928707122803  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07558822631835938  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.067499160766602  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068714141845703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08420944213867188  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115397930145264  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.118454933166504  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07955265045166016  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032495498657227  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.03350305557251  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07952642440795898  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037795066833496  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039275646209717  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08714437484741211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2439093589782715  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245643615722656  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09389305114746094  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243527889251709  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246955871582031  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09228992462158203  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884341716766357  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.886138916015625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09659004211425781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7544960975646973
pure train time :  0.7038779258728027
train time :  1.0312294960021973
end to end time :  4.336697816848755
connection check time:  1.6975994110107422
block generation time  1.2828545570373535
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00035834312438964844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013368368148803711
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.22974157333374023
len local_batched_seeds_list  8
partition total batch output list spend :  0.3191838264465332
self.buckets_partition() spend  sec:  0.2431800365447998
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.025646448135375977

in edges time spent  0.0830988883972168
local to global src and eids time spent  0.11656332015991211
time gen tails  0.04409003257751465
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10560274124145508

in edges time spent  0.7607071399688721
local to global src and eids time spent  1.2342731952667236
time gen tails  0.2095015048980713
res  length 8
block collection to dataloader spend  1.5497207641601562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08014535903930664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2111921310424805  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.210923671722412  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07558536529541016  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079288482666016  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0805182456970215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08430194854736328  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.131426811218262  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.134483814239502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07948446273803711  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026247024536133  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0272393226623535  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07969379425048828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0508713722229  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051932334899902  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705520629882812  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236660003662109  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238576412200928  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09406614303588867  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239397048950195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242825031280518  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09229898452758789  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901552677154541  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903278350830078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09610509872436523  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7270891666412354
pure train time :  0.7397112846374512
train time :  1.060957670211792
end to end time :  6.0538129806518555
connection check time:  2.955264091491699
block generation time  1.7027828693389893
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005741119384765625
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015299081802368164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48154616355895996
len local_batched_seeds_list  8
partition total batch output list spend :  0.7720296382904053
self.buckets_partition() spend  sec:  0.49688053131103516
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045400142669677734

in edges time spent  0.16345787048339844
local to global src and eids time spent  0.320375919342041
time gen tails  0.07944107055664062
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1576523780822754

in edges time spent  0.8114283084869385
local to global src and eids time spent  1.340764045715332
time gen tails  0.2252509593963623
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0800471305847168  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.189315319061279  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1890459060668945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07544565200805664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072042465209961  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073353290557861  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08403587341308594  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112042427062988  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1150994300842285  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960653305053711  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013119220733643  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014126777648926  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07969045639038086  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054858207702637  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.05592679977417  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706426620483398  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251723766326904  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253649711608887  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361553192138672  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2346062660217285  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238034248352051  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09265804290771484  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899863243103027  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901601314544678  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09607887268066406  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7056719064712524
pure train time :  0.7447659969329834
train time :  1.0677924156188965
end to end time :  7.347341060638428
connection check time:  3.6164960861206055
block generation time  1.8740839958190918
Run 00 | Epoch 00040 | Loss 1.7057 | Test 0.5163
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004634857177734375
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015882015228271484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4655625820159912
len local_batched_seeds_list  8
partition total batch output list spend :  0.6023869514465332
self.buckets_partition() spend  sec:  0.4814755916595459
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04503583908081055

in edges time spent  0.15531373023986816
local to global src and eids time spent  0.31868410110473633
time gen tails  0.07834362983703613
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15612220764160156

in edges time spent  0.8174149990081787
local to global src and eids time spent  1.2362258434295654
time gen tails  0.2104942798614502
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08010149002075195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219966411590576  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21969747543335  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07523870468139648  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075923919677734  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077963829040527  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08405065536499023  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.083102703094482  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0863261222839355  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796055793762207  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.029940128326416  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.030947685241699  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795755386352539  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044066905975342  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045074462890625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705520629882812  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243485927581787  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245033264160156  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361028671264648  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2268853187561035  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2294158935546875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09213542938232422  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.914297580718994  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.915767669677734  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09661483764648438  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6850935220718384
pure train time :  0.7366237640380859
train time :  1.0724225044250488
end to end time :  6.9687511920928955
connection check time:  3.463189125061035
block generation time  1.816312313079834
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005261898040771484
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01479196548461914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4863095283508301
len local_batched_seeds_list  8
partition total batch output list spend :  0.7753865718841553
self.buckets_partition() spend  sec:  0.5011322498321533
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045029640197753906

in edges time spent  0.15279698371887207
local to global src and eids time spent  0.31662821769714355
time gen tails  0.0783681869506836
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15671730041503906

in edges time spent  0.7496347427368164
local to global src and eids time spent  1.2318599224090576
time gen tails  0.20854926109313965
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0804433822631836  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21789026260376  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217757701873779  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554435729980469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069215774536133  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070445537567139  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08407306671142578  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.095604419708252  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0988969802856445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953643798828125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0109124183654785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.011919975280762  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964515686035156  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045959949493408  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046967506408691  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08710622787475586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.25138521194458  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2530317306518555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09381532669067383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247958660125732  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251386642456055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09228134155273438  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901625633239746  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903666019439697  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09619712829589844  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6564964056015015
pure train time :  0.797081470489502
train time :  1.1153013706207275
end to end time :  7.09892725944519
connection check time:  3.38861083984375
block generation time  1.8009576797485352
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004754066467285156
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014530181884765625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48584747314453125
len local_batched_seeds_list  8
partition total batch output list spend :  0.7747819423675537
self.buckets_partition() spend  sec:  0.5004091262817383
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.047080039978027344

in edges time spent  0.15503931045532227
local to global src and eids time spent  0.31479620933532715
time gen tails  0.07782292366027832
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1541306972503662

in edges time spent  0.7557764053344727
local to global src and eids time spent  1.2276372909545898
time gen tails  0.2080068588256836
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08016586303710938  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213810920715332  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2135419845581055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0753021240234375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074212551116943  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0753326416015625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08423042297363281  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.131567478179932  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.134624481201172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08024787902832031  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.019787788391113  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0207953453063965  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07971715927124023  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044567584991455  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045575141906738  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702945709228516  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.230951309204102  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232799053192139  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09360456466674805  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.198726177215576  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.201728820800781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09192848205566406  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.910912990570068  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.912383079528809  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09597492218017578  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6394805908203125
pure train time :  0.7302420139312744
train time :  1.0764155387878418
end to end time :  7.059805154800415
connection check time:  3.3874270915985107
block generation time  1.805041790008545
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004949569702148438
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017260313034057617
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46555280685424805
len local_batched_seeds_list  8
partition total batch output list spend :  0.6064026355743408
self.buckets_partition() spend  sec:  0.48284363746643066
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04784035682678223

in edges time spent  0.15639257431030273
local to global src and eids time spent  0.3213386535644531
time gen tails  0.08492922782897949
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15854096412658691

in edges time spent  0.7702057361602783
local to global src and eids time spent  1.2434349060058594
time gen tails  0.21104168891906738
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983827590942383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216216564178467  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2165093421936035  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07545757293701172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069834232330322  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071773052215576  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08410978317260742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111888885498047  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.114945888519287  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08012771606445312  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.01824951171875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0192461013793945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07972002029418945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050441265106201  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051548004150391  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.087066650390625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236042499542236  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237890243530273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362125396728516  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240566730499268  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24399471282959  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09279394149780273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884303092956543  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.885773181915283  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09595251083374023  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6210497617721558
pure train time :  0.7286965847015381
train time :  1.0749647617340088
end to end time :  6.954028129577637
connection check time:  3.4417011737823486
block generation time  1.8096423149108887
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005025863647460938
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015229225158691406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.530418872833252
len local_batched_seeds_list  8
partition total batch output list spend :  0.8204572200775146
self.buckets_partition() spend  sec:  0.5456845760345459
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04549264907836914

in edges time spent  0.16785717010498047
local to global src and eids time spent  0.3187377452850342
time gen tails  0.07841110229492188
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1532888412475586

in edges time spent  0.787865400314331
local to global src and eids time spent  1.2328050136566162
time gen tails  0.209702730178833
res  length 8
block collection to dataloader spend  1.3113021850585938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984304428100586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216153621673584  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215884685516357  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07525491714477539  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.064788341522217  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0668110847473145  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0844278335571289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.098025798797607  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.101941108703613  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07989263534545898  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.056893825531006  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057901382446289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07970046997070312  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040355205535889  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041362762451172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08720541000366211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241032600402832  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242812633514404  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09392786026000977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234280586242676  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237708568572998  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0926513671875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.880756378173828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.882226467132568  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.096588134765625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6015889644622803
pure train time :  0.739457368850708
train time :  1.0582311153411865
end to end time :  7.15076756477356
connection check time:  3.440779685974121
block generation time  1.81148362159729
Run 00 | Epoch 00045 | Loss 1.6016 | Test 0.5397
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005156993865966797
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015172481536865234
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.537822961807251
len local_batched_seeds_list  8
partition total batch output list spend :  0.8218710422515869
self.buckets_partition() spend  sec:  0.5530319213867188
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04690408706665039

in edges time spent  0.15793704986572266
local to global src and eids time spent  0.31882214546203613
time gen tails  0.07960987091064453
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1548447608947754

in edges time spent  0.8135783672332764
local to global src and eids time spent  1.2426912784576416
time gen tails  0.21256685256958008
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07999038696289062  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211584091186523  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211315631866455  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554340362548828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076395034790039  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077624797821045  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08425378799438477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127557754516602  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130614757537842  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07941436767578125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.01701021194458  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.018002033233643  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07969474792480469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0468645095825195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048745632171631  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08710575103759766  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244876861572266  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246618747711182  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09387969970703125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.223386287689209  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.226814270019531  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09206771850585938  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.910912036895752  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.912382125854492  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09593009948730469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5833215713500977
pure train time :  0.7194023132324219
train time :  1.0661075115203857
end to end time :  7.200571298599243
connection check time:  3.474372625350952
block generation time  1.8186326026916504
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005977153778076172
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014210224151611328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4949634075164795
len local_batched_seeds_list  8
partition total batch output list spend :  0.7780303955078125
self.buckets_partition() spend  sec:  0.5092096328735352
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04559922218322754

in edges time spent  0.15432429313659668
local to global src and eids time spent  0.32210564613342285
time gen tails  0.07802391052246094
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1546800136566162

in edges time spent  0.7818403244018555
local to global src and eids time spent  1.1723990440368652
time gen tails  0.17541074752807617
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983827590942383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217052936553955  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2167840003967285  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07518482208251953  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069864749908447  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07098913192749  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397769927978516  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.090782642364502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.093839645385742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07957172393798828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.030663013458252  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.031660079956055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966756820678711  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039388179779053  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040400505065918  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703184127807617  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24247407913208  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244021415710449  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361839294433594  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240116119384766  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243118762969971  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09195995330810547  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904361724853516  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9061970710754395  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09604549407958984  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5646171569824219
pure train time :  0.7734987735748291
train time :  1.0939607620239258
end to end time :  7.030089855194092
connection check time:  3.331322193145752
block generation time  1.8091309070587158
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005385875701904297
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014453649520874023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4973599910736084
len local_batched_seeds_list  8
partition total batch output list spend :  0.7847623825073242
self.buckets_partition() spend  sec:  0.5118489265441895
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04599642753601074

in edges time spent  0.1536424160003662
local to global src and eids time spent  0.3089637756347656
time gen tails  0.07854008674621582
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15716838836669922

in edges time spent  0.7719171047210693
local to global src and eids time spent  1.2309601306915283
time gen tails  0.20941710472106934
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07991456985473633  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2095794677734375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2102460861206055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0755615234375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072319030761719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073548793792725  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08481216430664062  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1061248779296875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109181880950928  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0794839859008789  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0243964195251465  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025403022766113  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947969436645508  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044234275817871  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045240879058838  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703947067260742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238897323608398  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240814685821533  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09406375885009766  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246706485748291  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250134468078613  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09222602844238281  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906489849090576  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907959938049316  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09636783599853516  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5435724258422852
pure train time :  0.7217471599578857
train time :  1.0411615371704102
end to end time :  7.06401252746582
connection check time:  3.406304121017456
block generation time  1.815577745437622
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004532337188720703
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013983964920043945
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3739941120147705
len local_batched_seeds_list  8
partition total batch output list spend :  0.6491165161132812
self.buckets_partition() spend  sec:  0.38800859451293945
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.03932619094848633

in edges time spent  0.15209412574768066
local to global src and eids time spent  0.15680170059204102
time gen tails  0.06026768684387207
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15992403030395508

in edges time spent  0.7544760704040527
local to global src and eids time spent  1.2594380378723145
time gen tails  0.20990657806396484
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0800943374633789  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.205918788909912  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.205648899078369  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07543754577636719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075674533843994  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077759265899658  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404016494750977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.101235389709473  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.105071544647217  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08026266098022461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034799575805664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035807132720947  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960987091064453  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035950183868408  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036952495574951  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870213508605957  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233981132507324  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235949993133545  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09411191940307617  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241292953491211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244720935821533  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09272289276123047  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904533386230469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906003475189209  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09588813781738281  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.531522512435913
pure train time :  0.7213089466094971
train time :  1.0673754215240479
end to end time :  6.819581508636475
connection check time:  3.245377540588379
block generation time  1.8395378589630127
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004661083221435547
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014056205749511719
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.45348620414733887
len local_batched_seeds_list  8
partition total batch output list spend :  0.7382309436798096
self.buckets_partition() spend  sec:  0.4675712585449219
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046323299407958984

in edges time spent  0.15544390678405762
local to global src and eids time spent  0.33142852783203125
time gen tails  0.07862210273742676
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15511703491210938

in edges time spent  0.8431746959686279
local to global src and eids time spent  1.2728121280670166
time gen tails  0.21543073654174805
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08076810836791992  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218372344970703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218103408813477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07562398910522461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077504634857178  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079443454742432  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0841975212097168  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1155104637146  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.11856746673584  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08024406433105469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.052896976470947  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0539045333862305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07940340042114258  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037448406219482  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038520336151123  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705854415893555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254314422607422  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2560296058654785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09386205673217773  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2382988929748535  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241726875305176  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09273290634155273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.882351875305176  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884217739105225  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09621858596801758  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5178861618041992
pure train time :  0.7358851432800293
train time :  1.0609898567199707
end to end time :  7.177090883255005
connection check time:  3.5510218143463135
block generation time  1.8049895763397217
Run 00 | Epoch 00050 | Loss 1.5179 | Test 0.5555
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005142688751220703
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0156557559967041
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41614317893981934
len local_batched_seeds_list  8
partition total batch output list spend :  0.6986587047576904
self.buckets_partition() spend  sec:  0.43183422088623047
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04723072052001953

in edges time spent  0.15935492515563965
local to global src and eids time spent  0.3172597885131836
time gen tails  0.08172297477722168
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15656495094299316

in edges time spent  0.756249189376831
local to global src and eids time spent  1.2431764602661133
time gen tails  0.2125411033630371
res  length 8
block collection to dataloader spend  1.9073486328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08016777038574219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21715784072876  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216888904571533  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07521343231201172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.066540718078613  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.067722320556641  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08416223526000977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.118682861328125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.121739864349365  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07955074310302734  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041254997253418  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042262554168701  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960939407348633  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037113189697266  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038120746612549  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08751058578491211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245105743408203  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246586322784424  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09385442733764648  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.229367733001709  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232795715332031  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09275484085083008  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877974510192871  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.880282878875732  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09592723846435547  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.498875379562378
pure train time :  0.7325754165649414
train time :  1.070087194442749
end to end time :  7.0309460163116455
connection check time:  3.4245474338531494
block generation time  1.8192131519317627
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005705356597900391
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015758037567138672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.535527229309082
len local_batched_seeds_list  8
partition total batch output list spend :  0.830756425857544
self.buckets_partition() spend  sec:  0.5513205528259277
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.05675244331359863

in edges time spent  0.15798640251159668
local to global src and eids time spent  0.30504512786865234
time gen tails  0.06260943412780762
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16536307334899902

in edges time spent  0.8418090343475342
local to global src and eids time spent  1.3094172477722168
time gen tails  0.22559809684753418
res  length 8
block collection to dataloader spend  2.2172927856445312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984113693237305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222707748413086  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.223401069641113  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07546710968017578  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.085172176361084  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.086296558380127  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08403730392456055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120845317840576  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.123902320861816  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947683334350586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020650386810303  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021657943725586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964468002319336  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038243293762207  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039250373840332  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702993392944336  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246487140655518  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2485809326171875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362459182739258  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253729820251465  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.257157802581787  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09203672409057617  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903007984161377  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904478073120117  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09590291976928711  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.489367961883545
pure train time :  0.7464208602905273
train time :  1.0895955562591553
end to end time :  7.441149950027466
connection check time:  3.603773355484009
block generation time  1.9007036685943604
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.000499725341796875
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.019830942153930664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5383808612823486
len local_batched_seeds_list  8
partition total batch output list spend :  0.8277513980865479
self.buckets_partition() spend  sec:  0.5582470893859863
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04693865776062012

in edges time spent  0.1600048542022705
local to global src and eids time spent  0.31809496879577637
time gen tails  0.07936930656433105
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15649724006652832

in edges time spent  0.7635726928710938
local to global src and eids time spent  1.0494019985198975
time gen tails  0.17759251594543457
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983684539794922  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215478420257568  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215209007263184  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07525348663330078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074116230010986  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07524299621582  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404254913330078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120371341705322  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1234283447265625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07946491241455078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0218186378479  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022826194763184  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07948970794677734  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034072399139404  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0350799560546875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707094192504883  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233340263366699  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235486030578613  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09425878524780273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243255615234375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246683597564697  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0927114486694336  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9029998779296875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905018329620361  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0961313247680664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4761923551559448
pure train time :  0.657846212387085
train time :  1.0302724838256836
end to end time :  6.9440248012542725
connection check time:  3.199956178665161
block generation time  1.8547158241271973
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048470497131347656
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01617908477783203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.474367618560791
len local_batched_seeds_list  8
partition total batch output list spend :  0.6134915351867676
self.buckets_partition() spend  sec:  0.49057936668395996
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.049300193786621094

in edges time spent  0.15914583206176758
local to global src and eids time spent  0.24353504180908203
time gen tails  0.07659626007080078
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16697931289672852

in edges time spent  0.8162524700164795
local to global src and eids time spent  1.253068208694458
time gen tails  0.21380853652954102
res  length 8
block collection to dataloader spend  1.7881393432617188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08009195327758789  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224031448364258  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.223762512207031  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554388046264648  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.083890438079834  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.08512020111084  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402681350708008  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.097361087799072  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1004180908203125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07970285415649414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032780170440674  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033787727355957  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07955026626586914  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044801235198975  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045877456665039  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705425262451172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239521503448486  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241430759429932  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0940561294555664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236706256866455  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240134239196777  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09266138076782227  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901425361633301  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9033942222595215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09614801406860352  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4622151851654053
pure train time :  0.7267036437988281
train time :  1.0733115673065186
end to end time :  6.972024917602539
connection check time:  3.423612117767334
block generation time  1.8387811183929443
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005707740783691406
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014887809753417969
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5475306510925293
len local_batched_seeds_list  8
partition total batch output list spend :  0.8384015560150146
self.buckets_partition() spend  sec:  0.5624566078186035
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04757976531982422

in edges time spent  0.15484404563903809
local to global src and eids time spent  0.31790900230407715
time gen tails  0.07998895645141602
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15506219863891602

in edges time spent  0.7528982162475586
local to global src and eids time spent  1.2392258644104004
time gen tails  0.2117764949798584
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08016109466552734  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.204676151275635  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.204407691955566  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07545709609985352  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072332859039307  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0744123458862305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08409261703491211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.11658239364624  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1196393966674805  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07974481582641602  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037873268127441  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038880825042725  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07954645156860352  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.029438018798828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0305070877075195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08709001541137695  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242082595825195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2441887855529785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363985061645508  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238104820251465  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240642070770264  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09257650375366211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.874810218811035  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.876740455627441  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09632635116577148  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.452706217765808
pure train time :  0.7458381652832031
train time :  1.092031717300415
end to end time :  7.206777572631836
connection check time:  3.409130573272705
block generation time  1.8534162044525146
Run 00 | Epoch 00055 | Loss 1.4527 | Test 0.5761
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004916191101074219
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014858722686767578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5402195453643799
len local_batched_seeds_list  8
partition total batch output list spend :  0.8231968879699707
self.buckets_partition() spend  sec:  0.5551126003265381
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04732537269592285

in edges time spent  0.16159653663635254
local to global src and eids time spent  0.3190486431121826
time gen tails  0.0793004035949707
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15725374221801758

in edges time spent  0.7823152542114258
local to global src and eids time spent  1.2361078262329102
time gen tails  0.21558690071105957
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984113693237305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221384525299072  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221794128417969  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07556486129760742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074202060699463  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075530052185059  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08447122573852539  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12601900100708  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12907600402832  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07940340042114258  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.001942157745361  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.00294828414917  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945919036865234  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034435749053955  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035441875457764  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870370864868164  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222430229187012  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224277973175049  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363126754760742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24406623840332  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247494220733643  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09209585189819336  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898443698883057  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900256156921387  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0962224006652832  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.437216877937317
pure train time :  0.7266044616699219
train time :  1.0744333267211914
end to end time :  7.2105395793914795
connection check time:  3.4473283290863037
block generation time  1.8468365669250488
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005393028259277344
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014876127243041992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49274301528930664
len local_batched_seeds_list  8
partition total batch output list spend :  0.792579174041748
self.buckets_partition() spend  sec:  0.5076515674591064
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.049123287200927734

in edges time spent  0.15632271766662598
local to global src and eids time spent  0.32124853134155273
time gen tails  0.0798642635345459
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1570894718170166

in edges time spent  0.8029296398162842
local to global src and eids time spent  1.2893192768096924
time gen tails  0.2160017490386963
res  length 8
block collection to dataloader spend  2.288818359375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008623123168945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.18646240234375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.18687105178833  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0755925178527832  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.065311431884766  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0672502517700195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08411073684692383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127792835235596  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130849838256836  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07955121994018555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0237531661987305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024760723114014  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953023910522461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048509120941162  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049516677856445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08746480941772461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251132011413574  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2529425621032715  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09397125244140625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237519264221191  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240947246551514  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09218931198120117  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877139091491699  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8794474601745605  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09651899337768555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4258265495300293
pure train time :  0.7500255107879639
train time :  1.0859956741333008
end to end time :  7.337442874908447
connection check time:  3.5857491493225098
block generation time  1.8539762496948242
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005064010620117188
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018021583557128906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5327913761138916
len local_batched_seeds_list  8
partition total batch output list spend :  0.8166255950927734
self.buckets_partition() spend  sec:  0.5508477687835693
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044214725494384766

in edges time spent  0.15322089195251465
local to global src and eids time spent  0.31828784942626953
time gen tails  0.0783700942993164
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15645980834960938

in edges time spent  0.7534162998199463
local to global src and eids time spent  1.2390966415405273
time gen tails  0.21149110794067383
res  length 8
block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08022260665893555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.225039005279541  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224770545959473  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07527685165405273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.056475639343262  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057705402374268  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08407783508300781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127627849578857  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130892753601074  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07937765121459961  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017511367797852  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.018513202667236  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07970237731933594  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036505222320557  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.03750467300415  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870208740234375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227222442626953  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2291483879089355  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362936019897461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235350608825684  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238778591156006  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09225893020629883  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877227306365967  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.879179954528809  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09638309478759766  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4163798093795776
pure train time :  0.7503440380096436
train time :  1.0920517444610596
end to end time :  7.152599811553955
connection check time:  3.4035136699676514
block generation time  1.8243467807769775
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004870891571044922
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015344619750976562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48497629165649414
len local_batched_seeds_list  8
partition total batch output list spend :  0.7719755172729492
self.buckets_partition() spend  sec:  0.5003540515899658
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.049574851989746094

in edges time spent  0.16006088256835938
local to global src and eids time spent  0.2512650489807129
time gen tails  0.08011555671691895
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15649151802062988

in edges time spent  0.823300838470459
local to global src and eids time spent  1.257706642150879
time gen tails  0.21483755111694336
res  length 8
block collection to dataloader spend  2.2172927856445312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023548126220703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2066521644592285  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206383228302002  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07523536682128906  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0738139152526855  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075011730194092  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08421850204467773  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1322832107543945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.135340213775635  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07943296432495117  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.985282897949219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.986290454864502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07971572875976562  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042196273803711  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043203830718994  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704662322998047  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249351978302002  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250954627990723  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09375524520874023  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247780799865723  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251208782196045  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09276437759399414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904463291168213  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906516075134277  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09620046615600586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.402583122253418
pure train time :  0.7199094295501709
train time :  1.058154821395874
end to end time :  7.1363747119903564
connection check time:  3.4427356719970703
block generation time  1.8364782333374023
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005538463592529297
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014374256134033203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5282497406005859
len local_batched_seeds_list  8
partition total batch output list spend :  0.7431919574737549
self.buckets_partition() spend  sec:  0.5426638126373291
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04673361778259277

in edges time spent  0.16011762619018555
local to global src and eids time spent  0.3184046745300293
time gen tails  0.0800316333770752
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15651988983154297

in edges time spent  0.7838685512542725
local to global src and eids time spent  1.3165323734283447
time gen tails  0.23263120651245117
res  length 8
block collection to dataloader spend  2.2172927856445312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008766174316406  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216564178466797  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216294288635254  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07532501220703125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.067699432373047  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068929195404053  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839376449584961  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0929274559021  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.09598445892334  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795907974243164  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013844966888428  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014837741851807  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07972002029418945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041094779968262  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0420942306518555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08701801300048828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.229628086090088  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231775283813477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361124038696289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244685173034668  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24811315536499  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09200811386108398  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901817798614502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903307914733887  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09588956832885742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3973876237869263
pure train time :  0.7265727519989014
train time :  1.1423122882843018
end to end time :  7.37852931022644
connection check time:  3.625584602355957
block generation time  1.8479588031768799
Run 00 | Epoch 00060 | Loss 1.3974 | Test 0.5943
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004954338073730469
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015786170959472656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5253424644470215
len local_batched_seeds_list  8
partition total batch output list spend :  0.8061139583587646
self.buckets_partition() spend  sec:  0.541163444519043
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046523094177246094

in edges time spent  0.1585862636566162
local to global src and eids time spent  0.31823086738586426
time gen tails  0.08010292053222656
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15464282035827637

in edges time spent  0.8398880958557129
local to global src and eids time spent  1.3056464195251465
time gen tails  0.21754813194274902
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983827590942383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220144271850586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220436096191406  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07531976699829102  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068863868713379  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070093631744385  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08409452438354492  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109494686126709  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112551689147949  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953405380249023  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02380895614624  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024801254272461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07962369918823242  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040746688842773  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041781902313232  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706998825073242  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.258894920349121  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.260535717010498  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09379196166992188  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240941524505615  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24394416809082  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0919337272644043  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9001288414001465  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901598930358887  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0959782600402832  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3854600191116333
pure train time :  0.6580407619476318
train time :  1.0267879962921143
end to end time :  7.249831914901733
connection check time:  3.5719518661499023
block generation time  1.8296394348144531
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005805492401123047
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014606475830078125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49219632148742676
len local_batched_seeds_list  8
partition total batch output list spend :  0.7730419635772705
self.buckets_partition() spend  sec:  0.5068392753601074
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04544878005981445

in edges time spent  0.15881776809692383
local to global src and eids time spent  0.3268013000488281
time gen tails  0.0791933536529541
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15652179718017578

in edges time spent  0.7980804443359375
local to global src and eids time spent  1.2436962127685547
time gen tails  0.2095186710357666
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983541488647461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216217517852783  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216626167297363  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07556772232055664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077206611633301  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079145431518555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08414506912231445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1263322830200195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.129597187042236  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953882217407227  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.019374847412109  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020381927490234  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07959842681884766  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0371527671813965  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0381598472595215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702945709228516  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2477192878723145  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249503135681152  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09392786026000977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233429908752441  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236857891082764  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0927572250366211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.909330368041992  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.910800457000732  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09592437744140625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3758174180984497
pure train time :  0.7397680282592773
train time :  1.0653445720672607
end to end time :  7.129101514816284
connection check time:  3.4653561115264893
block generation time  1.808401107788086
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005369186401367188
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014302492141723633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47939324378967285
len local_batched_seeds_list  8
partition total batch output list spend :  0.7545640468597412
self.buckets_partition() spend  sec:  0.4937272071838379
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04478192329406738

in edges time spent  0.1451578140258789
local to global src and eids time spent  0.3163599967956543
time gen tails  0.07813405990600586
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.156266450881958

in edges time spent  0.7552289962768555
local to global src and eids time spent  1.2295827865600586
time gen tails  0.21080780029296875
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983636856079102  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2186760902404785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218406677246094  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07565975189208984  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0788164138793945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080625057220459  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08427286148071289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112228870391846  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115285873413086  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07979679107666016  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020936489105225  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021944046020508  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.079864501953125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0537109375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054718494415283  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704042434692383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.256991386413574  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.258763790130615  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09392595291137695  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235602378845215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238596439361572  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09176397323608398  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.870594501495361  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872647285461426  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09581279754638672  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3673162460327148
pure train time :  0.7289528846740723
train time :  1.0514111518859863
end to end time :  7.01913595199585
connection check time:  3.3839924335479736
block generation time  1.8156185150146484
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004749298095703125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014569282531738281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3796579837799072
len local_batched_seeds_list  8
partition total batch output list spend :  0.65960693359375
self.buckets_partition() spend  sec:  0.39426112174987793
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04475283622741699

in edges time spent  0.1551504135131836
local to global src and eids time spent  0.32151222229003906
time gen tails  0.07803678512573242
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16095376014709473

in edges time spent  0.7422730922698975
local to global src and eids time spent  1.2417383193969727
time gen tails  0.21329283714294434
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983827590942383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221500873565674  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221909999847412  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07545900344848633  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.063594818115234  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06482458114624  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.084014892578125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1066083908081055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109665393829346  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07938528060913086  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024144172668457  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025143623352051  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966899871826172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043114185333252  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044113636016846  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704996109008789  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2462992668151855  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2483954429626465  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09413766860961914  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2447967529296875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24822473526001  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09225797653198242  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901590824127197  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90358829498291  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09617471694946289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3560360670089722
pure train time :  0.7327122688293457
train time :  1.0612382888793945
end to end time :  6.9663543701171875
connection check time:  3.4089126586914062
block generation time  1.8231160640716553
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005452632904052734
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014600753784179688
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47260403633117676
len local_batched_seeds_list  8
partition total batch output list spend :  0.7609720230102539
self.buckets_partition() spend  sec:  0.48723745346069336
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04497861862182617

in edges time spent  0.15576863288879395
local to global src and eids time spent  0.33710670471191406
time gen tails  0.07895922660827637
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15788745880126953

in edges time spent  0.7666819095611572
local to global src and eids time spent  1.2675087451934814
time gen tails  0.21451592445373535
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08016157150268555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.209665775299072  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.209396839141846  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07567739486694336  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.087075233459473  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0891499519348145  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08417415618896484  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1293182373046875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.132375240325928  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07938575744628906  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021822452545166  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022830009460449  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07973861694335938  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037862300872803  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038888931274414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702611923217773  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2340497970581055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236115455627441  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362506866455078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245746612548828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24917459487915  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09275960922241211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90135383605957  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903473377227783  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09630155563354492  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3521941900253296
pure train time :  0.7474796772003174
train time :  1.0762529373168945
end to end time :  7.164841175079346
connection check time:  3.4777636528015137
block generation time  1.8315503597259521
Run 00 | Epoch 00065 | Loss 1.3522 | Test 0.6038
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048470497131347656
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014972925186157227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38912057876586914
len local_batched_seeds_list  8
partition total batch output list spend :  0.5241494178771973
self.buckets_partition() spend  sec:  0.40412354469299316
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0668172836303711

in edges time spent  0.15855002403259277
local to global src and eids time spent  0.32893824577331543
time gen tails  0.08499455451965332
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15540075302124023

in edges time spent  0.8222105503082275
local to global src and eids time spent  1.207981824874878
time gen tails  0.19358372688293457
res  length 8
block collection to dataloader spend  1.7881393432617188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08021688461303711  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211219310760498  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211867332458496  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07531023025512695  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06924295425415  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071181774139404  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08399057388305664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.117118835449219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120175838470459  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956504821777344  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0204758644104  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021483421325684  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964324951171875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047031879425049  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048039436340332  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705711364746094  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252119064331055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253878116607666  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09391069412231445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2465033531188965  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249931335449219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0928349494934082  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905479431152344  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907059192657471  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09600400924682617  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3381035327911377
pure train time :  0.7032673358917236
train time :  1.0445172786712646
end to end time :  7.0006020069122314
connection check time:  3.5282814502716064
block generation time  1.8872077465057373
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00038361549377441406
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013815879821777344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2486276626586914
len local_batched_seeds_list  8
partition total batch output list spend :  0.47407031059265137
self.buckets_partition() spend  sec:  0.2624697685241699
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04867148399353027

in edges time spent  0.15951824188232422
local to global src and eids time spent  0.31976962089538574
time gen tails  0.08068156242370605
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16000771522521973

in edges time spent  0.831763744354248
local to global src and eids time spent  1.332540512084961
time gen tails  0.22324538230895996
res  length 8
block collection to dataloader spend  2.3603439331054688e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.079833984375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2196831703186035  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219413757324219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07542657852172852  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074997425079346  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076227188110352  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08415079116821289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116939067840576  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.119996070861816  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07944154739379883  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.003967761993408  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.004967212677002  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07951164245605469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032361030578613  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033360481262207  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702993392944336  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24493932723999  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2470221519470215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09375762939453125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244223117828369  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247651100158691  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09238338470458984  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90166711807251  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903719902038574  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09622955322265625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3328777551651
pure train time :  0.7362825870513916
train time :  1.0725500583648682
end to end time :  7.085745811462402
connection check time:  3.67046856880188
block generation time  1.8526654243469238
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004553794860839844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016535520553588867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47350311279296875
len local_batched_seeds_list  8
partition total batch output list spend :  0.6086447238922119
self.buckets_partition() spend  sec:  0.49007129669189453
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04209136962890625

in edges time spent  0.1553173065185547
local to global src and eids time spent  0.31629276275634766
time gen tails  0.07939791679382324
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15520644187927246

in edges time spent  0.7869021892547607
local to global src and eids time spent  1.2357690334320068
time gen tails  0.21033406257629395
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0800938606262207  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.22134256362915  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2217512130737305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07557821273803711  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0729899406433105  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074109077453613  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08414602279663086  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120571136474609  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12362813949585  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945537567138672  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050835609436035  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051843166351318  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07963943481445312  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04816198348999  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049169540405273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703136444091797  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227161407470703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.22900915145874  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361934661865234  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236701488494873  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240129470825195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09183645248413086  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.892859935760498  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.894684791564941  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09599637985229492  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3218810558319092
pure train time :  0.7486367225646973
train time :  1.0736408233642578
end to end time :  6.940567493438721
connection check time:  3.4223952293395996
block generation time  1.8162286281585693
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004961490631103516
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01657414436340332
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.45982813835144043
len local_batched_seeds_list  8
partition total batch output list spend :  0.7447426319122314
self.buckets_partition() spend  sec:  0.47643518447875977
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04531407356262207

in edges time spent  0.15990328788757324
local to global src and eids time spent  0.33435893058776855
time gen tails  0.08205127716064453
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1610710620880127

in edges time spent  0.8232474327087402
local to global src and eids time spent  1.2927165031433105
time gen tails  0.21642327308654785
res  length 8
block collection to dataloader spend  2.2172927856445312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0801239013671875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.168166160583496  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1680755615234375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07555341720581055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0714430809021  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0726728439331055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08408403396606445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12872838973999  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1317853927612305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0794672966003418  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.019014358520508  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020021915435791  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984352111816406  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045130252838135  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046158313751221  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705329895019531  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251158714294434  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253224849700928  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09413480758666992  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.25022029876709  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253648281097412  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09277772903442383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8997955322265625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9015212059021  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09618616104125977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3150209188461304
pure train time :  0.7454996109008789
train time :  1.0780584812164307
end to end time :  7.280548810958862
connection check time:  3.598830223083496
block generation time  1.8380422592163086
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004775524139404297
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015674829483032227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5292584896087646
len local_batched_seeds_list  8
partition total batch output list spend :  0.8105146884918213
self.buckets_partition() spend  sec:  0.5449676513671875
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04421520233154297

in edges time spent  0.15759754180908203
local to global src and eids time spent  0.3217759132385254
time gen tails  0.07912969589233398
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15633726119995117

in edges time spent  0.7590193748474121
local to global src and eids time spent  1.0391056537628174
time gen tails  0.1746063232421875
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08007574081420898  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211967468261719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211698055267334  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07547807693481445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071084022521973  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072198390960693  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839686393737793  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111958026885986  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115015029907227  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956457138061523  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.056044578552246  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057052135467529  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960224151611328  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041316986083984  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042324066162109  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707666397094727  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244071960449219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245869159698486  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09393596649169922  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.204792022705078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2082200050354  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09269428253173828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899127960205078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900598049163818  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09601402282714844  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3122215270996094
pure train time :  0.7482419013977051
train time :  1.0883822441101074
end to end time :  6.9441728591918945
connection check time:  3.192453145980835
block generation time  1.8380746841430664
Run 00 | Epoch 00070 | Loss 1.3122 | Test 0.6111
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004971027374267578
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016289234161376953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5169975757598877
len local_batched_seeds_list  8
partition total batch output list spend :  0.6569468975067139
self.buckets_partition() spend  sec:  0.5333225727081299
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04848432540893555

in edges time spent  0.16192388534545898
local to global src and eids time spent  0.3175547122955322
time gen tails  0.08101153373718262
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15810203552246094

in edges time spent  0.775371789932251
local to global src and eids time spent  1.2470643520355225
time gen tails  0.21491718292236328
res  length 8
block collection to dataloader spend  1.71661376953125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07999992370605469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219357490539551  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219766139984131  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07569360733032227  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080435752868652  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.081561088562012  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396577835083008  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.093541622161865  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0965986251831055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956933975219727  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025947093963623  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026954650878906  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07958221435546875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02900505065918  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0300068855285645  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08701944351196289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2364678382873535  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238315582275391  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09425878524780273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24866247177124  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2520904541015625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0926661491394043  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899409770965576  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900879859924316  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0958256721496582  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3033453226089478
pure train time :  0.74700927734375
train time :  1.0802528858184814
end to end time :  7.0598108768463135
connection check time:  3.4503419399261475
block generation time  1.8557415008544922
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005431175231933594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015166997909545898
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5096781253814697
len local_batched_seeds_list  8
partition total batch output list spend :  0.7777376174926758
self.buckets_partition() spend  sec:  0.5248792171478271
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04707932472229004

in edges time spent  0.1791095733642578
local to global src and eids time spent  0.3198575973510742
time gen tails  0.07942318916320801
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15469789505004883

in edges time spent  0.8106164932250977
local to global src and eids time spent  1.2643506526947021
time gen tails  0.2224421501159668
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984066009521484  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221828460693359  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221560001373291  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07538604736328125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078976631164551  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080167293548584  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08406496047973633  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130456447601318  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.133513450622559  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960748672485352  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.01555871963501  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.016566276550293  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964134216308594  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0449113845825195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046003818511963  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08708906173706055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249342918395996  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251410484313965  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09413433074951172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248906135559082  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252334117889404  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09199094772338867  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871767520904541  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8736395835876465  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09684467315673828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2953357696533203
pure train time :  0.7397587299346924
train time :  1.068288803100586
end to end time :  7.231668472290039
connection check time:  3.532573699951172
block generation time  1.8383126258850098
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005040168762207031
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016160011291503906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5087859630584717
len local_batched_seeds_list  8
partition total batch output list spend :  0.7897903919219971
self.buckets_partition() spend  sec:  0.5249764919281006
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04438447952270508

in edges time spent  0.15555191040039062
local to global src and eids time spent  0.316744327545166
time gen tails  0.08032631874084473
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15570545196533203

in edges time spent  0.7689375877380371
local to global src and eids time spent  1.2472636699676514
time gen tails  0.21455717086791992
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08016109466552734  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.212143898010254  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211876392364502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0752725601196289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054139137268066  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.055781841278076  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08408308029174805  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.121588230133057  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.124645233154297  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07931756973266602  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036301136016846  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037308692932129  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795588493347168  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039938926696777  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040972709655762  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702707290649414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242918491363525  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244996070861816  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09374809265136719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.226966381072998  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23039436340332  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09206771850585938  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875906944274902  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877397060394287  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0959329605102539  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2897206544876099
pure train time :  0.7421083450317383
train time :  1.0567808151245117
end to end time :  7.128686428070068
connection check time:  3.428744316101074
block generation time  1.8367555141448975
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004889965057373047
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014712333679199219
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4627854824066162
len local_batched_seeds_list  8
partition total batch output list spend :  0.7313406467437744
self.buckets_partition() spend  sec:  0.47753334045410156
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04445219039916992

in edges time spent  0.15325260162353516
local to global src and eids time spent  0.320481538772583
time gen tails  0.08020234107971191
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15984058380126953

in edges time spent  0.7854936122894287
local to global src and eids time spent  1.2802934646606445
time gen tails  0.21392154693603516
res  length 8
block collection to dataloader spend  2.1219253540039062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983732223510742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213286876678467  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213587284088135  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07560539245605469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073115348815918  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075054168701172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08398199081420898  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.105339527130127  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.108396530151367  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07952690124511719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017804145812988  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0188117027282715  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07978534698486328  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.056056022644043  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057063579559326  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707571029663086  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241421222686768  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243346214294434  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0940709114074707  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231359004974365  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2347869873046875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09205913543701172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884050369262695  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8855204582214355  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09592151641845703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2888485193252563
pure train time :  0.7368996143341064
train time :  1.073376178741455
end to end time :  7.147137880325317
connection check time:  3.4892849922180176
block generation time  1.838233470916748
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.000598907470703125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014319896697998047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49666643142700195
len local_batched_seeds_list  8
partition total batch output list spend :  0.7820384502410889
self.buckets_partition() spend  sec:  0.5110211372375488
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0441434383392334

in edges time spent  0.15230631828308105
local to global src and eids time spent  0.31830573081970215
time gen tails  0.07860994338989258
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15441608428955078

in edges time spent  0.7506394386291504
local to global src and eids time spent  1.2352468967437744
time gen tails  0.21296358108520508
res  length 8
block collection to dataloader spend  1.7642974853515625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983160018920898  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.189270973205566  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.189679145812988  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07547140121459961  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071390151977539  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073266506195068  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08413887023925781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.129397392272949  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.132662296295166  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795431137084961  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020714282989502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021721839904785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07968473434448242  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04658317565918  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047616481781006  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870361328125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241287708282471  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243213653564453  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362077713012695  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238864898681641  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242292881011963  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09264326095581055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905466079711914  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906936168670654  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09579896926879883  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2875878810882568
pure train time :  0.7580113410949707
train time :  1.0800845623016357
end to end time :  7.110131502151489
connection check time:  3.3960068225860596
block generation time  1.8382813930511475
Run 00 | Epoch 00075 | Loss 1.2876 | Test 0.6151
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004851818084716797
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01501607894897461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48874831199645996
len local_batched_seeds_list  8
partition total batch output list spend :  0.765045166015625
self.buckets_partition() spend  sec:  0.5037992000579834
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046785831451416016

in edges time spent  0.16059303283691406
local to global src and eids time spent  0.3259420394897461
time gen tails  0.08032011985778809
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15694522857666016

in edges time spent  0.821627140045166
local to global src and eids time spent  1.2558634281158447
time gen tails  0.21605753898620605
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798344612121582  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215973377227783  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215704917907715  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554149627685547  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071558952331543  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072673320770264  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08399057388305664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.110738277435303  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1140031814575195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966375350952148  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026736259460449  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027743816375732  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967948913574219  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041711807250977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04271936416626  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702850341796875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246636390686035  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248551368713379  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09434366226196289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2205891609191895  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224017143249512  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0927271842956543  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90387487411499  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90568733215332  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09589242935180664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2843177318572998
pure train time :  0.6781666278839111
train time :  1.0511102676391602
end to end time :  7.197722434997559
connection check time:  3.513237476348877
block generation time  1.8517193794250488
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0006046295166015625
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015256166458129883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4919869899749756
len local_batched_seeds_list  8
partition total batch output list spend :  0.7759032249450684
self.buckets_partition() spend  sec:  0.507279634475708
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045618534088134766

in edges time spent  0.15739703178405762
local to global src and eids time spent  0.31638240814208984
time gen tails  0.08008551597595215
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15869808197021484

in edges time spent  0.8370928764343262
local to global src and eids time spent  1.2479541301727295
time gen tails  0.2159099578857422
res  length 8
block collection to dataloader spend  1.3113021850585938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08078241348266602  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2163543701171875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216085433959961  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07558488845825195  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076622486114502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077735424041748  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08417367935180664  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116857051849365  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1199140548706055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945394515991211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024491786956787  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02549934387207  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964038848876953  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045690536499023  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046713352203369  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704805374145508  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242519855499268  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244425296783447  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09405899047851562  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2389655113220215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242393493652344  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0925745964050293  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.870790004730225  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872842788696289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09610748291015625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2650132179260254
pure train time :  0.7609727382659912
train time :  1.083115816116333
end to end time :  7.230055332183838
connection check time:  3.508370876312256
block generation time  1.842475175857544
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004668235778808594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014632940292358398
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38030052185058594
len local_batched_seeds_list  8
partition total batch output list spend :  0.6588473320007324
self.buckets_partition() spend  sec:  0.3949623107910156
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04516291618347168

in edges time spent  0.1557323932647705
local to global src and eids time spent  0.332167387008667
time gen tails  0.07936859130859375
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16037392616271973

in edges time spent  0.7586071491241455
local to global src and eids time spent  1.2470927238464355
time gen tails  0.21596980094909668
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983207702636719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218446731567383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218856334686279  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07538747787475586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0754899978637695  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076602935791016  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08400964736938477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1160125732421875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.119069576263428  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947444915771484  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027318000793457  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02832555770874  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07962512969970703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035088539123535  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.03609561920166  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870370864868164  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244356155395508  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245947360992432  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09373092651367188  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224009990692139  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227437973022461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09196853637695312  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.882256507873535  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884262561798096  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09582996368408203  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.267698049545288
pure train time :  0.7451150417327881
train time :  1.0729620456695557
end to end time :  7.072810888290405
connection check time:  3.443866014480591
block generation time  1.8728876113891602
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004942417144775391
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014433860778808594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4827585220336914
len local_batched_seeds_list  8
partition total batch output list spend :  0.7626516819000244
self.buckets_partition() spend  sec:  0.49722766876220703
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046144723892211914

in edges time spent  0.15568065643310547
local to global src and eids time spent  0.2466127872467041
time gen tails  0.07959342002868652
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15816640853881836

in edges time spent  0.7702350616455078
local to global src and eids time spent  1.243021011352539
time gen tails  0.21290946006774902
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798330307006836  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215068817138672  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214799880981445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07565498352050781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073436737060547  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075375556945801  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404111862182617  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115664005279541  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.118721008300781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07937812805175781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.011833190917969  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0128302574157715  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965660095214844  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043698310852051  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044755458831787  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707427978515625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241819858551025  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243544578552246  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09388446807861328  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237152576446533  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240155220031738  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09167003631591797  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903157711029053  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905082702636719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09569263458251953  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2599033117294312
pure train time :  0.7544546127319336
train time :  1.0799329280853271
end to end time :  7.069232940673828
connection check time:  3.3647964000701904
block generation time  1.8392384052276611
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005342960357666016
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014295101165771484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46713900566101074
len local_batched_seeds_list  8
partition total batch output list spend :  0.6437089443206787
self.buckets_partition() spend  sec:  0.48146796226501465
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04410743713378906

in edges time spent  0.15375900268554688
local to global src and eids time spent  0.3095712661743164
time gen tails  0.07504582405090332
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15747547149658203

in edges time spent  0.7549147605895996
local to global src and eids time spent  1.2427570819854736
time gen tails  0.22102689743041992
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983589172363281  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214840412139893  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214571952819824  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07570743560791016  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0840654373168945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0852952003479  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402824401855469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112443447113037  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115500450134277  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796823501586914  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023771286010742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024778842926025  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966423034667969  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057850360870361  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.058857440948486  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08720541000366211  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.225808620452881  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227656364440918  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361028671264648  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206549644470215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.209977626800537  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09273719787597656  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9006829261779785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90250301361084  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0962228775024414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.251438021659851
pure train time :  0.744394063949585
train time :  1.076692819595337
end to end time :  7.02296781539917
connection check time:  3.446211576461792
block generation time  1.8417110443115234
Run 00 | Epoch 00080 | Loss 1.2514 | Test 0.6185
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048089027404785156
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016395092010498047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.482266902923584
len local_batched_seeds_list  8
partition total batch output list spend :  0.6169753074645996
self.buckets_partition() spend  sec:  0.4987304210662842
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04661989212036133

in edges time spent  0.15909123420715332
local to global src and eids time spent  0.3197495937347412
time gen tails  0.08844304084777832
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.157257080078125

in edges time spent  0.7742266654968262
local to global src and eids time spent  1.2501811981201172
time gen tails  0.21590781211853027
res  length 8
block collection to dataloader spend  1.8358230590820312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08017158508300781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217565536499023  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217297077178955  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.075042724609375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0492706298828125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050913333892822  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402872085571289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.102200031280518  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.105257034301758  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0797114372253418  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020941257476807  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02194881439209  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07946491241455078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036302089691162  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037344932556152  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702707290649414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247442245483398  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2492899894714355  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09257793426513672  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.168509006500244  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.171511650085449  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09220361709594727  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.913212776184082  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.914682865142822  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09625673294067383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2474933862686157
pure train time :  0.7479372024536133
train time :  1.093742847442627
end to end time :  7.050846099853516
connection check time:  3.465608596801758
block generation time  1.8563780784606934
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005087852478027344
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015946149826049805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5184938907623291
len local_batched_seeds_list  8
partition total batch output list spend :  0.7984147071838379
self.buckets_partition() spend  sec:  0.534475564956665
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04657340049743652

in edges time spent  0.15592145919799805
local to global src and eids time spent  0.31981968879699707
time gen tails  0.08005261421203613
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1593310832977295

in edges time spent  0.779167652130127
local to global src and eids time spent  1.236654281616211
time gen tails  0.21451997756958008
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798349380493164  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.191247940063477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.191655158996582  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07570505142211914  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0723371505737305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073459148406982  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08410215377807617  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.106081962585449  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1091389656066895  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0794992446899414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.028119087219238  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0291266441345215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07979011535644531  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048878192901611  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0498857498168945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702850341796875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233685493469238  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235611438751221  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362316131591797  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232557773590088  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23598575592041  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0921473503112793  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.882169246673584  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884035110473633  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09639263153076172  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2424652576446533
pure train time :  0.76487135887146
train time :  1.1150264739990234
end to end time :  7.2139716148376465
connection check time:  3.439209461212158
block generation time  1.8449456691741943
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004811286926269531
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015703439712524414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47332191467285156
len local_batched_seeds_list  8
partition total batch output list spend :  0.753995418548584
self.buckets_partition() spend  sec:  0.48905372619628906
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.05190634727478027

in edges time spent  0.16268467903137207
local to global src and eids time spent  0.3291027545928955
time gen tails  0.08458495140075684
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16466116905212402

in edges time spent  0.8236484527587891
local to global src and eids time spent  1.3198559284210205
time gen tails  0.21909213066101074
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984495162963867  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220179080963135  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219911098480225  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07538080215454102  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0732011795043945  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075237274169922  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08414220809936523  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109225749969482  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112282752990723  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07949304580688477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020480632781982  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021488189697266  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984733581542969  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0563154220581055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057322978973389  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707427978515625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242359638214111  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244207382202148  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09360551834106445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.194726467132568  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.198154449462891  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09218835830688477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.897185802459717  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899226188659668  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0960545539855957  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2366085052490234
pure train time :  0.709768533706665
train time :  1.0505685806274414
end to end time :  7.307739734649658
connection check time:  3.608708143234253
block generation time  1.8704679012298584
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005991458892822266
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014611005783081055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5025620460510254
len local_batched_seeds_list  8
partition total batch output list spend :  0.7829380035400391
self.buckets_partition() spend  sec:  0.5172145366668701
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04889845848083496

in edges time spent  0.15747356414794922
local to global src and eids time spent  0.23501944541931152
time gen tails  0.06800556182861328
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15746593475341797

in edges time spent  0.7887601852416992
local to global src and eids time spent  1.2591910362243652
time gen tails  0.21801400184631348
res  length 8
block collection to dataloader spend  2.3365020751953125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07982873916625977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.185295104980469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.185026168823242  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07552051544189453  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074319362640381  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075549125671387  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08417892456054688  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.118524074554443  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.121581077575684  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964897155761719  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.059385776519775  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.060378551483154  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965469360351562  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04815673828125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049637317657471  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08751249313354492  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245532035827637  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247012615203857  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09380102157592773  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241636753082275  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245064735412598  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09263944625854492  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8838791847229  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.88594913482666  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09646940231323242  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2299230098724365
pure train time :  0.6592369079589844
train time :  1.0193121433258057
end to end time :  7.087812900543213
connection check time:  3.4200119972229004
block generation time  1.849123239517212
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005991458892822266
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013965606689453125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48182082176208496
len local_batched_seeds_list  8
partition total batch output list spend :  0.7433409690856934
self.buckets_partition() spend  sec:  0.49582743644714355
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04462170600891113

in edges time spent  0.1450328826904297
local to global src and eids time spent  0.3166635036468506
time gen tails  0.07867860794067383
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15424799919128418

in edges time spent  0.75620436668396
local to global src and eids time spent  1.2400977611541748
time gen tails  0.21316170692443848
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052587509155273  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.209018707275391  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2087507247924805  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07530832290649414  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.086731910705566  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.088212490081787  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08408164978027344  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.090052604675293  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.093272686004639  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0797572135925293  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013918876647949  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014926433563232  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07962894439697266  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047959327697754  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048966884613037  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703804016113281  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249934196472168  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251847743988037  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09405040740966797  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.194618225097656  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1980462074279785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09195280075073242  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872408866882324  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8743414878845215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09620523452758789  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2278010845184326
pure train time :  0.6709156036376953
train time :  1.0332942008972168
end to end time :  7.0388407707214355
connection check time:  3.3947196006774902
block generation time  1.8542189598083496
Run 00 | Epoch 00085 | Loss 1.2278 | Test 0.6203
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00036454200744628906
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018086910247802734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.21120357513427734
len local_batched_seeds_list  8
partition total batch output list spend :  0.30303955078125
self.buckets_partition() spend  sec:  0.22931146621704102
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.029467344284057617

in edges time spent  0.0914144515991211
local to global src and eids time spent  0.11661100387573242
time gen tails  0.04863452911376953
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10633301734924316

in edges time spent  0.45001888275146484
local to global src and eids time spent  0.5146539211273193
time gen tails  0.1307055950164795
res  length 8
block collection to dataloader spend  1.0013580322265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023548126220703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.212622165679932  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.212353706359863  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07535791397094727  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071007251739502  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072883605957031  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0841522216796875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12455940246582  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1276164054870605  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07971906661987305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.056357383728027  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0573554039001465  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07986164093017578  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.064235687255859  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06571626663208  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702564239501953  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2454447746276855  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247550964355469  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361028671264648  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.202627658843994  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206055641174316  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09192228317260742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.87585973739624  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8773298263549805  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09577703475952148  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2238160371780396
pure train time :  0.6564583778381348
train time :  0.9870305061340332
end to end time :  4.31290864944458
connection check time:  1.683750867843628
block generation time  1.3259971141815186
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00039839744567871094
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014792442321777344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.20400357246398926
len local_batched_seeds_list  8
partition total batch output list spend :  0.37467241287231445
self.buckets_partition() spend  sec:  0.21882247924804688
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.05109834671020508

in edges time spent  0.1623382568359375
local to global src and eids time spent  0.3234694004058838
time gen tails  0.07970976829528809
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15761446952819824

in edges time spent  0.7659952640533447
local to global src and eids time spent  1.2362902164459229
time gen tails  0.21296405792236328
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983732223510742  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213841915130615  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213573455810547  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07519960403442383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054601669311523  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.056244373321533  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08416223526000977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116354465484619  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.119411468505859  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07939624786376953  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024917125701904  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0259246826171875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983970642089844  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0543670654296875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.055459499359131  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08709430694580078  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239309787750244  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241215705871582  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09404706954956055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.225827693939209  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.229255676269531  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09263181686401367  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.876152992248535  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.878134250640869  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09578657150268555  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.219515085220337
pure train time :  0.7781412601470947
train time :  1.105431318283081
end to end time :  6.758904457092285
connection check time:  3.436641216278076
block generation time  1.8324532508850098
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004987716674804688
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014232158660888672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49916982650756836
len local_batched_seeds_list  8
partition total batch output list spend :  0.7817273139953613
self.buckets_partition() spend  sec:  0.5134341716766357
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044660091400146484

in edges time spent  0.1327190399169922
local to global src and eids time spent  0.3156132698059082
time gen tails  0.07861900329589844
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1547539234161377

in edges time spent  0.7519338130950928
local to global src and eids time spent  1.2329728603363037
time gen tails  0.2125704288482666
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983827590942383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214070796966553  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213802337646484  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07518720626831055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075611114501953  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076840877532959  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0841970443725586  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.131069660186768  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.134126663208008  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947015762329102  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.01629638671875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017303943634033  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07957315444946289  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041591644287109  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042603015899658  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703804016113281  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241997718811035  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243915557861328  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09404706954956055  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.18785285949707  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.190855503082275  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09177684783935547  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901936054229736  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903406143188477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09582281112670898  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2097982168197632
pure train time :  0.7318270206451416
train time :  1.0956737995147705
end to end time :  7.091644287109375
connection check time:  3.370731830596924
block generation time  1.8293180465698242
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004973411560058594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014113664627075195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5182204246520996
len local_batched_seeds_list  8
partition total batch output list spend :  0.8004746437072754
self.buckets_partition() spend  sec:  0.5323748588562012
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04447317123413086

in edges time spent  0.15695643424987793
local to global src and eids time spent  0.3228583335876465
time gen tails  0.07891988754272461
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15723967552185059

in edges time spent  0.7542459964752197
local to global src and eids time spent  1.2412736415863037
time gen tails  0.21208405494689941
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983541488647461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214222431182861  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213953971862793  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07556867599487305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073472499847412  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075439453125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08400964736938477  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.104485511779785  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.107750415802002  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07950830459594727  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0565924644470215  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057600021362305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966852188110352  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043715476989746  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044723033905029  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702611923217773  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233012676239014  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234860420227051  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361553192138672  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.226246356964111  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.22878360748291  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09177875518798828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.869297504425049  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871033668518066  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09635543823242188  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.207077145576477
pure train time :  0.7185847759246826
train time :  1.0426414012908936
end to end time :  7.1203837394714355
connection check time:  3.416090726852417
block generation time  1.8395535945892334
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005674362182617188
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015798330307006836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5002644062042236
len local_batched_seeds_list  8
partition total batch output list spend :  0.7865917682647705
self.buckets_partition() spend  sec:  0.5160953998565674
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04983186721801758

in edges time spent  0.16917157173156738
local to global src and eids time spent  0.3423464298248291
time gen tails  0.08680057525634766
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1556687355041504

in edges time spent  0.8249697685241699
local to global src and eids time spent  1.2535436153411865
time gen tails  0.21937274932861328
res  length 8
block collection to dataloader spend  1.9073486328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008909225463867  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211780548095703  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211512565612793  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0755462646484375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077394008636475  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078510284423828  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397197723388672  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.095602035522461  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.098659038543701  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984638214111328  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.059026718139648  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.060034275054932  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07975053787231445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048084259033203  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049088954925537  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08724689483642578  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242644786834717  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244492530822754  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361457824707031  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243141174316406  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2465691566467285  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09187173843383789  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871917247772217  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873783111572266  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09677839279174805  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2047533988952637
pure train time :  0.7520396709442139
train time :  1.0893840789794922
end to end time :  7.31549596786499
connection check time:  3.575678586959839
block generation time  1.842714548110962
Run 00 | Epoch 00090 | Loss 1.2048 | Test 0.6181
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005121231079101562
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015129804611206055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5325822830200195
len local_batched_seeds_list  8
partition total batch output list spend :  0.8153433799743652
self.buckets_partition() spend  sec:  0.5477497577667236
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046103715896606445

in edges time spent  0.1614363193511963
local to global src and eids time spent  0.3307626247406006
time gen tails  0.07992315292358398
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1583695411682129

in edges time spent  0.799166202545166
local to global src and eids time spent  1.273409366607666
time gen tails  0.21926474571228027
res  length 8
block collection to dataloader spend  2.574920654296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08020877838134766  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.207041263580322  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.20677375793457  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07553291320800781  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07547664642334  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076706409454346  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08417177200317383  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12420129776001  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12725830078125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07940149307250977  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026883125305176  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027890682220459  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07975053787231445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0505452156066895  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051552772521973  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702850341796875  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232137203216553  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234289169311523  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362220764160156  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.228142261505127  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231144905090332  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0919184684753418  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9109601974487305  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.912430286407471  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09596920013427734  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2022254467010498
pure train time :  0.724947452545166
train time :  1.059030532836914
end to end time :  7.28828501701355
connection check time:  3.532046318054199
block generation time  1.8633735179901123
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005571842193603516
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01485753059387207
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5458087921142578
len local_batched_seeds_list  8
partition total batch output list spend :  0.6779477596282959
self.buckets_partition() spend  sec:  0.5607037544250488
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04525136947631836

in edges time spent  0.15722894668579102
local to global src and eids time spent  0.31671738624572754
time gen tails  0.07977604866027832
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15619230270385742

in edges time spent  0.6918888092041016
local to global src and eids time spent  1.2282710075378418
time gen tails  0.2121574878692627
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.079833984375  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.191585540771484  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.191316604614258  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07539939880371094  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073012351989746  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074242115020752  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402252197265625  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.097368240356445  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1004252433776855  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07943153381347656  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.018178939819336  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.019186496734619  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07944679260253906  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034754753112793  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035775661468506  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704376220703125  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2456746101379395  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247739791870117  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362220764160156  GigaBytes
Max Memory Allocated: 5.374323844909668  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.257412433624268  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.26084041595459  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09270763397216797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871445655822754  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873498439788818  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09647893905639648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1958270072937012
pure train time :  0.6570088863372803
train time :  1.0222389698028564
end to end time :  6.878171920776367
connection check time:  3.3309733867645264
block generation time  1.829563856124878
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004901885986328125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014548540115356445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4014127254486084
len local_batched_seeds_list  8
partition total batch output list spend :  0.6827704906463623
self.buckets_partition() spend  sec:  0.41599178314208984
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04520893096923828

in edges time spent  0.15529966354370117
local to global src and eids time spent  0.31791043281555176
time gen tails  0.07905983924865723
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1561594009399414

in edges time spent  0.7296984195709229
local to global src and eids time spent  1.2306902408599854
time gen tails  0.2133774757385254
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08017492294311523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214446544647217  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214178085327148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07517576217651367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073802947998047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074984550476074  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08401012420654297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.114005088806152  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.117062091827393  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798196792602539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0175347328186035  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.018542289733887  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967853546142578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047231674194336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048239231109619  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0876765251159668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234480381011963  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235960960388184  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09413528442382812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233793258666992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236795902252197  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09168624877929688  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873739242553711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875209331512451  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09571981430053711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.193335771560669
pure train time :  0.7233409881591797
train time :  1.0477590560913086
end to end time :  6.950207948684692
connection check time:  3.372328996658325
block generation time  1.8322563171386719
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004773139953613281
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014360666275024414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48333096504211426
len local_batched_seeds_list  8
partition total batch output list spend :  0.7638592720031738
self.buckets_partition() spend  sec:  0.4977242946624756
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0435636043548584

in edges time spent  0.14979863166809082
local to global src and eids time spent  0.15671563148498535
time gen tails  0.06137347221374512
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16076898574829102

in edges time spent  0.7210335731506348
local to global src and eids time spent  1.065436840057373
time gen tails  0.1764993667602539
res  length 8
block collection to dataloader spend  1.3113021850585938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798335075378418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211612701416016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211344242095947  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07573413848876953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074991703033447  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076228618621826  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0841217041015625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.094009876251221  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.097428321838379  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965278625488281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014271259307861  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0152788162231445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07959413528442383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04879903793335  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049806594848633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703899383544922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241650581359863  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243733882904053  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09375667572021484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.226605415344238  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2300333976745605  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09272432327270508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871980667114258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873777866363525  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09614229202270508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1893056631088257
pure train time :  0.7460088729858398
train time :  1.0715606212615967
end to end time :  6.701008319854736
connection check time:  2.991267204284668
block generation time  1.856273889541626
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005438327789306641
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015033960342407227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.492480993270874
len local_batched_seeds_list  8
partition total batch output list spend :  0.7813043594360352
self.buckets_partition() spend  sec:  0.507549524307251
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.047402143478393555

in edges time spent  0.1666398048400879
local to global src and eids time spent  0.3425590991973877
time gen tails  0.08449268341064453
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15753698348999023

in edges time spent  0.7874372005462646
local to global src and eids time spent  1.273618221282959
time gen tails  0.21553802490234375
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0800929069519043  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218890190124512  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219298839569092  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07550477981567383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075051784515381  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076281547546387  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08406829833984375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111448764801025  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.114505767822266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07935953140258789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02118444442749  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022192001342773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967042922973633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046533584594727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04754114151001  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706140518188477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232851505279541  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2349853515625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363126754760742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237663745880127  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241091728210449  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09198665618896484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901569843292236  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903622627258301  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09635448455810547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1853004693984985
pure train time :  0.6390409469604492
train time :  1.0194127559661865
end to end time :  7.184757471084595
connection check time:  3.525165319442749
block generation time  1.8430919647216797
Run 00 | Epoch 00095 | Loss 1.1853 | Test 0.6230
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004532337188720703
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014776468276977539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4880833625793457
len local_batched_seeds_list  8
partition total batch output list spend :  0.7643632888793945
self.buckets_partition() spend  sec:  0.5028908252716064
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044408321380615234

in edges time spent  0.1566634178161621
local to global src and eids time spent  0.3176460266113281
time gen tails  0.07988405227661133
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15386581420898438

in edges time spent  0.7966351509094238
local to global src and eids time spent  1.2369718551635742
time gen tails  0.21976375579833984
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08034420013427734  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213541030883789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213311672210693  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07544183731079102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076465129852295  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078505516052246  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397865295410156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.084688663482666  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.087896823883057  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07973623275756836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032035827636719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033043384552002  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07968282699584961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048380374908447  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0493879318237305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08761787414550781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247862815856934  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249454975128174  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09387969970703125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.228024005889893  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231026649475098  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09184074401855469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901491165161133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902961254119873  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0958714485168457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1824102401733398
pure train time :  0.7352557182312012
train time :  1.0729455947875977
end to end time :  7.173486948013306
connection check time:  3.467651605606079
block generation time  1.8542349338531494
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.000537872314453125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016135454177856445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5083019733428955
len local_batched_seeds_list  8
partition total batch output list spend :  0.7889342308044434
self.buckets_partition() spend  sec:  0.524470329284668
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04572033882141113

in edges time spent  0.1570131778717041
local to global src and eids time spent  0.3256819248199463
time gen tails  0.07981371879577637
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15706944465637207

in edges time spent  0.8316600322723389
local to global src and eids time spent  1.2680511474609375
time gen tails  0.22107958793640137
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052682876586914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206616401672363  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206347465515137  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07533121109008789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0735321044921875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074761867523193  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08400821685791016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1199469566345215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.123003959655762  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964086532592773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.061707496643066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06271505355835  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07955217361450195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041031360626221  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042511940002441  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0871114730834961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23844575881958  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240350246429443  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0939788818359375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.191835403442383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.195263385772705  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09267902374267578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.912113666534424  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.913583755493164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09584522247314453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1770737171173096
pure train time :  0.7359344959259033
train time :  1.0648515224456787
end to end time :  7.270501375198364
connection check time:  3.5440022945404053
block generation time  1.8495049476623535
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048089027404785156
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015191793441772461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4893066883087158
len local_batched_seeds_list  8
partition total batch output list spend :  0.7690174579620361
self.buckets_partition() spend  sec:  0.5045289993286133
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04484748840332031

in edges time spent  0.15436339378356934
local to global src and eids time spent  0.3279139995574951
time gen tails  0.07977914810180664
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15746355056762695

in edges time spent  0.7862076759338379
local to global src and eids time spent  1.240830898284912
time gen tails  0.21319317817687988
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983589172363281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214618682861328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214349269866943  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07561254501342773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072706699371338  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073822021484375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08401632308959961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109614372253418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112879276275635  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07946062088012695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014518737792969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0155110359191895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956695556640625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032799243927002  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033860206604004  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707714080810547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237381935119629  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2395477294921875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0936121940612793  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.194472312927246  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.197900295257568  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09281444549560547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902017116546631  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904069900512695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0959920883178711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1729190349578857
pure train time :  0.737191915512085
train time :  1.0632262229919434
end to end time :  7.13873815536499
connection check time:  3.4516854286193848
block generation time  1.8348515033721924
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004603862762451172
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01411294937133789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4608943462371826
len local_batched_seeds_list  8
partition total batch output list spend :  0.7357978820800781
self.buckets_partition() spend  sec:  0.4750406742095947
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.043940067291259766

in edges time spent  0.15279173851013184
local to global src and eids time spent  0.317518949508667
time gen tails  0.07929062843322754
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15854215621948242

in edges time spent  0.7555158138275146
local to global src and eids time spent  1.2391316890716553
time gen tails  0.2127676010131836
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983541488647461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.223448276519775  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.223178863525391  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07525873184204102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070853233337402  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072513580322266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839681625366211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111030578613281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1140875816345215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07970428466796875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.031189441680908  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032191276550293  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07943916320800781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041491508483887  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0424933433532715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08720016479492188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251324653625488  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252927303314209  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09370565414428711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235658168792725  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238652229309082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09200477600097656  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.870952606201172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872442722320557  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09647893905639648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1739195585250854
pure train time :  0.7238202095031738
train time :  1.0453553199768066
end to end time :  7.044597864151001
connection check time:  3.4070937633514404
block generation time  1.8372883796691895
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005497932434082031
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01425790786743164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4955270290374756
len local_batched_seeds_list  8
partition total batch output list spend :  0.7832140922546387
self.buckets_partition() spend  sec:  0.5098199844360352
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04440951347351074

in edges time spent  0.15420126914978027
local to global src and eids time spent  0.31924986839294434
time gen tails  0.07933473587036133
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15701031684875488

in edges time spent  0.7658953666687012
local to global src and eids time spent  1.2358448505401611
time gen tails  0.21395397186279297
res  length 8
block collection to dataloader spend  2.0503997802734375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983064651489258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.184262752532959  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.183995246887207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07558012008666992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.062605381011963  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.064544200897217  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397102355957031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109130382537842  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112187385559082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07958126068115234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026527404785156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027534008026123  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0797724723815918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0543975830078125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.055404186248779  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870504379272461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237794399261475  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239700794219971  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09404611587524414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231573581695557  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235001564025879  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09273958206176758  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875389099121094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877697467803955  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09628915786743164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.165368676185608
pure train time :  0.7309341430664062
train time :  1.0612807273864746
end to end time :  7.140918970108032
connection check time:  3.423189640045166
block generation time  1.851731777191162
Run 00 | Epoch 00100 | Loss 1.1654 | Test 0.6262
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004932880401611328
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016007661819458008
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5198221206665039
len local_batched_seeds_list  8
partition total batch output list spend :  0.6561751365661621
self.buckets_partition() spend  sec:  0.5358641147613525
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.047266244888305664

in edges time spent  0.16494131088256836
local to global src and eids time spent  0.31778526306152344
time gen tails  0.08244490623474121
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1608266830444336

in edges time spent  0.8136439323425293
local to global src and eids time spent  1.248727560043335
time gen tails  0.21771764755249023
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023738861083984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2172770500183105  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217008590698242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07526445388793945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069267272949219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070388317108154  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08400249481201172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113828659057617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116885662078857  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984542846679688  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026561737060547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02756929397583  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07970905303955078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044637680053711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045751571655273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08729076385498047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236210823059082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238058567047119  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09360742568969727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2278151512146  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231243133544922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09290933609008789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.879732131958008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.881202220916748  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09646463394165039  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1636875867843628
pure train time :  0.7460141181945801
train time :  1.0834529399871826
end to end time :  7.122135639190674
connection check time:  3.499006509780884
block generation time  1.8680858612060547
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005376338958740234
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014699935913085938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4972970485687256
len local_batched_seeds_list  8
partition total batch output list spend :  0.7859795093536377
self.buckets_partition() spend  sec:  0.512030839920044
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.05243825912475586

in edges time spent  0.16392040252685547
local to global src and eids time spent  0.2987332344055176
time gen tails  0.06904125213623047
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15774178504943848

in edges time spent  0.8003637790679932
local to global src and eids time spent  1.2461421489715576
time gen tails  0.21761345863342285
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023405075073242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.205611228942871  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.20630407333374  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554388046264648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0742268562316895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075457572937012  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0848541259765625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.098307132720947  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1013641357421875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07985162734985352  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032042980194092  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033050537109375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07979679107666016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043784141540527  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0447916984558105  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08720159530639648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233529090881348  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23544979095459  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09406185150146484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2343950271606445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237823009490967  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09270334243774414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899955749511719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901768207550049  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09613180160522461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1656020879745483
pure train time :  0.7259995937347412
train time :  1.0510411262512207
end to end time :  7.206965684890747
connection check time:  3.4668564796447754
block generation time  1.8884775638580322
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048422813415527344
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014545917510986328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48419737815856934
len local_batched_seeds_list  8
partition total batch output list spend :  0.7645394802093506
self.buckets_partition() spend  sec:  0.4987759590148926
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04623770713806152

in edges time spent  0.15720176696777344
local to global src and eids time spent  0.3165125846862793
time gen tails  0.08326244354248047
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1581416130065918

in edges time spent  0.8023567199707031
local to global src and eids time spent  1.26800537109375
time gen tails  0.21962618827819824
res  length 8
block collection to dataloader spend  2.5987625122070312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0800938606262207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.210497856140137  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211185932159424  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07548284530639648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071689128875732  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072918891906738  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0842142105102539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.128815650939941  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.131872653961182  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07969331741333008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022995471954346  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024003028869629  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07942724227905273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0246663093566895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025696277618408  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702611923217773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239262580871582  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241110324859619  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09375238418579102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241546630859375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244974613189697  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09256839752197266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871371746063232  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.87330436706543  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09680986404418945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.162651538848877
pure train time :  0.7282111644744873
train time :  1.0631287097930908
end to end time :  7.221373558044434
connection check time:  3.515141725540161
block generation time  1.858860969543457
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004820823669433594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014411211013793945
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49410510063171387
len local_batched_seeds_list  8
partition total batch output list spend :  0.7426433563232422
self.buckets_partition() spend  sec:  0.5085554122924805
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04195761680603027

in edges time spent  0.1531202793121338
local to global src and eids time spent  0.3211231231689453
time gen tails  0.07986164093017578
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15566277503967285

in edges time spent  0.7626173496246338
local to global src and eids time spent  1.235454797744751
time gen tails  0.21330928802490234
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023309707641602  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206063270568848  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.205795764923096  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07557964324951172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076966762542725  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0781965255737305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404874801635742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.106856822967529  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1099138259887695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964229583740234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0234856605529785  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024492263793945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07950639724731445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.031049728393555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0320563316345215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704137802124023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244140625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246068954467773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09431171417236328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2416510581970215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244554042816162  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09217596054077148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90217924118042  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904232025146484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0960993766784668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1612869501113892
pure train time :  0.7319896221160889
train time :  1.0604627132415771
end to end time :  7.073643445968628
connection check time:  3.407013416290283
block generation time  1.8431053161621094
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0006091594696044922
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01454472541809082
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47646164894104004
len local_batched_seeds_list  8
partition total batch output list spend :  0.7631444931030273
self.buckets_partition() spend  sec:  0.4910426139831543
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04623842239379883

in edges time spent  0.154221773147583
local to global src and eids time spent  0.3205077648162842
time gen tails  0.07950901985168457
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15690898895263672

in edges time spent  0.7849574089050293
local to global src and eids time spent  1.2442851066589355
time gen tails  0.2224886417388916
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08017683029174805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221341609954834  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221073150634766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07531929016113281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070388317108154  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072264671325684  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396625518798828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0971832275390625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.100240230560303  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960081100463867  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023623466491699  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024631023406982  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796351432800293  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036443710327148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037451267242432  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703327178955078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24562931060791  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247530460357666  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09404277801513672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227495193481445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.230923175811768  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09218168258666992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875900745391846  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877370834350586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09645700454711914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1601210832595825
pure train time :  0.7445755004882812
train time :  1.0768706798553467
end to end time :  7.194320201873779
connection check time:  3.47108793258667
block generation time  1.8680531978607178
Run 00 | Epoch 00105 | Loss 1.1601 | Test 0.6262
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004818439483642578
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01610398292541504
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4942169189453125
len local_batched_seeds_list  8
partition total batch output list spend :  0.7696022987365723
self.buckets_partition() spend  sec:  0.5103559494018555
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04705452919006348

in edges time spent  0.16260433197021484
local to global src and eids time spent  0.33132004737854004
time gen tails  0.08174729347229004
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15702223777770996

in edges time spent  0.7993245124816895
local to global src and eids time spent  1.2486732006072998
time gen tails  0.2158064842224121
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984018325805664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221410751342773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221142768859863  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07536077499389648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071845054626465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072957992553711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08409929275512695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120008945465088  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.123065948486328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961606979370117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025209426879883  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026216983795166  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795888900756836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041854381561279  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042853832244873  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703184127807617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247427463531494  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249030113220215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09374141693115234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211967468261719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215395450592041  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.092742919921875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898744583129883  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900214672088623  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09606552124023438  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1551190614700317
pure train time :  0.752694845199585
train time :  1.0922539234161377
end to end time :  7.240130424499512
connection check time:  3.495849370956421
block generation time  1.8610668182373047
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005865097045898438
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015174388885498047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5120370388031006
len local_batched_seeds_list  8
partition total batch output list spend :  0.7937166690826416
self.buckets_partition() spend  sec:  0.527249813079834
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04411649703979492

in edges time spent  0.1582798957824707
local to global src and eids time spent  0.3197784423828125
time gen tails  0.07994723320007324
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15566611289978027

in edges time spent  0.8293421268463135
local to global src and eids time spent  1.2847681045532227
time gen tails  0.22604680061340332
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07998800277709961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.175564765930176  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.175936698913574  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07535457611083984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080440044403076  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.082432746887207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08424186706542969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1215434074401855  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.124600410461426  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07948017120361328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017505168914795  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.018512725830078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967615127563477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04183292388916  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042840480804443  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705329895019531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.22503137588501  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227165222167969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363222122192383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2362189292907715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239646911621094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09287452697753906  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901063919067383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90286111831665  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09630012512207031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.155000925064087
pure train time :  0.7146010398864746
train time :  1.0493879318237305
end to end time :  7.27275824546814
connection check time:  3.5592610836029053
block generation time  1.8518896102905273
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005099773406982422
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015090465545654297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.42980456352233887
len local_batched_seeds_list  8
partition total batch output list spend :  0.5562105178833008
self.buckets_partition() spend  sec:  0.4449300765991211
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.02870631217956543

in edges time spent  0.09405732154846191
local to global src and eids time spent  0.2648203372955322
time gen tails  0.08772921562194824
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1624152660369873

in edges time spent  0.7878711223602295
local to global src and eids time spent  1.2755234241485596
time gen tails  0.22030901908874512
res  length 8
block collection to dataloader spend  1.7404556274414062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08009862899780273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216975688934326  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2176127433776855  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07544469833374023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069245338439941  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070387840270996  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08398056030273438  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.094404697418213  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.097461700439453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07977437973022461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023780822753906  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0247802734375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07950639724731445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041444778442383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042455196380615  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870370864868164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251828670501709  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253731727600098  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09404993057250977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231274127960205  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234702110290527  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09236574172973633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.914328575134277  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.916366100311279  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0959782600402832  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1520438194274902
pure train time :  0.7339375019073486
train time :  1.0692510604858398
end to end time :  6.911097526550293
connection check time:  3.3736464977264404
block generation time  1.8826661109924316
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004961490631103516
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014551162719726562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5263173580169678
len local_batched_seeds_list  8
partition total batch output list spend :  0.805889368057251
self.buckets_partition() spend  sec:  0.5409071445465088
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04460597038269043

in edges time spent  0.15709257125854492
local to global src and eids time spent  0.3202826976776123
time gen tails  0.08071064949035645
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16181182861328125

in edges time spent  0.7571678161621094
local to global src and eids time spent  1.2807133197784424
time gen tails  0.2297964096069336
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08078336715698242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216395854949951  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216125965118408  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07527542114257812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.053478240966797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.055120944976807  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839991569519043  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1068220138549805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109879016876221  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07958698272705078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.028186321258545  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.029193878173828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08013248443603516  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0356268882751465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036629676818848  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703231811523438  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247687816619873  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24931526184082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09376859664916992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218315601348877  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221743583679199  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09278726577758789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.909153461456299  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.911050796508789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09620904922485352  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.15059494972229
pure train time :  0.8067340850830078
train time :  1.1368000507354736
end to end time :  7.393795013427734
connection check time:  3.5090155601501465
block generation time  1.9271907806396484
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005631446838378906
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015344619750976562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5058987140655518
len local_batched_seeds_list  8
partition total batch output list spend :  0.7873995304107666
self.buckets_partition() spend  sec:  0.521277904510498
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04681253433227539

in edges time spent  0.16132497787475586
local to global src and eids time spent  0.350938081741333
time gen tails  0.08125805854797363
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1615123748779297

in edges time spent  0.7795567512512207
local to global src and eids time spent  1.2616558074951172
time gen tails  0.22138404846191406
res  length 8
block collection to dataloader spend  2.0265579223632812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008813858032227  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2172064781188965  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216937065124512  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554960250854492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0677714347839355  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0697102546691895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08476066589355469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.110537052154541  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113594055175781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945442199707031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021846294403076  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022853851318359  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07969284057617188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048206329345703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049208164215088  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870676040649414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2454047203063965  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247140884399414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09388256072998047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.228331089019775  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231759071350098  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09236907958984375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902000904083252  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903942108154297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09631776809692383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1499996185302734
pure train time :  0.7528188228607178
train time :  1.0905773639678955
end to end time :  7.285320043563843
connection check time:  3.522446870803833
block generation time  1.867095947265625
Run 00 | Epoch 00110 | Loss 1.1500 | Test 0.6259
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00037479400634765625
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015604734420776367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41953444480895996
len local_batched_seeds_list  8
partition total batch output list spend :  0.5091691017150879
self.buckets_partition() spend  sec:  0.435166597366333
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.03158116340637207

in edges time spent  0.09438014030456543
local to global src and eids time spent  0.11800479888916016
time gen tails  0.04956197738647461
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10617470741271973

in edges time spent  0.8095405101776123
local to global src and eids time spent  1.2520556449890137
time gen tails  0.21609163284301758
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08020830154418945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.223502159118652  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224183559417725  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554149627685547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073156356811523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075095176696777  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08416509628295898  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.125380992889404  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1284379959106445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07958507537841797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025082111358643  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026088714599609  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961511611938477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043656826019287  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044663429260254  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702802658081055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233343124389648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235494136810303  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0936284065246582  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.230026721954346  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233454704284668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09246206283569336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.862534999847412  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.864400863647461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0966949462890625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.147865891456604
pure train time :  0.7469587326049805
train time :  1.0906383991241455
end to end time :  6.430808067321777
connection check time:  3.053839683532715
block generation time  1.7609519958496094
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005962848663330078
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014226198196411133
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4526679515838623
len local_batched_seeds_list  8
partition total batch output list spend :  0.5819847583770752
self.buckets_partition() spend  sec:  0.46692919731140137
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.03912806510925293

in edges time spent  0.1458601951599121
local to global src and eids time spent  0.3197510242462158
time gen tails  0.08291316032409668
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1590290069580078

in edges time spent  0.7710444927215576
local to global src and eids time spent  1.2526741027832031
time gen tails  0.22466039657592773
res  length 8
block collection to dataloader spend  1.5497207641601562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0802164077758789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.209214210510254  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.208946704864502  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0755305290222168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079097747802734  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.08032751083374  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08414888381958008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.125300884246826  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.128357887268066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956123352050781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043808460235596  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044816017150879  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795135498046875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033544063568115  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0345458984375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702754974365234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240507125854492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242354869842529  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362649917602539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244450569152832  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247878551483154  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09213542938232422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8769850730896  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.878801345825195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09650993347167969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1464555263519287
pure train time :  0.7591681480407715
train time :  1.0824074745178223
end to end time :  6.999868392944336
connection check time:  3.4470882415771484
block generation time  1.874030590057373
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005080699920654297
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015297889709472656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5078675746917725
len local_batched_seeds_list  8
partition total batch output list spend :  0.7880876064300537
self.buckets_partition() spend  sec:  0.5231995582580566
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045410871505737305

in edges time spent  0.15724921226501465
local to global src and eids time spent  0.3174710273742676
time gen tails  0.08320760726928711
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1586298942565918

in edges time spent  0.7800607681274414
local to global src and eids time spent  1.236283302307129
time gen tails  0.2151641845703125
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08013057708740234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215152740478516  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2148847579956055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07537317276000977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.066137790679932  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.067282199859619  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396768569946289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071234226226807  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074490070343018  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961845397949219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022660255432129  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023667812347412  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961702346801758  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044234752655029  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0452423095703125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702564239501953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2318220138549805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233962059020996  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363126754760742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2466230392456055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250051021575928  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09228372573852539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873359680175781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.87522554397583  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09586668014526367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.145753264427185
pure train time :  0.7339050769805908
train time :  1.0600059032440186
end to end time :  7.1820313930511475
connection check time:  3.4464032649993896
block generation time  1.8721864223480225
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004737377166748047
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014092206954956055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46055054664611816
len local_batched_seeds_list  8
partition total batch output list spend :  0.7344753742218018
self.buckets_partition() spend  sec:  0.47467589378356934
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04664468765258789

in edges time spent  0.15379643440246582
local to global src and eids time spent  0.2453768253326416
time gen tails  0.08045291900634766
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15755867958068848

in edges time spent  0.7579641342163086
local to global src and eids time spent  1.250316858291626
time gen tails  0.21586275100708008
res  length 8
block collection to dataloader spend  2.288818359375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983875274658203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215683937072754  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216391086578369  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07563591003417969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057205677032471  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0588483810424805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08432769775390625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.093993663787842  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.097050666809082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08004570007324219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04065465927124  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041662216186523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964372634887695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051021575927734  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.052028179168701  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0872039794921875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251293182373047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252932071685791  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09378814697265625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24221134185791  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245213985443115  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09179019927978516  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.868870735168457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8707275390625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09623956680297852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1440393924713135
pure train time :  0.7500030994415283
train time :  1.0852065086364746
end to end time :  7.090306282043457
connection check time:  3.395210027694702
block generation time  1.8612163066864014
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0006418228149414062
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014434337615966797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5036511421203613
len local_batched_seeds_list  8
partition total batch output list spend :  0.7136056423187256
self.buckets_partition() spend  sec:  0.5181255340576172
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0334475040435791

in edges time spent  0.08580613136291504
local to global src and eids time spent  0.11680269241333008
time gen tails  0.04699134826660156
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10830307006835938

in edges time spent  0.4347996711730957
local to global src and eids time spent  0.5176126956939697
time gen tails  0.13236045837402344
res  length 8
block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984018325805664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219841480255127  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220535755157471  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07540702819824219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.065418243408203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06707239151001  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0841360092163086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115440368652344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.118497371673584  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0802607536315918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024896621704102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025904178619385  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796809196472168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044093608856201  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045093059539795  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08701944351196289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237701416015625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2397942543029785  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362316131591797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23841667175293  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241844654083252  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09275388717651367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902649879455566  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904119968414307  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09631967544555664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1423996686935425
pure train time :  0.7334558963775635
train time :  1.0605382919311523
end to end time :  4.832310676574707
connection check time:  1.6723957061767578
block generation time  1.3670668601989746
Run 00 | Epoch 00115 | Loss 1.1424 | Test 0.6268
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004661083221435547
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017504453659057617
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4848191738128662
len local_batched_seeds_list  8
partition total batch output list spend :  0.6166777610778809
self.buckets_partition() spend  sec:  0.5023565292358398
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0290374755859375

in edges time spent  0.09277772903442383
local to global src and eids time spent  0.11875486373901367
time gen tails  0.049335479736328125
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10926389694213867

in edges time spent  0.4574887752532959
local to global src and eids time spent  0.8562965393066406
time gen tails  0.19939565658569336
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023834228515625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2144694328308105  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214200496673584  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07536935806274414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070761203765869  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072060585021973  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08438968658447266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112046241760254  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115103244781494  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07986021041870117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0258636474609375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026871204376221  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961177825927734  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.03532075881958  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0363593101501465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0872354507446289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224939346313477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.226787090301514  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362602233886719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240218639373779  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243646621704102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09272623062133789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9079999923706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90949010848999  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09588956832885742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1401809453964233
pure train time :  0.7872514724731445
train time :  1.1031274795532227
end to end time :  5.928028345108032
connection check time:  2.3157453536987305
block generation time  1.8694345951080322
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005311965942382812
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01545095443725586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5059518814086914
len local_batched_seeds_list  8
partition total batch output list spend :  0.6385271549224854
self.buckets_partition() spend  sec:  0.5214362144470215
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.047495365142822266

in edges time spent  0.16562676429748535
local to global src and eids time spent  0.3375070095062256
time gen tails  0.08475661277770996
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15998506546020508

in edges time spent  0.8192276954650879
local to global src and eids time spent  1.2572333812713623
time gen tails  0.22086191177368164
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983112335205078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213019847869873  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2127509117126465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07532501220703125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06864595413208  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069875717163086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397579193115234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1035590171813965  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.106616020202637  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07944917678833008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.031736373901367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.032740116119385  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07981348037719727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043978691101074  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045002460479736  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704471588134766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2406134605407715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242518424987793  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09406185150146484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2513227462768555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254750728607178  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09300851821899414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.897216320037842  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898686408996582  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09633874893188477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1385447978973389
pure train time :  0.732532262802124
train time :  1.0968315601348877
end to end time :  7.16817045211792
connection check time:  3.5359466075897217
block generation time  1.8820130825042725
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005867481231689453
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01420450210571289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.507164716720581
len local_batched_seeds_list  8
partition total batch output list spend :  0.7831549644470215
self.buckets_partition() spend  sec:  0.5214049816131592
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04668855667114258

in edges time spent  0.1567821502685547
local to global src and eids time spent  0.31903862953186035
time gen tails  0.08109378814697266
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15696310997009277

in edges time spent  0.8100221157073975
local to global src and eids time spent  1.2404861450195312
time gen tails  0.21580791473388672
res  length 8
block collection to dataloader spend  1.9311904907226562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07999897003173828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21471643447876  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215423107147217  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07570123672485352  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06901741027832  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070852756500244  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08434867858886719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.126110076904297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.129167079925537  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07940864562988281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.980631351470947  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9816389083862305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07986021041870117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049466133117676  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050468921661377  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705759048461914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231513500213623  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23336124420166  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363222122192383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234854698181152  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237391948699951  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09245634078979492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903987884521484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905457973480225  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09606695175170898  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1358184814453125
pure train time :  0.7203912734985352
train time :  1.057541847229004
end to end time :  7.209298849105835
connection check time:  3.47663950920105
block generation time  1.869091510772705
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005159378051757812
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014545440673828125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4812917709350586
len local_batched_seeds_list  8
partition total batch output list spend :  0.7540922164916992
self.buckets_partition() spend  sec:  0.49587464332580566
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04468679428100586

in edges time spent  0.15529346466064453
local to global src and eids time spent  0.32574033737182617
time gen tails  0.08262228965759277
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15832972526550293

in edges time spent  0.8310174942016602
local to global src and eids time spent  1.27048659324646
time gen tails  0.22369980812072754
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983732223510742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216346740722656  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216076850891113  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0753788948059082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077098369598389  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078279972076416  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08412790298461914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1119489669799805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115005970001221  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947015762329102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02421236038208  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025219917297363  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964277267456055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040899276733398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041906833648682  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704757690429688  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244708061218262  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246616363525391  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09403467178344727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.191101551055908  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.194104194641113  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09180688858032227  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.882897853851318  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884830474853516  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09586906433105469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1379220485687256
pure train time :  0.7220339775085449
train time :  1.0580112934112549
end to end time :  7.239610910415649
connection check time:  3.5466811656951904
block generation time  1.8672380447387695
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004889965057373047
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01459360122680664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4060943126678467
len local_batched_seeds_list  8
partition total batch output list spend :  0.6106047630310059
self.buckets_partition() spend  sec:  0.4207184314727783
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0456700325012207

in edges time spent  0.14408040046691895
local to global src and eids time spent  0.32187485694885254
time gen tails  0.08136868476867676
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16242074966430664

in edges time spent  0.7806928157806396
local to global src and eids time spent  1.2556865215301514
time gen tails  0.2181413173675537
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983207702636719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221567630767822  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2219767570495605  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07552814483642578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.062044143676758  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.063411235809326  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08413410186767578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113356113433838  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116413116455078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07936286926269531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017339706420898  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.018347263336182  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07957124710083008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039769172668457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04077672958374  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08701944351196289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236090183258057  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237937927246094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362506866455078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2482733726501465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251701354980469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09283876419067383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904092311859131  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905562400817871  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09601163864135742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1331690549850464
pure train time :  0.7445378303527832
train time :  1.0719928741455078
end to end time :  7.036694526672363
connection check time:  3.453761100769043
block generation time  1.875805139541626
Run 00 | Epoch 00120 | Loss 1.1332 | Test 0.6286
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005621910095214844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018161535263061523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.513782262802124
len local_batched_seeds_list  8
partition total batch output list spend :  0.649010419845581
self.buckets_partition() spend  sec:  0.5319817066192627
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04813647270202637

in edges time spent  0.16006994247436523
local to global src and eids time spent  0.31865763664245605
time gen tails  0.08203649520874023
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15654349327087402

in edges time spent  0.7801403999328613
local to global src and eids time spent  1.2495660781860352
time gen tails  0.2214958667755127
res  length 8
block collection to dataloader spend  1.9788742065429688e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984495162963867  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218906402587891  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219171524047852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07527589797973633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.084039211273193  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.086067199707031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08412361145019531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.094253063201904  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0976715087890625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07973861694335938  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0174360275268555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.018443584442139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965803146362305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037593364715576  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038600921630859  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705282211303711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247307300567627  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24892520904541  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09376907348632812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238434791564941  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241862773895264  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09228229522705078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871767997741699  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873820781707764  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09662628173828125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1305413246154785
pure train time :  0.7319610118865967
train time :  1.077768087387085
end to end time :  7.096554279327393
connection check time:  3.4860005378723145
block generation time  1.8653123378753662
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005631446838378906
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014369487762451172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.40746402740478516
len local_batched_seeds_list  8
partition total batch output list spend :  0.6911263465881348
self.buckets_partition() spend  sec:  0.4218711853027344
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0476377010345459

in edges time spent  0.16208863258361816
local to global src and eids time spent  0.3186678886413574
time gen tails  0.08078694343566895
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15923810005187988

in edges time spent  0.7452361583709717
local to global src and eids time spent  1.2394723892211914
time gen tails  0.21561145782470703
res  length 8
block collection to dataloader spend  1.9311904907226562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08035087585449219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.188210487365723  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.187994003295898  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07550859451293945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068138122558594  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069282531738281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08405733108520508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1134772300720215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116534233093262  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795750617980957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.012320041656494  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013327598571777  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07975482940673828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047557353973389  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048564910888672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08720636367797852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24595308303833  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247570037841797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09374237060546875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.228433132171631  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231861114501953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09285545349121094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.874144077301025  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.876009941101074  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09635543823242188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.132645845413208
pure train time :  0.7362582683563232
train time :  1.0609173774719238
end to end time :  7.057387590408325
connection check time:  3.4148921966552734
block generation time  1.8708086013793945
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004603862762451172
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014306306838989258
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5081977844238281
len local_batched_seeds_list  8
partition total batch output list spend :  0.7836062908172607
self.buckets_partition() spend  sec:  0.5225324630737305
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044705867767333984

in edges time spent  0.15378046035766602
local to global src and eids time spent  0.3174400329589844
time gen tails  0.07948780059814453
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15577912330627441

in edges time spent  0.7528178691864014
local to global src and eids time spent  1.2359652519226074
time gen tails  0.21433258056640625
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08011054992675781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2172322273254395  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216963768005371  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0756673812866211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.088174343109131  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.089287281036377  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396530151367188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0977020263671875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.101606845855713  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07979631423950195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.030908584594727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.03191614151001  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07971382141113281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044259548187256  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045261383056641  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08722639083862305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251039028167725  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252641677856445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09373664855957031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.200811386108398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.204239368438721  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09202194213867188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8971147537231445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898840427398682  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09589481353759766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.128566861152649
pure train time :  0.7359297275543213
train time :  1.071457862854004
end to end time :  7.141554117202759
connection check time:  3.4026527404785156
block generation time  1.8698723316192627
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004680156707763672
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014435291290283203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.45787549018859863
len local_batched_seeds_list  8
partition total batch output list spend :  0.730614185333252
self.buckets_partition() spend  sec:  0.47234296798706055
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0466763973236084

in edges time spent  0.16063427925109863
local to global src and eids time spent  0.33091306686401367
time gen tails  0.08564448356628418
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.18779468536376953

in edges time spent  0.808845043182373
local to global src and eids time spent  1.254476547241211
time gen tails  0.21758127212524414
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798335075378418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216751575469971  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216482639312744  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07575798034667969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080058574676514  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.081792831420898  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08414077758789062  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.126338481903076  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.129395484924316  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795741081237793  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027865409851074  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.028872966766357  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07976388931274414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050943851470947  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0519514083862305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08709383010864258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245719909667969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247379779815674  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0937948226928711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.197303295135498  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.20073127746582  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09188079833984375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871397972106934  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873706340789795  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09656095504760742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1280944347381592
pure train time :  0.6470799446105957
train time :  1.0217342376708984
end to end time :  7.172097444534302
connection check time:  3.5434744358062744
block generation time  1.857283353805542
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005471706390380859
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016211986541748047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4581470489501953
len local_batched_seeds_list  8
partition total batch output list spend :  0.7416040897369385
self.buckets_partition() spend  sec:  0.4743919372558594
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04564690589904785

in edges time spent  0.16040515899658203
local to global src and eids time spent  0.3382582664489746
time gen tails  0.08083033561706543
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1559762954711914

in edges time spent  0.7956264019012451
local to global src and eids time spent  1.2389280796051025
time gen tails  0.2246074676513672
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08022880554199219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217436790466309  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217846393585205  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07542085647583008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07843017578125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079659938812256  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0841364860534668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1242499351501465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127306938171387  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07930135726928711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014683723449707  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.01569128036499  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796365737915039  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049173831939697  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0501813888549805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705377578735352  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234172344207764  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23628044128418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09390735626220703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233782768249512  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236785411834717  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09191417694091797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.878276824951172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.880585193634033  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09593057632446289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1254987716674805
pure train time :  0.7234067916870117
train time :  1.0595157146453857
end to end time :  7.193827152252197
connection check time:  3.508413791656494
block generation time  1.8667442798614502
Run 00 | Epoch 00125 | Loss 1.1255 | Test 0.6295
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00035834312438964844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015842676162719727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.23272180557250977
len local_batched_seeds_list  8
partition total batch output list spend :  0.3219742774963379
self.buckets_partition() spend  sec:  0.24859070777893066
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.029219865798950195

in edges time spent  0.09222960472106934
local to global src and eids time spent  0.11731076240539551
time gen tails  0.06565284729003906
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15914225578308105

in edges time spent  0.7999978065490723
local to global src and eids time spent  1.2365448474884033
time gen tails  0.21841716766357422
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983779907226562  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214975833892822  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214706897735596  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07547378540039062  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070119857788086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07205867767334  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08403635025024414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.11014986038208  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.11320686340332  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.079376220703125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0182318687438965  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.01923942565918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07987022399902344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.057819366455078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0589189529418945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08710956573486328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.225027084350586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.226874828338623  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09413862228393555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255278587341309  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.258706569671631  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09267234802246094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900643825531006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902441024780273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09583759307861328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1273068189620972
pure train time :  0.7526705265045166
train time :  1.084496021270752
end to end time :  6.470547676086426
connection check time:  3.1628477573394775
block generation time  1.878164291381836
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005755424499511719
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014768838882446289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4758579730987549
len local_batched_seeds_list  8
partition total batch output list spend :  0.7576110363006592
self.buckets_partition() spend  sec:  0.4906628131866455
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045491695404052734

in edges time spent  0.15793085098266602
local to global src and eids time spent  0.31781506538391113
time gen tails  0.08067083358764648
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1610567569732666

in edges time spent  0.7811403274536133
local to global src and eids time spent  1.2492594718933105
time gen tails  0.219130277633667
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984066009521484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219018459320068  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219389915466309  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07541656494140625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076274871826172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077504634857178  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08484506607055664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.128042697906494  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.131099700927734  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795292854309082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.011957168579102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.012964725494385  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07968902587890625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0351667404174805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036214351654053  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707380294799805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23996114730835  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241668701171875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09386587142944336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232260704040527  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235263347625732  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09192180633544922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899885654449463  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901355743408203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09611272811889648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.122644305229187
pure train time :  0.7262885570526123
train time :  1.0590407848358154
end to end time :  7.184872388839722
connection check time:  3.459604263305664
block generation time  1.8943536281585693
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0003685951232910156
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01689004898071289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.26287174224853516
len local_batched_seeds_list  8
partition total batch output list spend :  0.35817813873291016
self.buckets_partition() spend  sec:  0.2797873020172119
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.043395042419433594

in edges time spent  0.16033196449279785
local to global src and eids time spent  0.32845330238342285
time gen tails  0.08148574829101562
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15631961822509766

in edges time spent  0.8122305870056152
local to global src and eids time spent  1.246060848236084
time gen tails  0.21747112274169922
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07999277114868164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211723804473877  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21145486831665  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07546186447143555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0739898681640625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075219631195068  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397960662841797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077696800231934  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080880641937256  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07968902587890625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026496887207031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0275044441223145  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960653305053711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054238796234131  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.055244445800781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705472946166992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255507469177246  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.257205486297607  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09385442733764648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24717378616333  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250601768493652  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09229373931884766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903532981872559  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905023097991943  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09588432312011719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1187528371810913
pure train time :  0.7327477931976318
train time :  1.0615713596343994
end to end time :  6.7969865798950195
connection check time:  3.4884591102600098
block generation time  1.872718334197998
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00047087669372558594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014578580856323242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.45430874824523926
len local_batched_seeds_list  8
partition total batch output list spend :  0.7296292781829834
self.buckets_partition() spend  sec:  0.4689209461212158
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0441288948059082

in edges time spent  0.15470194816589355
local to global src and eids time spent  0.32492876052856445
time gen tails  0.08053755760192871
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15741682052612305

in edges time spent  0.7611656188964844
local to global src and eids time spent  1.2459571361541748
time gen tails  0.21653342247009277
res  length 8
block collection to dataloader spend  1.7881393432617188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798349380493164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2086286544799805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.208359718322754  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07536602020263672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.055225849151611  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.056455612182617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396482467651367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.085549354553223  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.088688850402832  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953405380249023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.052230358123779  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0532379150390625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945489883422852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034235954284668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035243511199951  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704185485839844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.25381326675415  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255415916442871  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09374570846557617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233651638031006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237079620361328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09291315078735352  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902775287628174  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905083656311035  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09663820266723633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1208689212799072
pure train time :  0.7369654178619385
train time :  1.0641350746154785
end to end time :  7.1139843463897705
connection check time:  3.435482978820801
block generation time  1.8678584098815918
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.000545501708984375
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013846874237060547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.501101016998291
len local_batched_seeds_list  8
partition total batch output list spend :  0.785203218460083
self.buckets_partition() spend  sec:  0.5149819850921631
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04477214813232422

in edges time spent  0.15227937698364258
local to global src and eids time spent  0.3160059452056885
time gen tails  0.07934689521789551
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16045761108398438

in edges time spent  0.794414758682251
local to global src and eids time spent  1.26362943649292
time gen tails  0.21516036987304688
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08038759231567383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220133304595947  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219943523406982  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07537508010864258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.067986488342285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0691680908203125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08407735824584961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112913608551025  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115970611572266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07986593246459961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.003201961517334  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.004199028015137  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0797719955444336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049039840698242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050126552581787  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08725357055664062  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.22557258605957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227420330047607  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09360790252685547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.203845977783203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.207273960113525  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0927133560180664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.896611213684082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898614883422852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09587478637695312  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1188275814056396
pure train time :  0.7354717254638672
train time :  1.0618581771850586
end to end time :  7.20923638343811
connection check time:  3.479041337966919
block generation time  1.8660557270050049
Run 00 | Epoch 00130 | Loss 1.1188 | Test 0.6262
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00039649009704589844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015383481979370117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.25072574615478516
len local_batched_seeds_list  8
partition total batch output list spend :  0.3465135097503662
self.buckets_partition() spend  sec:  0.26613736152648926
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.029111385345458984

in edges time spent  0.09264397621154785
local to global src and eids time spent  0.12961769104003906
time gen tails  0.05066704750061035
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10999917984008789

in edges time spent  0.8106162548065186
local to global src and eids time spent  1.2515480518341064
time gen tails  0.22211623191833496
res  length 8
block collection to dataloader spend  1.811981201171875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.079833984375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218639373779297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219048500061035  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0754094123840332  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073357582092285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074479579925537  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0842428207397461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120750904083252  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.12448787689209  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07970857620239258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026270389556885  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027277946472168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07971429824829102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041092872619629  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042100429534912  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704519271850586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247724533081055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249355792999268  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09378242492675781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2365336418151855  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239961624145508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09271383285522461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875967979431152  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877833843231201  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0958704948425293  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1156848669052124
pure train time :  0.741769552230835
train time :  1.085223913192749
end to end time :  6.339490175247192
connection check time:  3.078899621963501
block generation time  1.8081920146942139
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.000545501708984375
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015806198120117188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5263068675994873
len local_batched_seeds_list  8
partition total batch output list spend :  0.774594783782959
self.buckets_partition() spend  sec:  0.5421571731567383
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04985642433166504

in edges time spent  0.16614532470703125
local to global src and eids time spent  0.33503198623657227
time gen tails  0.08447027206420898
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15932083129882812

in edges time spent  0.837562084197998
local to global src and eids time spent  1.2566947937011719
time gen tails  0.21828317642211914
res  length 8
block collection to dataloader spend  1.8835067749023438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984447479248047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218589782714844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218320846557617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07536888122558594  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075133800506592  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076363563537598  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08480596542358398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.096933841705322  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0999908447265625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07939004898071289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024417877197266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025425434112549  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07969999313354492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043936729431152  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0449419021606445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703041076660156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2439188957214355  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24583101272583  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09405088424682617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.229326248168945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232754230499268  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09273529052734375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.896367073059082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8984599113464355  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09622335433959961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1165332794189453
pure train time :  0.7452192306518555
train time :  1.0830087661743164
end to end time :  7.341913938522339
connection check time:  3.5687568187713623
block generation time  1.8961246013641357
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005040168762207031
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015603065490722656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4630420207977295
len local_batched_seeds_list  8
partition total batch output list spend :  0.5950624942779541
self.buckets_partition() spend  sec:  0.4786820411682129
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.028664350509643555

in edges time spent  0.0881655216217041
local to global src and eids time spent  0.1170034408569336
time gen tails  0.05529665946960449
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1617112159729004

in edges time spent  0.7877881526947021
local to global src and eids time spent  1.2766530513763428
time gen tails  0.22833824157714844
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08016490936279297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2177863121032715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217517852783203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07541513442993164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070831775665283  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072465896606445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397674560546875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.09212064743042  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.09517765045166  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08013391494750977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.05904483795166  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.060052394866943  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07973575592041016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043827056884766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044834613800049  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0872182846069336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241201400756836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242971897125244  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09392833709716797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246285915374756  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249713897705078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09230852127075195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9059858322143555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.908294200897217  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09644842147827148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1120675802230835
pure train time :  0.724043607711792
train time :  1.0707213878631592
end to end time :  6.77414608001709
connection check time:  3.209627866744995
block generation time  1.8764548301696777
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005388259887695312
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01556539535522461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5281610488891602
len local_batched_seeds_list  8
partition total batch output list spend :  0.809760570526123
self.buckets_partition() spend  sec:  0.5437695980072021
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0455322265625

in edges time spent  0.15904521942138672
local to global src and eids time spent  0.2305903434753418
time gen tails  0.08241844177246094
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15585088729858398

in edges time spent  0.7797167301177979
local to global src and eids time spent  1.2417635917663574
time gen tails  0.21471095085144043
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08038949966430664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222890377044678  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222701072692871  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07532596588134766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068369388580322  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069670677185059  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397150039672852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.102875232696533  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.10614013671875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07937002182006836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.012794017791748  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013793468475342  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08022022247314453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033308982849121  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034316062927246  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703088760375977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2478437423706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249691486358643  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0936284065246582  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243553161621094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246981143951416  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09234237670898438  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905431270599365  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90738582611084  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09627342224121094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1142760515213013
pure train time :  0.710881233215332
train time :  1.040895938873291
end to end time :  7.088558673858643
connection check time:  3.358839273452759
block generation time  1.8615646362304688
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00045680999755859375
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01432490348815918
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38648080825805664
len local_batched_seeds_list  8
partition total batch output list spend :  0.6490440368652344
self.buckets_partition() spend  sec:  0.4008347988128662
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04733705520629883

in edges time spent  0.15001678466796875
local to global src and eids time spent  0.341083288192749
time gen tails  0.08740067481994629
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15590715408325195

in edges time spent  0.7874584197998047
local to global src and eids time spent  1.2466483116149902
time gen tails  0.22784018516540527
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08017730712890625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.207192420959473  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206923484802246  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07540702819824219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07858419418335  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0798139572143555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08417272567749023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.117782115936279  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1208391189575195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08018302917480469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0250115394592285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026019096374512  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967090606689453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047966480255127  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048965930938721  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702421188354492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238429546356201  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23997688293457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361076354980469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238151550292969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240685939788818  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09272432327270508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.910375595092773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.911845684051514  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09588479995727539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1106772422790527
pure train time :  0.7258148193359375
train time :  1.073502540588379
end to end time :  7.10418701171875
connection check time:  3.4966909885406494
block generation time  1.87131929397583
Run 00 | Epoch 00135 | Loss 1.1107 | Test 0.6273
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005650520324707031
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01613306999206543
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.517162561416626
len local_batched_seeds_list  8
partition total batch output list spend :  0.6809437274932861
self.buckets_partition() spend  sec:  0.5333347320556641
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04627227783203125

in edges time spent  0.16237139701843262
local to global src and eids time spent  0.31868720054626465
time gen tails  0.08366990089416504
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15865468978881836

in edges time spent  0.7860760688781738
local to global src and eids time spent  1.2377386093139648
time gen tails  0.21868515014648438
res  length 8
block collection to dataloader spend  1.7881393432617188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983827590942383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214058876037598  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213789939880371  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07532453536987305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073068141937256  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074181079864502  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839695930480957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1115617752075195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.11461877822876  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0793600082397461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.007709980010986  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0087175369262695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08021259307861328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0528693199157715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.05387020111084  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08751344680786133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.257441520690918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.258922100067139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09421491622924805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234986305236816  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238414287567139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09204578399658203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.876084327697754  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.878035545349121  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09640645980834961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1114977598190308
pure train time :  0.7407011985778809
train time :  1.0853440761566162
end to end time :  7.136534690856934
connection check time:  3.4618303775787354
block generation time  1.888953685760498
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005979537963867188
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015047788619995117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3679225444793701
len local_batched_seeds_list  8
partition total batch output list spend :  0.5377171039581299
self.buckets_partition() spend  sec:  0.3830077648162842
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0479276180267334

in edges time spent  0.16927027702331543
local to global src and eids time spent  0.32308292388916016
time gen tails  0.0767066478729248
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1592574119567871

in edges time spent  0.7906217575073242
local to global src and eids time spent  1.3225107192993164
time gen tails  0.22455883026123047
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023309707641602  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215554714202881  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2152862548828125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0753321647644043  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.052125453948975  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.053768157958984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08400583267211914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.098776817321777  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.102538585662842  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07991313934326172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.058869361877441  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.059866428375244  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07951736450195312  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043783187866211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0448899269104  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08724403381347656  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253347873687744  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254945755004883  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09373617172241211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237705230712891  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241133213043213  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09282350540161133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907437324523926  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.908907413482666  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09625577926635742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.107870101928711
pure train time :  0.7446079254150391
train time :  1.075721025466919
end to end time :  7.089626312255859
connection check time:  3.5688915252685547
block generation time  1.887512445449829
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.000457763671875
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01674056053161621
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4281623363494873
len local_batched_seeds_list  8
partition total batch output list spend :  0.7129373550415039
self.buckets_partition() spend  sec:  0.4449324607849121
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046666622161865234

in edges time spent  0.15655755996704102
local to global src and eids time spent  0.23398804664611816
time gen tails  0.06122708320617676
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1575920581817627

in edges time spent  0.7955634593963623
local to global src and eids time spent  1.2467498779296875
time gen tails  0.21667242050170898
res  length 8
block collection to dataloader spend  1.9073486328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08009052276611328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216383457183838  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216113567352295  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07529973983764648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047141075134277  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048370838165283  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396768569946289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109157562255859  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112422466278076  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07940864562988281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.007997035980225  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.009004592895508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795435905456543  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046060085296631  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047067642211914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08709192276000977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254444122314453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.256178379058838  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0938868522644043  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23710298538208  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240105628967285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09184646606445312  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.874460697174072  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875950813293457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09583902359008789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1067850589752197
pure train time :  0.7235152721405029
train time :  1.0552699565887451
end to end time :  7.070528745651245
connection check time:  3.406036376953125
block generation time  1.8803205490112305
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004723072052001953
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015675783157348633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.460207462310791
len local_batched_seeds_list  8
partition total batch output list spend :  0.5905828475952148
self.buckets_partition() spend  sec:  0.4759194850921631
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04100632667541504

in edges time spent  0.1604766845703125
local to global src and eids time spent  0.19207763671875
time gen tails  0.04853940010070801
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10827016830444336

in edges time spent  0.7487812042236328
local to global src and eids time spent  1.2406046390533447
time gen tails  0.22072100639343262
res  length 8
block collection to dataloader spend  1.8835067749023438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07982683181762695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.183139324188232  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.182870864868164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07566690444946289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080871105194092  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.082100868225098  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0842127799987793  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.125436305999756  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.128493309020996  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945632934570312  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022665500640869  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023662567138672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965803146362305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04710578918457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0481438636779785  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706283569335938  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255893707275391  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.257806301116943  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09433269500732422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245178699493408  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2486066818237305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.092681884765625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898648738861084  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900374412536621  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09585094451904297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1061567068099976
pure train time :  0.7398862838745117
train time :  1.074784278869629
end to end time :  6.615495681762695
connection check time:  3.1379282474517822
block generation time  1.7989633083343506
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005803108215332031
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014415502548217773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47473716735839844
len local_batched_seeds_list  8
partition total batch output list spend :  0.7505192756652832
self.buckets_partition() spend  sec:  0.48918843269348145
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04408764839172363

in edges time spent  0.15210986137390137
local to global src and eids time spent  0.3171422481536865
time gen tails  0.08078503608703613
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1589057445526123

in edges time spent  0.7823946475982666
local to global src and eids time spent  1.2383692264556885
time gen tails  0.21752500534057617
res  length 8
block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052682876586914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218092918395996  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218501567840576  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07547616958618164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069613933563232  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070955276489258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0842127799987793  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127104759216309  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130161762237549  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07952356338500977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.011996746063232  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013004302978516  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967662811279297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047957420349121  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048964977264404  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870981216430664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255042552947998  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.256801605224609  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09389638900756836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.194648265838623  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.198076248168945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0919489860534668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905106067657471  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906576156616211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09582662582397461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1029815673828125
pure train time :  0.7479395866394043
train time :  1.0977818965911865
end to end time :  7.194576025009155
connection check time:  3.438194751739502
block generation time  1.8916904926300049
Run 00 | Epoch 00140 | Loss 1.1030 | Test 0.6270
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004909038543701172
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015964746475219727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5180299282073975
len local_batched_seeds_list  8
partition total batch output list spend :  0.6572811603546143
self.buckets_partition() spend  sec:  0.5340316295623779
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04848456382751465

in edges time spent  0.12355256080627441
local to global src and eids time spent  0.11832761764526367
time gen tails  0.05201125144958496
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10701107978820801

in edges time spent  0.5144937038421631
local to global src and eids time spent  0.5262942314147949
time gen tails  0.14528512954711914
res  length 8
block collection to dataloader spend  1.1205673217773438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798330307006836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217250823974609  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216981410980225  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07556915283203125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072091579437256  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07403039932251  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08412551879882812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.110472679138184  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113529682159424  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07940959930419922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.016797065734863  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017788887023926  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796513557434082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043345928192139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0443525314331055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702754974365234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239390850067139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241238594055176  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0935964584350586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.186612129211426  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.189614772796631  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09178781509399414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900979518890381  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902915000915527  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09617376327514648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1037793159484863
pure train time :  0.6783127784729004
train time :  1.0224218368530273
end to end time :  4.932872295379639
connection check time:  1.8399090766906738
block generation time  1.3958463668823242
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0003573894500732422
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014406919479370117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.20043587684631348
len local_batched_seeds_list  8
partition total batch output list spend :  0.287550687789917
self.buckets_partition() spend  sec:  0.21486616134643555
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.026660680770874023

in edges time spent  0.1242058277130127
local to global src and eids time spent  0.2577219009399414
time gen tails  0.08556175231933594
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16371393203735352

in edges time spent  0.791856050491333
local to global src and eids time spent  1.2532050609588623
time gen tails  0.222442626953125
res  length 8
block collection to dataloader spend  2.5510787963867188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08018302917480469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222104072570801  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222512722015381  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554769515991211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07170295715332  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072932720184326  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08399724960327148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.092374324798584  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.095792770385742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07996225357055664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021247386932373  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022249221801758  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07952737808227539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036037445068359  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037039279937744  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702659606933594  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241143703460693  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243048191070557  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09397506713867188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213436603546143  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216864585876465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09264898300170898  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907214164733887  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.909522533416748  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0958104133605957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1017645597457886
pure train time :  0.7291083335876465
train time :  1.074904203414917
end to end time :  6.674576997756958
connection check time:  3.407086133956909
block generation time  1.8889446258544922
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048828125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01518702507019043
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5185058116912842
len local_batched_seeds_list  8
partition total batch output list spend :  0.6480045318603516
self.buckets_partition() spend  sec:  0.5337309837341309
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04223036766052246

in edges time spent  0.15519952774047852
local to global src and eids time spent  0.3179607391357422
time gen tails  0.08013772964477539
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15636539459228516

in edges time spent  0.7633185386657715
local to global src and eids time spent  1.234527349472046
time gen tails  0.22339081764221191
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983112335205078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.207675457000732  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2080841064453125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07578897476196289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.108969688415527  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.110097885131836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397865295410156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.094491958618164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.097548961639404  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0797581672668457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038029193878174  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039036750793457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07959270477294922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042827129364014  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043831825256348  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706235885620117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243167877197266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245005130767822  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.093994140625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238046169281006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241474151611328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09262609481811523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.87551736831665  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877401351928711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09617948532104492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1003631353378296
pure train time :  0.74045729637146
train time :  1.0643465518951416
end to end time :  7.049937725067139
connection check time:  3.42806077003479
block generation time  1.8926246166229248
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048828125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015772342681884766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44745945930480957
len local_batched_seeds_list  8
partition total batch output list spend :  0.6153411865234375
self.buckets_partition() spend  sec:  0.46327829360961914
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.045325517654418945

in edges time spent  0.15939021110534668
local to global src and eids time spent  0.3290858268737793
time gen tails  0.08509445190429688
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16321969032287598

in edges time spent  0.839881181716919
local to global src and eids time spent  1.2693016529083252
time gen tails  0.2258768081665039
res  length 8
block collection to dataloader spend  2.6464462280273438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0802316665649414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214289665222168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214020729064941  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07539939880371094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075447082519531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076712131500244  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0841989517211914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.106932640075684  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.109989643096924  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07937812805175781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.005061626434326  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.006069183349609  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966136932373047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042457103729248  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043464660644531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08709955215454102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248270034790039  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249777317047119  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361410140991211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1938066482543945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1968092918396  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09184837341308594  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884683609008789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.886153697967529  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09603691101074219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0990703105926514
pure train time :  0.7068078517913818
train time :  1.069382905960083
end to end time :  7.202574729919434
connection check time:  3.566716194152832
block generation time  1.9353177547454834
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005578994750976562
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01530909538269043
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5095634460449219
len local_batched_seeds_list  8
partition total batch output list spend :  0.7652854919433594
self.buckets_partition() spend  sec:  0.524911642074585
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.02995467185974121

in edges time spent  0.09278726577758789
local to global src and eids time spent  0.12470245361328125
time gen tails  0.05301618576049805
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16932916641235352

in edges time spent  0.8071506023406982
local to global src and eids time spent  1.2594034671783447
time gen tails  0.2171792984008789
res  length 8
block collection to dataloader spend  2.2649765014648438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07999801635742188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217679023742676  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217409610748291  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07538318634033203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069128513336182  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070241451263428  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396196365356445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076770782470703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080012321472168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956981658935547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0164570808410645  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.01746129989624  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796957015991211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044322490692139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0453267097473145  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704805374145508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241140842437744  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.243238925933838  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363698959350586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247551918029785  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250979900360107  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09270668029785156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9011101722717285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903167724609375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09619617462158203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0965776443481445
pure train time :  0.7351803779602051
train time :  1.083477258682251
end to end time :  6.9396796226501465
connection check time:  3.1578102111816406
block generation time  1.9088194370269775
Run 00 | Epoch 00145 | Loss 1.0966 | Test 0.6273
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005669593811035156
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01632547378540039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5226414203643799
len local_batched_seeds_list  8
partition total batch output list spend :  0.6589889526367188
self.buckets_partition() spend  sec:  0.5390233993530273
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04892730712890625

in edges time spent  0.16551566123962402
local to global src and eids time spent  0.32509422302246094
time gen tails  0.08342242240905762
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15811681747436523

in edges time spent  0.853184700012207
local to global src and eids time spent  1.2568094730377197
time gen tails  0.2206716537475586
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08016347885131836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2129597663879395  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.212691307067871  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07530641555786133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069940567016602  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0710601806640625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404970169067383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.118327617645264  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.121384620666504  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07959127426147461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024045467376709  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025053024291992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964563369750977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034456729888916  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035463809967041  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870218276977539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238931655883789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241008758544922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09360027313232422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.198373317718506  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.201801300048828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09219121932983398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903818607330322  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905631065368652  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09607076644897461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0960966348648071
pure train time :  0.747361421585083
train time :  1.0927150249481201
end to end time :  7.2200093269348145
connection check time:  3.5566811561584473
block generation time  1.8914072513580322
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005609989166259766
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015010595321655273
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5055983066558838
len local_batched_seeds_list  8
partition total batch output list spend :  0.7957515716552734
self.buckets_partition() spend  sec:  0.5206456184387207
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04492616653442383

in edges time spent  0.15619325637817383
local to global src and eids time spent  0.3182845115661621
time gen tails  0.08105874061584473
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16217541694641113

in edges time spent  0.7767419815063477
local to global src and eids time spent  1.2447514533996582
time gen tails  0.2227315902709961
res  length 8
block collection to dataloader spend  2.2172927856445312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08078336715698242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214181423187256  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213911533355713  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07538795471191406  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0747389793396  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0759687423706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08426284790039062  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.128728866577148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.131993770599365  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07940244674682617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0065178871154785  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0075178146362305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953500747680664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040666580200195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041666507720947  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702564239501953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2312421798706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233089923858643  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361028671264648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235314846038818  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238742828369141  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09209775924682617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.88026762008667  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.88173770904541  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0959620475769043  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0965914726257324
pure train time :  0.7390017509460449
train time :  1.074577808380127
end to end time :  7.250637769699097
connection check time:  3.483224868774414
block generation time  1.8769774436950684
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005140304565429688
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01566910743713379
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5093982219696045
len local_batched_seeds_list  8
partition total batch output list spend :  0.6436765193939209
self.buckets_partition() spend  sec:  0.5251047611236572
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.027711153030395508

in edges time spent  0.08517241477966309
local to global src and eids time spent  0.11730146408081055
time gen tails  0.04786849021911621
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1053628921508789

in edges time spent  0.7524917125701904
local to global src and eids time spent  1.2339146137237549
time gen tails  0.21889138221740723
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052682876586914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214062213897705  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214768409729004  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07555150985717773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07725191116333  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078578948974609  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0848093032836914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113807201385498  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116864204406738  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953596115112305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027947902679443  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.028955459594727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795598030090332  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038973808288574  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040065288543701  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703756332397461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253609657287598  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.25551700592041  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09400129318237305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235703945159912  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239131927490234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09206008911132812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.866288185119629  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.868297100067139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0962667465209961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0934925079345703
pure train time :  0.727515459060669
train time :  1.0622258186340332
end to end time :  6.465754747390747
connection check time:  2.9635097980499268
block generation time  1.7795677185058594
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005407333374023438
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01443791389465332
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.462599515914917
len local_batched_seeds_list  8
partition total batch output list spend :  0.7385604381561279
self.buckets_partition() spend  sec:  0.477069616317749
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04521584510803223

in edges time spent  0.15468239784240723
local to global src and eids time spent  0.32669615745544434
time gen tails  0.08052778244018555
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1616382598876953

in edges time spent  0.8014423847198486
local to global src and eids time spent  1.297441005706787
time gen tails  0.2280118465423584
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0807809829711914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.190122127532959  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.189854621887207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07544660568237305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075145244598389  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076258182525635  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0842132568359375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1252031326293945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.128260135650635  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07944297790527344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045260429382324  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046267986297607  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966852188110352  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048730373382568  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049737930297852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08711481094360352  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254664897918701  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.256285190582275  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09377336502075195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249961853027344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253389835357666  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09224367141723633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.870718002319336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872553825378418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0964956283569336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0938327312469482
pure train time :  0.7282891273498535
train time :  1.0590620040893555
end to end time :  7.3284218311309814
connection check time:  3.5588855743408203
block generation time  1.9577538967132568
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005714893341064453
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015775680541992188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38106751441955566
len local_batched_seeds_list  8
partition total batch output list spend :  0.6221122741699219
self.buckets_partition() spend  sec:  0.3968806266784668
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04991412162780762

in edges time spent  0.15974903106689453
local to global src and eids time spent  0.3231320381164551
time gen tails  0.0849761962890625
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16045045852661133

in edges time spent  0.7605397701263428
local to global src and eids time spent  0.7284843921661377
time gen tails  0.1375439167022705
res  length 8
block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08018970489501953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.211116790771484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.210848808288574  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07532262802124023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.053553104400635  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054675102233887  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0840597152709961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.091989040374756  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.09535026550293  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795583724975586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.016197681427002  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017205238342285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07954025268554688  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038085460662842  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039092063903809  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703327178955078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250718593597412  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252626419067383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09404802322387695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235947132110596  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239375114440918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09261560440063477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900155544281006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901952743530273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09606504440307617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0912449359893799
pure train time :  0.7572510242462158
train time :  1.082341194152832
end to end time :  5.899717330932617
connection check time:  2.674346446990967
block generation time  1.5062408447265625
Run 00 | Epoch 00150 | Loss 1.0912 | Test 0.6266
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004367828369140625
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016155481338500977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.23520898818969727
len local_batched_seeds_list  8
partition total batch output list spend :  0.327404260635376
self.buckets_partition() spend  sec:  0.25139665603637695
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.02929997444152832

in edges time spent  0.09547686576843262
local to global src and eids time spent  0.1771862506866455
time gen tails  0.05057954788208008
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10743117332458496

in edges time spent  0.45819902420043945
local to global src and eids time spent  0.9546051025390625
time gen tails  0.18642473220825195
res  length 8
block collection to dataloader spend  1.9788742065429688e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0801239013671875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213724136352539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213455677032471  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07551288604736328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072376728057861  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074315547943115  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404016494750977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1165771484375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.11963415145874  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07955455780029297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025115966796875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026123523712158  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07962989807128906  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036502361297607  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037509918212891  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706808090209961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239681243896484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241741180419922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09363031387329102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2491230964660645  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252551078796387  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0926671028137207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902414798736572  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904433250427246  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09627485275268555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0882796049118042
pure train time :  0.7417781352996826
train time :  1.0783448219299316
end to end time :  5.658461570739746
connection check time:  2.436563491821289
block generation time  1.7940552234649658
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004889965057373047
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014696836471557617
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.40088820457458496
len local_batched_seeds_list  8
partition total batch output list spend :  0.5584332942962646
self.buckets_partition() spend  sec:  0.4156162738800049
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04672098159790039

in edges time spent  0.15398049354553223
local to global src and eids time spent  0.3186159133911133
time gen tails  0.0814814567565918
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1572732925415039

in edges time spent  0.7523910999298096
local to global src and eids time spent  1.0841889381408691
time gen tails  0.18139290809631348
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08027839660644531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215093612670898  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214824676513672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07527637481689453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074755668640137  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075870990753174  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839700698852539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.099254131317139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.102311134338379  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947826385498047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023917198181152  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.024919033050537  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967138290405273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043101787567139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044103622436523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707952499389648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236479759216309  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238327503204346  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09359979629516602  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.198196887969971  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.201199531555176  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0918269157409668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.908812999725342  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.910737991333008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09587812423706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0879018306732178
pure train time :  0.7198173999786377
train time :  1.0360028743743896
end to end time :  6.711158037185669
connection check time:  3.222028970718384
block generation time  1.8801093101501465
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005657672882080078
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014504671096801758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46159839630126953
len local_batched_seeds_list  8
partition total batch output list spend :  0.7106540203094482
self.buckets_partition() spend  sec:  0.47614312171936035
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04391169548034668

in edges time spent  0.156172513961792
local to global src and eids time spent  0.3174874782562256
time gen tails  0.08006739616394043
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15617060661315918

in edges time spent  0.7598435878753662
local to global src and eids time spent  1.2375760078430176
time gen tails  0.21889328956604004
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984066009521484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.205175876617432  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.205819129943848  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07560110092163086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.080463886260986  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.081576824188232  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0840754508972168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.118267059326172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.121324062347412  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07948493957519531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.016115188598633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.017119407653809  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07967472076416016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048248767852783  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049252986907959  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706045150756836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247183799743652  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249003887176514  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09395837783813477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.229577541351318  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233005523681641  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09203290939331055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.883731842041016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8855414390563965  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09652090072631836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0855112075805664
pure train time :  0.7224631309509277
train time :  1.0617194175720215
end to end time :  7.091853141784668
connection check time:  3.4180495738983154
block generation time  1.8851337432861328
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004544258117675781
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01617121696472168
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4621467590332031
len local_batched_seeds_list  8
partition total batch output list spend :  0.7373759746551514
self.buckets_partition() spend  sec:  0.47835326194763184
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.048211097717285156

in edges time spent  0.16004681587219238
local to global src and eids time spent  0.20458030700683594
time gen tails  0.06499457359313965
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.16383576393127441

in edges time spent  0.8347017765045166
local to global src and eids time spent  0.8636682033538818
time gen tails  0.17245841026306152
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08015823364257812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.212955951690674  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2126874923706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07532072067260742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051528453826904  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.05275821685791  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.084228515625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.125857353210449  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1289143562316895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07934808731079102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.019414901733398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020422458648682  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07969379425048828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043261528015137  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04426908493042  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870513916015625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254995346069336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.256910800933838  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09406805038452148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242021083831787  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245449066162109  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09230661392211914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90749979019165  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.909808158874512  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09589815139770508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.087267279624939
pure train time :  0.7326703071594238
train time :  1.064204216003418
end to end time :  6.678480386734009
connection check time:  2.9682393074035645
block generation time  1.8939001560211182
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004961490631103516
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015643596649169922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4405033588409424
len local_batched_seeds_list  8
partition total batch output list spend :  0.5729985237121582
self.buckets_partition() spend  sec:  0.4561772346496582
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046926259994506836

in edges time spent  0.1580655574798584
local to global src and eids time spent  0.3394021987915039
time gen tails  0.08202338218688965
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15692901611328125

in edges time spent  0.7961478233337402
local to global src and eids time spent  1.237107276916504
time gen tails  0.2188100814819336
res  length 8
block collection to dataloader spend  1.9311904907226562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984018325805664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218193531036377  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218601703643799  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07558631896972656  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.073006629943848  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074945449829102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839838981628418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.102440357208252  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.105497360229492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07946157455444336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.027967929840088  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.028961181640625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07973289489746094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047303676605225  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049213409423828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706140518188477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.232714653015137  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234676837921143  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09433650970458984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234473705291748  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.23790168762207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09277820587158203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907526969909668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.909579753875732  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09594917297363281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0847516059875488
pure train time :  0.7305481433868408
train time :  1.0593256950378418
end to end time :  7.023863792419434
connection check time:  3.486642360687256
block generation time  1.8864693641662598
Run 00 | Epoch 00155 | Loss 1.0848 | Test 0.6266
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00045752525329589844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014904975891113281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48656558990478516
len local_batched_seeds_list  8
partition total batch output list spend :  0.7614498138427734
self.buckets_partition() spend  sec:  0.5015029907226562
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04678034782409668

in edges time spent  0.16234993934631348
local to global src and eids time spent  0.3200953006744385
time gen tails  0.08255267143249512
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15890812873840332

in edges time spent  0.8558993339538574
local to global src and eids time spent  1.238720417022705
time gen tails  0.21900033950805664
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798344612121582  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.204739570617676  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.204470157623291  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0752859115600586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070821285247803  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071934223175049  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08403396606445312  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.098385810852051  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.101442813873291  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07992172241210938  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034963607788086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035971164703369  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796513557434082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036962985992432  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037991046905518  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08722496032714844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2520647048950195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253983020782471  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09407615661621094  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253167629241943  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.256595611572266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09195280075073242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.896988868713379  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898458957672119  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09581232070922852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0831573009490967
pure train time :  0.7215061187744141
train time :  1.0585753917694092
end to end time :  7.260200262069702
connection check time:  3.533867120742798
block generation time  1.8871839046478271
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005595684051513672
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014490127563476562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49466776847839355
len local_batched_seeds_list  8
partition total batch output list spend :  0.7726993560791016
self.buckets_partition() spend  sec:  0.5091941356658936
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04449462890625

in edges time spent  0.15606451034545898
local to global src and eids time spent  0.3178234100341797
time gen tails  0.08115983009338379
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1568622589111328

in edges time spent  0.7986042499542236
local to global src and eids time spent  1.2418668270111084
time gen tails  0.21822428703308105
res  length 8
block collection to dataloader spend  1.7881393432617188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983255386352539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216050148010254  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2157816886901855  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07570743560791016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074732303619385  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076671123504639  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08420133590698242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.119053840637207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.122110843658447  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07937002182006836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.002753734588623  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.003761291503906  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07975149154663086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048999786376953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050007343292236  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08709716796875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254161357879639  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255952835083008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09393787384033203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237177848815918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24060583114624  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09265756607055664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.873366355895996  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8752217292785645  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09581232070922852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0807900428771973
pure train time :  0.7565438747406006
train time :  1.090575933456421
end to end time :  7.2209978103637695
connection check time:  3.4631175994873047
block generation time  1.879948377609253
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004837512969970703
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014587640762329102
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49096226692199707
len local_batched_seeds_list  8
partition total batch output list spend :  0.771289587020874
self.buckets_partition() spend  sec:  0.5055837631225586
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04731130599975586

in edges time spent  0.15441608428955078
local to global src and eids time spent  0.3188645839691162
time gen tails  0.08009672164916992
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15716862678527832

in edges time spent  0.7109336853027344
local to global src and eids time spent  1.0326306819915771
time gen tails  0.18036437034606934
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983970642089844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217243194580078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21697473526001  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07548999786376953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076446056365967  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077795028686523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08429622650146484  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.122348785400391  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.125405788421631  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07957649230957031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025024890899658  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026029586791992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07977771759033203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041599750518799  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042604446411133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870676040649414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252073287963867  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2539753913879395  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09404754638671875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.230343818664551  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233771800994873  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09231138229370117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.86937952041626  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.871164321899414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09624147415161133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.077618956565857
pure train time :  0.7241010665893555
train time :  1.052353858947754
end to end time :  6.8407158851623535
connection check time:  3.131606340408325
block generation time  1.8723137378692627
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004730224609375
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016095399856567383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4983863830566406
len local_batched_seeds_list  8
partition total batch output list spend :  0.6302447319030762
self.buckets_partition() spend  sec:  0.5145273208618164
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.041413068771362305

in edges time spent  0.1519467830657959
local to global src and eids time spent  0.26726436614990234
time gen tails  0.06987428665161133
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1620786190032959

in edges time spent  0.7713043689727783
local to global src and eids time spent  1.2454299926757812
time gen tails  0.22002577781677246
res  length 8
block collection to dataloader spend  1.6927719116210938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008289337158203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.188679218292236  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.188410758972168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554006576538086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.083789825439453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.084902763366699  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08497285842895508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120988845825195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1240458488464355  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0794363021850586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02147102355957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022472858428955  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961273193359375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038801193237305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039801120758057  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702659606933594  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244312763214111  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246106147766113  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09394693374633789  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250120639801025  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253548622131348  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09237241744995117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8743815422058105  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.876310348510742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09595632553100586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0798120498657227
pure train time :  0.7830476760864258
train time :  1.1222546100616455
end to end time :  7.057320833206177
connection check time:  3.3766660690307617
block generation time  1.913332462310791
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005095005035400391
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016446828842163086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5096733570098877
len local_batched_seeds_list  8
partition total batch output list spend :  0.7600173950195312
self.buckets_partition() spend  sec:  0.5261540412902832
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04723048210144043

in edges time spent  0.15802311897277832
local to global src and eids time spent  0.23529982566833496
time gen tails  0.05409955978393555
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10840344429016113

in edges time spent  0.7751593589782715
local to global src and eids time spent  0.747967004776001
time gen tails  0.1409764289855957
res  length 8
block collection to dataloader spend  2.0265579223632812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983875274658203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222679138183594  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222410202026367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07555675506591797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076946258544922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078212261199951  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08481359481811523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.124152183532715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127209186553955  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945728302001953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.006219387054443  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.007214069366455  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961416244506836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051297664642334  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.052297115325928  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08792924880981445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2397637367248535  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241665840148926  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09406328201293945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.237673759460449  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2411017417907715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09206914901733398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899390697479248  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901116371154785  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09593915939331055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0761654376983643
pure train time :  0.7098274230957031
train time :  1.0646929740905762
end to end time :  5.727649211883545
connection check time:  2.471362829208374
block generation time  1.4170920848846436
Run 00 | Epoch 00160 | Loss 1.0762 | Test 0.6231
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004901885986328125
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015260934829711914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5360581874847412
len local_batched_seeds_list  8
partition total batch output list spend :  0.8198370933532715
self.buckets_partition() spend  sec:  0.5513558387756348
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.05095028877258301

in edges time spent  0.16176104545593262
local to global src and eids time spent  0.3337111473083496
time gen tails  0.08358120918273926
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15969181060791016

in edges time spent  0.7917914390563965
local to global src and eids time spent  1.0473904609680176
time gen tails  0.18735480308532715
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052682876586914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215120792388916  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2148518562316895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07557344436645508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0732808113098145  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074402809143066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08397197723388672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.098168849945068  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.101225852966309  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961511611938477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041658878326416  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042666435241699  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07938194274902344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.029960632324219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0309600830078125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703088760375977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227483749389648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.229607582092285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362220764160156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2453293800354  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248757362365723  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0920262336730957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899458408355713  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.901535987854004  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09588956832885742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0793921947479248
pure train time :  0.7126882076263428
train time :  1.050767183303833
end to end time :  7.061047554016113
connection check time:  3.2676870822906494
block generation time  1.9030725955963135
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005583763122558594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0160520076751709
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48641109466552734
len local_batched_seeds_list  8
partition total batch output list spend :  0.6462149620056152
self.buckets_partition() spend  sec:  0.5024967193603516
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.05045199394226074

in edges time spent  0.15886616706848145
local to global src and eids time spent  0.31917762756347656
time gen tails  0.08048009872436523
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15839743614196777

in edges time spent  0.7971048355102539
local to global src and eids time spent  1.232677698135376
time gen tails  0.217879056930542
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052682876586914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.223328590393066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.22305965423584  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.075439453125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.061585426330566  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06352424621582  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08409309387207031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1090569496154785  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112321853637695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07959508895874023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.030139446258545  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.031147003173828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961750030517578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0428643226623535  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04387092590332  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870218276977539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236423492431641  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238532543182373  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362983703613281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251912593841553  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255340576171875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09277868270874023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.895525932312012  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.897382736206055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.096038818359375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0746246576309204
pure train time :  0.7351541519165039
train time :  1.0636260509490967
end to end time :  7.073518514633179
connection check time:  3.4656195640563965
block generation time  1.8785710334777832
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005154609680175781
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014526605606079102
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46635937690734863
len local_batched_seeds_list  8
partition total batch output list spend :  0.740687370300293
self.buckets_partition() spend  sec:  0.48091983795166016
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04382753372192383

in edges time spent  0.15308332443237305
local to global src and eids time spent  0.3164997100830078
time gen tails  0.0801231861114502
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15790677070617676

in edges time spent  0.7558426856994629
local to global src and eids time spent  1.2336349487304688
time gen tails  0.21655726432800293
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984304428100586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218053340911865  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.217785358428955  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07536458969116211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075162410736084  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077212810516357  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0840444564819336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111544609069824  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1146016120910645  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07963800430297852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02474308013916  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025750637054443  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07951021194458008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.030297756195068  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.031327724456787  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705615997314453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245334148406982  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247254371643066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0940561294555664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.205575466156006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.208887100219727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09217214584350586  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907857894897461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.909876346588135  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09623289108276367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0750219821929932
pure train time :  0.7175586223602295
train time :  1.0442941188812256
end to end time :  7.0766332149505615
connection check time:  3.4069058895111084
block generation time  1.8693733215332031
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004589557647705078
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014555215835571289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3746659755706787
len local_batched_seeds_list  8
partition total batch output list spend :  0.6522150039672852
self.buckets_partition() spend  sec:  0.38926100730895996
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044220924377441406

in edges time spent  0.15294933319091797
local to global src and eids time spent  0.30730533599853516
time gen tails  0.07349467277526855
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.20365142822265625

in edges time spent  0.7689850330352783
local to global src and eids time spent  1.2670989036560059
time gen tails  0.24037551879882812
res  length 8
block collection to dataloader spend  2.5033950805664062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08030033111572266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.181265830993652  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.181637287139893  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07553625106811523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0678863525390625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069006443023682  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402061462402344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112960338592529  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1160173416137695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0797271728515625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021902561187744  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022910118103027  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795755386352539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037217140197754  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.03824520111084  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870518684387207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250638961791992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252486705780029  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09262561798095703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224077224731445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227505207061768  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09283113479614258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.884920597076416  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.886646270751953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09622383117675781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0719014406204224
pure train time :  0.7408945560455322
train time :  1.0883734226226807
end to end time :  7.326387166976929
connection check time:  3.550482988357544
block generation time  2.020267963409424
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005080699920654297
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017006635665893555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5123648643493652
len local_batched_seeds_list  8
partition total batch output list spend :  0.7371554374694824
self.buckets_partition() spend  sec:  0.5294101238250732
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04472827911376953

in edges time spent  0.17480754852294922
local to global src and eids time spent  0.3190772533416748
time gen tails  0.08202457427978516
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15613746643066406

in edges time spent  0.8456888198852539
local to global src and eids time spent  1.2913239002227783
time gen tails  0.2399885654449463
res  length 8
block collection to dataloader spend  2.2649765014648438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08007240295410156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2160186767578125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21669864654541  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07545280456542969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.063814640045166  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.064929962158203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08403921127319336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.085164546966553  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.088294982910156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07949209213256836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02217960357666  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0231828689575195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796041488647461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045050621032715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046051979064941  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08708572387695312  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246242046356201  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248152732849121  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09435462951660156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.236260414123535  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239688396453857  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09279537200927734  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900673866271973  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90239953994751  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09619998931884766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.072824239730835
pure train time :  0.7257249355316162
train time :  1.0674643516540527
end to end time :  7.431968450546265
connection check time:  3.7046055793762207
block generation time  1.904402732849121
Run 00 | Epoch 00165 | Loss 1.0728 | Test 0.6244
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048613548278808594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016402006149291992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3550870418548584
len local_batched_seeds_list  8
partition total batch output list spend :  0.4846618175506592
self.buckets_partition() spend  sec:  0.371523380279541
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044306278228759766

in edges time spent  0.16161036491394043
local to global src and eids time spent  0.19709134101867676
time gen tails  0.0503687858581543
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10716605186462402

in edges time spent  0.45741915702819824
local to global src and eids time spent  0.7815346717834473
time gen tails  0.22104597091674805
res  length 8
block collection to dataloader spend  1.8358230590820312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008384704589844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2201738357543945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220805644989014  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07541751861572266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06781005859375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069039821624756  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08415794372558594  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127800941467285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130857944488525  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07985782623291016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.054880619049072  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0558881759643555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07954931259155273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013906955718994  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014918327331543  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703088760375977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239559173583984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241472244262695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0940713882446289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.238950252532959  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242378234863281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09185266494750977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900887966156006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.90277099609375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0960383415222168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0721501111984253
pure train time :  0.7390532493591309
train time :  1.078465223312378
end to end time :  5.773093223571777
connection check time:  2.399425983428955
block generation time  1.7936441898345947
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004992485046386719
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015160322189331055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4647550582885742
len local_batched_seeds_list  8
partition total batch output list spend :  0.5549662113189697
self.buckets_partition() spend  sec:  0.4799487590789795
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.027340173721313477

in edges time spent  0.09538507461547852
local to global src and eids time spent  0.3212890625
time gen tails  0.08091545104980469
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15729427337646484

in edges time spent  0.7649047374725342
local to global src and eids time spent  1.2377991676330566
time gen tails  0.2193593978881836
res  length 8
block collection to dataloader spend  1.3113021850585938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08015060424804688  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.170876979827881  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.170948505401611  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07528543472290039  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077522277832031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079514980316162  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08428573608398438  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.124353408813477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127410411834717  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795893669128418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021307945251465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022315502166748  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07949972152709961  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041371822357178  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042852401733398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08710527420043945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244482517242432  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246258735656738  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09393548965454102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2564826011657715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.259476661682129  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0917658805847168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.878843784332275  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.880313873291016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09583711624145508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0643341541290283
pure train time :  0.7229008674621582
train time :  1.048933506011963
end to end time :  6.848195791244507
connection check time:  3.3476309776306152
block generation time  1.8838040828704834
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004642009735107422
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016382217407226562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44359254837036133
len local_batched_seeds_list  8
partition total batch output list spend :  0.7228083610534668
self.buckets_partition() spend  sec:  0.4600038528442383
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04420804977416992

in edges time spent  0.15322136878967285
local to global src and eids time spent  0.3179445266723633
time gen tails  0.08089423179626465
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15807890892028809

in edges time spent  0.7614214420318604
local to global src and eids time spent  1.2345318794250488
time gen tails  0.21754693984985352
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983875274658203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214935779571533  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214666843414307  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07523202896118164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069157600402832  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070270538330078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396768569946289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.103816032409668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.106873035430908  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07941722869873047  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.030876159667969  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.031883716583252  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07957887649536133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040497779846191  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041505336761475  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08703756332397461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248571395874023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250305652618408  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0938863754272461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242743492126465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245737552642822  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09214925765991211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.87795877456665  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.87974739074707  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09599733352661133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0684771537780762
pure train time :  0.6621317863464355
train time :  1.0217244625091553
end to end time :  7.058274269104004
connection check time:  3.418224573135376
block generation time  1.8830113410949707
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004515647888183594
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014472723007202148
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4691598415374756
len local_batched_seeds_list  8
partition total batch output list spend :  0.7458970546722412
self.buckets_partition() spend  sec:  0.4836692810058594
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044438838958740234

in edges time spent  0.14447522163391113
local to global src and eids time spent  0.11885333061218262
time gen tails  0.05131983757019043
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10828256607055664

in edges time spent  0.44164609909057617
local to global src and eids time spent  1.0574383735656738
time gen tails  0.22617149353027344
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08010578155517578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220246315002441  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219977378845215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07533407211303711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.06696081161499  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068073749542236  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402061462402344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1088385581970215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111895561218262  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07949018478393555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034584045410156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035590648651123  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07960128784179688  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.050477027893066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.051483631134033  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704471588134766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246757507324219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248495578765869  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09386777877807617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.189868450164795  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.19287109375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09174299240112305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.876771450042725  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.878241539001465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09582376480102539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0678027868270874
pure train time :  0.6674301624298096
train time :  1.0337204933166504
end to end time :  6.213585138320923
connection check time:  2.5961804389953613
block generation time  1.8178293704986572
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004451274871826172
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01551365852355957
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.465162992477417
len local_batched_seeds_list  8
partition total batch output list spend :  0.7419688701629639
self.buckets_partition() spend  sec:  0.48070693016052246
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046761512756347656

in edges time spent  0.15833330154418945
local to global src and eids time spent  0.31787896156311035
time gen tails  0.08204388618469238
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15955376625061035

in edges time spent  0.7677314281463623
local to global src and eids time spent  1.236975908279419
time gen tails  0.21846508979797363
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983875274658203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21396017074585  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.213691711425781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07518386840820312  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.074943542480469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0770158767700195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08427762985229492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.13238525390625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.13544225692749  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956171035766602  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014928340911865  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.015935897827148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965421676635742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044668197631836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045713901519775  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707523345947266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248214244842529  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250007629394531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09393596649169922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2272725105285645  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.230700492858887  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09269952774047852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.870791435241699  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872657299041748  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09655952453613281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0643917322158813
pure train time :  0.6646971702575684
train time :  1.0135841369628906
end to end time :  7.089133977890015
connection check time:  3.435918092727661
block generation time  1.8792610168457031
Run 00 | Epoch 00170 | Loss 1.0644 | Test 0.6222
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00045228004455566406
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016146183013916016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4923124313354492
len local_batched_seeds_list  8
partition total batch output list spend :  0.771303653717041
self.buckets_partition() spend  sec:  0.5084984302520752
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04697155952453613

in edges time spent  0.16296148300170898
local to global src and eids time spent  0.33283138275146484
time gen tails  0.08331418037414551
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15789246559143066

in edges time spent  0.8350327014923096
local to global src and eids time spent  1.246368408203125
time gen tails  0.22020721435546875
res  length 8
block collection to dataloader spend  1.3589859008789062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08017635345458984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214625835418701  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214357852935791  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07554197311401367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.07700777053833  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.079092979431152  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08398580551147461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.110318183898926  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113375186920166  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07978010177612305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.004072666168213  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.005080223083496  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07968425750732422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04172945022583  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042737007141113  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705997467041016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253581523895264  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255161285400391  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09371280670166016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.199451923370361  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.202879905700684  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09288549423217773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8977813720703125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899808406829834  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09641504287719727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0641809701919556
pure train time :  0.6728146076202393
train time :  1.029123067855835
end to end time :  7.261844158172607
connection check time:  3.5364646911621094
block generation time  1.901594877243042
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004856586456298828
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014554023742675781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4825558662414551
len local_batched_seeds_list  8
partition total batch output list spend :  0.767960786819458
self.buckets_partition() spend  sec:  0.4971425533294678
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04877877235412598

in edges time spent  0.15798497200012207
local to global src and eids time spent  0.32767629623413086
time gen tails  0.08101606369018555
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15613555908203125

in edges time spent  0.7889924049377441
local to global src and eids time spent  1.247473955154419
time gen tails  0.21745014190673828
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0801849365234375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2142157554626465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2139458656311035  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07535934448242188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075188159942627  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076417922973633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08405637741088867  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.124140739440918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.127197742462158  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07939577102661133  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.986710548400879  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.987718105316162  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964515686035156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047038555145264  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048046112060547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08706951141357422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241352081298828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2432732582092285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09406805038452148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242478370666504  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245906352996826  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09225320816040039  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904721736907959  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906191825866699  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09585046768188477  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0669218301773071
pure train time :  0.662468433380127
train time :  1.008251428604126
end to end time :  7.149499177932739
connection check time:  3.475405693054199
block generation time  1.8797180652618408
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004966259002685547
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014312744140625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4924800395965576
len local_batched_seeds_list  8
partition total batch output list spend :  0.7715749740600586
self.buckets_partition() spend  sec:  0.5068244934082031
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044661521911621094

in edges time spent  0.1536257266998291
local to global src and eids time spent  0.31480908393859863
time gen tails  0.08028912544250488
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15527653694152832

in edges time spent  0.7608053684234619
local to global src and eids time spent  1.251145839691162
time gen tails  0.2268993854522705
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08076858520507812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21657657623291  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.216307163238525  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07562780380249023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.082286834716797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.083405017852783  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0845646858215332  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1016693115234375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.104726314544678  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08031702041625977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021377086639404  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0223846435546875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07944393157958984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0355987548828125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036606311798096  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870356559753418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249296188354492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2509846687316895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09383678436279297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2355828285217285  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239010810852051  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09266090393066406  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872245788574219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8740763664245605  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09625768661499023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.063034176826477
pure train time :  0.6774230003356934
train time :  1.0429437160491943
end to end time :  7.151492118835449
connection check time:  3.4418857097625732
block generation time  1.8775920867919922
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004851818084716797
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01628708839416504
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46671438217163086
len local_batched_seeds_list  8
partition total batch output list spend :  0.7455165386199951
self.buckets_partition() spend  sec:  0.48303937911987305
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0469210147857666

in edges time spent  0.16248273849487305
local to global src and eids time spent  0.24254250526428223
time gen tails  0.08299756050109863
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15845346450805664

in edges time spent  0.8728504180908203
local to global src and eids time spent  1.2449142932891846
time gen tails  0.2172870635986328
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08017683029174805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220786094665527  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221195220947266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07560300827026367  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069913864135742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.071852684020996  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08396577835083008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.09286642074585  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.09592342376709  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07954740524291992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.002024173736572  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0030317306518555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07950305938720703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.043774127960205  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044781684875488  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707952499389648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.229035377502441  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.231166362762451  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361553192138672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245165824890137  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248593807220459  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09273052215576172  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905098915100098  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906951427459717  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09615230560302734  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0596140623092651
pure train time :  0.7259078025817871
train time :  1.0546655654907227
end to end time :  7.183644771575928
connection check time:  3.477987766265869
block generation time  1.8818244934082031
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004792213439941406
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01761937141418457
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46668338775634766
len local_batched_seeds_list  8
partition total batch output list spend :  0.700875997543335
self.buckets_partition() spend  sec:  0.48433446884155273
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04718375205993652

in edges time spent  0.1697230339050293
local to global src and eids time spent  0.3161618709564209
time gen tails  0.0810556411743164
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15519070625305176

in edges time spent  0.7586464881896973
local to global src and eids time spent  1.2400140762329102
time gen tails  0.22234869003295898
res  length 8
block collection to dataloader spend  2.09808349609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008909225463867  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2063117027282715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.206042766571045  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07568883895874023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077232837677002  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.078489303588867  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08480501174926758  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.098739147186279  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1017961502075195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07973909378051758  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021824836730957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.02283239364624  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07961463928222656  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.033388137817383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.034395694732666  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704853057861328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246086597442627  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247818946838379  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09387636184692383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.225533962249756  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.228961944580078  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09281682968139648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.915572643280029  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9170427322387695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09598779678344727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.057278037071228
pure train time :  0.745628833770752
train time :  1.0847010612487793
end to end time :  7.141775131225586
connection check time:  3.4544272422790527
block generation time  1.8872113227844238
Run 00 | Epoch 00175 | Loss 1.0573 | Test 0.6273
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048041343688964844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01622462272644043
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47577404975891113
len local_batched_seeds_list  8
partition total batch output list spend :  0.603884220123291
self.buckets_partition() spend  sec:  0.492034912109375
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.030026674270629883

in edges time spent  0.0941457748413086
local to global src and eids time spent  0.11760973930358887
time gen tails  0.051308631896972656
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.10854983329772949

in edges time spent  0.4603869915008545
local to global src and eids time spent  0.5213336944580078
time gen tails  0.13920950889587402
res  length 8
block collection to dataloader spend  1.4543533325195312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984018325805664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222675323486328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.222405910491943  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07534551620483398  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.065724849700928  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.067079544067383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08410501480102539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.112382411956787  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.115439414978027  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0794525146484375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022789001464844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023796558380127  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07957220077514648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.04412317276001  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.045130729675293  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707380294799805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.241413593292236  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2434892654418945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09425973892211914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234934329986572  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2383623123168945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0927581787109375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.898776054382324  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900501728057861  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09592628479003906  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0596389770507812
pure train time :  0.7422606945037842
train time :  1.093503475189209
end to end time :  4.910081624984741
connection check time:  1.721266746520996
block generation time  1.4681580066680908
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048279762268066406
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01549839973449707
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4699676036834717
len local_batched_seeds_list  8
partition total batch output list spend :  0.7578089237213135
self.buckets_partition() spend  sec:  0.48549866676330566
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0486147403717041

in edges time spent  0.1686699390411377
local to global src and eids time spent  0.3333926200866699
time gen tails  0.08349251747131348
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15657877922058105

in edges time spent  0.80124831199646
local to global src and eids time spent  1.2683780193328857
time gen tails  0.22180485725402832
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08052682876586914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.220857620239258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221266269683838  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07568025588989258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075441837310791  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076556205749512  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08408546447753906  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.104472637176514  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.107529640197754  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947063446044922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0183281898498535  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.019325256347656  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0796661376953125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047465801239014  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048505783081055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702754974365234  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233949184417725  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2360734939575195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362125396728516  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224494457244873  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227922439575195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09282970428466797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8741536140441895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.87601375579834  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09598827362060547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.055995225906372
pure train time :  0.7680497169494629
train time :  1.0905792713165283
end to end time :  7.307256460189819
connection check time:  3.538318634033203
block generation time  1.9024717807769775
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005152225494384766
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015281200408935547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4667990207672119
len local_batched_seeds_list  8
partition total batch output list spend :  0.746084451675415
self.buckets_partition() spend  sec:  0.48211240768432617
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04709148406982422

in edges time spent  0.15641045570373535
local to global src and eids time spent  0.32236218452453613
time gen tails  0.08092761039733887
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15784597396850586

in edges time spent  0.753807544708252
local to global src and eids time spent  1.2405993938446045
time gen tails  0.21970582008361816
res  length 8
block collection to dataloader spend  1.9311904907226562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07982635498046875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.176602363586426  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.176333427429199  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07536792755126953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069016933441162  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070129871368408  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08403730392456055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.096182823181152  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.099271774291992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07941436767578125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014767169952393  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.015774726867676  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07953119277954102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046757221221924  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047764778137207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08707809448242188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.251342296600342  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253190040588379  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09362363815307617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.239329814910889  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242757797241211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09229135513305664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9063873291015625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907857418060303  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09587812423706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0576119422912598
pure train time :  0.7267656326293945
train time :  1.0649840831756592
end to end time :  7.165967702865601
connection check time:  3.426469087600708
block generation time  1.9100115299224854
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005171298980712891
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014515161514282227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4123725891113281
len local_batched_seeds_list  8
partition total batch output list spend :  0.6791102886199951
self.buckets_partition() spend  sec:  0.4269297122955322
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.046074628829956055

in edges time spent  0.132521390914917
local to global src and eids time spent  0.30010437965393066
time gen tails  0.08658123016357422
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1580502986907959

in edges time spent  0.741138219833374
local to global src and eids time spent  1.2308571338653564
time gen tails  0.21882104873657227
res  length 8
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08076810836791992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215077877044678  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214808940887451  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07574319839477539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075642108917236  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.076972007751465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404827117919922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.128416538238525  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.131473541259766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07939338684082031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.005970001220703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.006977558135986  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0797739028930664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048679351806641  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049686908721924  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870370864868164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2492265701293945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250862121582031  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09422159194946289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.249363899230957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252791881561279  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09213733673095703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.872972011566162  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875280380249023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09637975692749023  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0562167167663574
pure train time :  0.7410366535186768
train time :  1.083702802658081
end to end time :  7.0409064292907715
connection check time:  3.364518642425537
block generation time  1.8966987133026123
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005474090576171875
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015850305557250977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5042147636413574
len local_batched_seeds_list  8
partition total batch output list spend :  0.6967568397521973
self.buckets_partition() spend  sec:  0.5201003551483154
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0503697395324707

in edges time spent  0.16217756271362305
local to global src and eids time spent  0.34737586975097656
time gen tails  0.08427667617797852
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15815281867980957

in edges time spent  0.8470203876495361
local to global src and eids time spent  1.2542483806610107
time gen tails  0.2220289707183838
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08023452758789062  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2213921546936035  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.221123695373535  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07552289962768555  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.081416606903076  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.082646369934082  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839834213256836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.099290370941162  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.102416038513184  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07971763610839844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.035377025604248  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.036384582519531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07966995239257812  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.046363353729248  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047370910644531  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704757690429688  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247008800506592  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2486114501953125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09374237060546875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215578079223633  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219006061553955  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09191226959228516  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877488613128662  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.879796981811523  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09659576416015625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0539989471435547
pure train time :  0.7337274551391602
train time :  1.0608224868774414
end to end time :  7.264657258987427
connection check time:  3.576611042022705
block generation time  1.9032971858978271
Run 00 | Epoch 00180 | Loss 1.0540 | Test 0.6242
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048804283142089844
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015084505081176758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3756418228149414
len local_batched_seeds_list  8
partition total batch output list spend :  0.6717274188995361
self.buckets_partition() spend  sec:  0.39075803756713867
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.05307149887084961

in edges time spent  0.16677141189575195
local to global src and eids time spent  0.32196664810180664
time gen tails  0.08332490921020508
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15724563598632812

in edges time spent  0.8051316738128662
local to global src and eids time spent  1.2932000160217285
time gen tails  0.2276902198791504
res  length 8
block collection to dataloader spend  1.9073486328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0803232192993164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.212862014770508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.212615966796875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07539081573486328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0742268562316895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0753397941589355  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08408594131469727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1149091720581055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.117966175079346  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08013105392456055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022093772888184  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023101329803467  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07965660095214844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038735866546631  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039743423461914  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702993392944336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242691516876221  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244603157043457  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09405899047851562  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.240612030029297  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244040012359619  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09206724166870117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.903501510620117  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.904991626739502  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09594011306762695  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0528554916381836
pure train time :  0.73396897315979
train time :  1.0780277252197266
end to end time :  7.355122327804565
connection check time:  3.6484243869781494
block generation time  1.93459153175354
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0006046295166015625
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015783309936523438
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.483673095703125
len local_batched_seeds_list  8
partition total batch output list spend :  0.6731150150299072
self.buckets_partition() spend  sec:  0.49950075149536133
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04473471641540527

in edges time spent  0.17780542373657227
local to global src and eids time spent  0.31591320037841797
time gen tails  0.08123302459716797
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15979290008544922

in edges time spent  0.8072547912597656
local to global src and eids time spent  1.2706904411315918
time gen tails  0.23446917533874512
res  length 8
block collection to dataloader spend  2.4557113647460938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983827590942383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215478897094727  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.215770721435547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07529830932617188  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070887088775635  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072070598602295  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08414316177368164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.120489597320557  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.123546600341797  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07944631576538086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.025546550750732  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.026554107666016  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07968473434448242  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049305438995361  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0503764152526855  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0871124267578125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.250751495361328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252537250518799  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09393596649169922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244466304779053  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247468948364258  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09183311462402344  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.900852680206299  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.902665138244629  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09586763381958008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0566699504852295
pure train time :  0.7357666492462158
train time :  1.0825254917144775
end to end time :  7.277319431304932
connection check time:  3.5638771057128906
block generation time  1.9389104843139648
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00048422813415527344
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0169525146484375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47221922874450684
len local_batched_seeds_list  8
partition total batch output list spend :  0.7528481483459473
self.buckets_partition() spend  sec:  0.48920750617980957
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044979095458984375

in edges time spent  0.14735007286071777
local to global src and eids time spent  0.31707310676574707
time gen tails  0.0830373764038086
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15676665306091309

in edges time spent  0.8135688304901123
local to global src and eids time spent  1.251394271850586
time gen tails  0.22179627418518066
res  length 8
block collection to dataloader spend  1.4066696166992188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984209060668945  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224996566772461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2256927490234375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07526206970214844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070830345153809  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.072011947631836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08401107788085938  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.103231430053711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.106288433074951  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08021306991577148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0103373527526855  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.011340618133545  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07964086532592773  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.038849353790283  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.039852619171143  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704328536987305  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.25368595123291  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.255441188812256  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.234708786010742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2381367683410645  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09243440628051758  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.9067463874816895  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.908764839172363  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0962824821472168  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0501855611801147
pure train time :  0.7369821071624756
train time :  1.0754084587097168
end to end time :  7.261472463607788
connection check time:  3.493300199508667
block generation time  1.9172859191894531
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.00045800209045410156
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01658010482788086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46504640579223633
len local_batched_seeds_list  8
partition total batch output list spend :  0.7404880523681641
self.buckets_partition() spend  sec:  0.481656551361084
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0469207763671875

in edges time spent  0.16733050346374512
local to global src and eids time spent  0.24222564697265625
time gen tails  0.05906486511230469
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1585228443145752

in edges time spent  0.782228946685791
local to global src and eids time spent  1.053640365600586
time gen tails  0.18733644485473633
res  length 8
block collection to dataloader spend  1.239776611328125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008289337158203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.175359725952148  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.175220489501953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07538318634033203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068892002105713  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.070106029510498  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08426141738891602  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.139523029327393  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.143446922302246  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08038520812988281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.037283897399902  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0382914543151855  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07971572875976562  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048318862915039  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049325466156006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0872030258178711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.233974456787109  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2358222007751465  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09361124038696289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224773406982422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.228201389312744  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09266805648803711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.897724151611328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899536609649658  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09608602523803711  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0496692657470703
pure train time :  0.733039379119873
train time :  1.0980243682861328
end to end time :  6.9309351444244385
connection check time:  3.1477582454681396
block generation time  1.9201254844665527
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005824565887451172
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015709638595581055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5143013000488281
len local_batched_seeds_list  8
partition total batch output list spend :  0.6528947353363037
self.buckets_partition() spend  sec:  0.5300540924072266
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04958462715148926

in edges time spent  0.15744471549987793
local to global src and eids time spent  0.31702184677124023
time gen tails  0.08104991912841797
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.1595616340637207

in edges time spent  0.774003267288208
local to global src and eids time spent  1.2391104698181152
time gen tails  0.22031593322753906
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08008432388305664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.184465408325195  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1848368644714355  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0753021240234375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.081707000732422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.082819938659668  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08405303955078125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.110260963439941  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113317966461182  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07945537567138672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048166275024414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.049173831939697  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07981061935424805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.047177791595459  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.048185348510742  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705472946166992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.252676010131836  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.254393100738525  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0938558578491211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.224009990692139  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.227437973022461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09184885025024414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.875669956207275  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.877494812011719  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09662485122680664  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0494478940963745
pure train time :  0.7314910888671875
train time :  1.0663013458251953
end to end time :  7.083837270736694
connection check time:  3.442049741744995
block generation time  1.9053220748901367
Run 00 | Epoch 00185 | Loss 1.0494 | Test 0.6247
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005068778991699219
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016386985778808594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4732942581176758
len local_batched_seeds_list  8
partition total batch output list spend :  0.6101706027984619
self.buckets_partition() spend  sec:  0.4897165298461914
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04538893699645996

in edges time spent  0.16277837753295898
local to global src and eids time spent  0.31702423095703125
time gen tails  0.08352899551391602
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15816903114318848

in edges time spent  0.8065898418426514
local to global src and eids time spent  1.0946078300476074
time gen tails  0.19077157974243164
res  length 8
block collection to dataloader spend  1.33514404296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08014392852783203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.177096843719482  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.176882743835449  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07525491714477539  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.061938285827637  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0631303787231445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08404016494750977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.10852575302124  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1115827560424805  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07951068878173828  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.028937816619873  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.029945373535156  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08057069778442383  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040477752685547  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041484832763672  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08704805374145508  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2548136711120605  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.25651741027832  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09385108947753906  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244803428649902  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.248231410980225  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0926051139831543  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.897143840789795  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.899173736572266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09575986862182617  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0476994514465332
pure train time :  0.7150650024414062
train time :  1.0641005039215088
end to end time :  6.902261972427368
connection check time:  3.3056609630584717
block generation time  1.9054973125457764
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005755424499511719
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01596808433532715
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44382238388061523
len local_batched_seeds_list  8
partition total batch output list spend :  0.576073408126831
self.buckets_partition() spend  sec:  0.4598405361175537
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04217052459716797

in edges time spent  0.1606905460357666
local to global src and eids time spent  0.2702350616455078
time gen tails  0.0663750171661377
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15874171257019043

in edges time spent  0.7862863540649414
local to global src and eids time spent  1.2491037845611572
time gen tails  0.22894978523254395
res  length 8
block collection to dataloader spend  1.2874603271484375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0798335075378418  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214319705963135  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.214051246643066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0755910873413086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0668487548828125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.068787574768066  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08417224884033203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.113234043121338  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.116291046142578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0801095962524414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.028369903564453  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.029376983642578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0794219970703125  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.040677547454834  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041732311248779  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08705472946166992  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244169235229492  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245930194854736  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09392499923706055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.253619194030762  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.257047176361084  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09233331680297852  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.8946051597595215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.896075248718262  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0959324836730957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0465322732925415
pure train time :  0.7997329235076904
train time :  1.1223888397216797
end to end time :  7.139569997787476
connection check time:  3.4494335651397705
block generation time  1.9714717864990234
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004932880401611328
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015468835830688477
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4700484275817871
len local_batched_seeds_list  8
partition total batch output list spend :  0.7567765712738037
self.buckets_partition() spend  sec:  0.4855496883392334
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.04540681838989258

in edges time spent  0.15657806396484375
local to global src and eids time spent  0.31717491149902344
time gen tails  0.08525466918945312
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15569639205932617

in edges time spent  0.8133678436279297
local to global src and eids time spent  1.27516508102417
time gen tails  0.22479557991027832
res  length 8
block collection to dataloader spend  2.288818359375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07984638214111328  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2261176109313965  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.226526260375977  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0751042366027832  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0679931640625  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.069106101989746  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0839695930480957  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.114399433135986  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.117456436157227  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07947635650634766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.022767543792725  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.023775100708008  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0795278549194336  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.044280529022217  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.0452880859375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08702707290649414  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.235054016113281  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2371344566345215  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0936121940612793  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.219562530517578  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2229905128479  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09271717071533203  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.881341934204102  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.883125305175781  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09613609313964844  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0474472045898438
pure train time :  0.7446422576904297
train time :  1.0774281024932861
end to end time :  7.314068078994751
connection check time:  3.53550124168396
block generation time  1.9201626777648926
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0004680156707763672
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014500856399536133
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49452829360961914
len local_batched_seeds_list  8
partition total batch output list spend :  0.7714638710021973
self.buckets_partition() spend  sec:  0.5090703964233398
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.044301748275756836

in edges time spent  0.15543437004089355
local to global src and eids time spent  0.3249187469482422
time gen tails  0.08132195472717285
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15781784057617188

in edges time spent  0.7529213428497314
local to global src and eids time spent  1.2440223693847656
time gen tails  0.21999812126159668
res  length 8
block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0800938606262207  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.196078777313232  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.195809841156006  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07573413848876953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.075761318206787  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.077700138092041  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08440399169921875  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.130106449127197  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.1331634521484375  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07957601547241211  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.020116806030273  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.021124362945557  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07968378067016602  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.041583061218262  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.042590618133545  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08756780624389648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.2429327964782715  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244573593139648  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09379386901855469  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.242660045623779  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.245662689208984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09195423126220703  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.905822277069092  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907402038574219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09599781036376953  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0439236164093018
pure train time :  0.7366557121276855
train time :  1.0613133907318115
end to end time :  7.199713706970215
connection check time:  3.432023525238037
block generation time  1.9165966510772705
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  8
the grouping_fanout_arxiv called successfully
capacity  1580
 
sorted_dict  {5: 618, 4: 617, 6: 609, 7: 605, 3: 602, 8: 591, 9: 587, 2: 586, 11: 560, 10: 557, 1: 545, 12: 530, 13: 518, 14: 507, 0: 480, 16: 480, 15: 476, 17: 464, 18: 457, 19: 449, 20: 434, 22: 400, 23: 396, 21: 394}

weights after sort [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [586 518 476]

remove bucket_id:  [7, 12, 16]
original bucket_id :,  [2, 13, 15]
remove weights:  [586 518 476], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 586, 560, 557, 545, 530, 518, 507, 480, 480, 476, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
res_tmp  [609 507 464]

remove bucket_id:  [2, 11, 14]
original bucket_id :,  [6, 14, 17]
remove weights:  [609 507 464], 		------------sum 1580

before remove weights,  [618, 617, 609, 605, 602, 591, 587, 560, 557, 545, 530, 507, 480, 480, 464, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
res_tmp  [618 480 480]

remove bucket_id:  [0, 10, 11]
original bucket_id :,  [5, 0, 16]
remove weights:  [618 480 480], 		------------sum 1578

before remove weights,  [618, 617, 605, 602, 591, 587, 560, 557, 545, 530, 480, 480, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
res_tmp  [591 530 457]

remove bucket_id:  [3, 8, 9]
original bucket_id :,  [8, 12, 18]
remove weights:  [591 530 457], 		------------sum 1578

before remove weights,  [617, 605, 602, 591, 587, 560, 557, 545, 530, 457, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
res_tmp  [587 557 434]

remove bucket_id:  [3, 5, 8]
original bucket_id :,  [9, 10, 20]
remove weights:  [587 557 434], 		------------sum 1578

before remove weights,  [617, 605, 602, 587, 560, 557, 545, 449, 434, 400, 396, 394]
after remove pre pack weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
res_tmp  [617 560 400]

remove bucket_id:  [0, 3, 6]
original bucket_id :,  [4, 11, 22]
remove weights:  [617 560 400], 		------------sum 1577

before remove weights,  [617, 605, 602, 560, 545, 449, 400, 396, 394]
after remove pre pack weights,  [605, 602, 545, 449, 396, 394]
res_tmp  [605 545 396]

remove bucket_id:  [0, 2, 4]
original bucket_id :,  [7, 1, 23]
remove weights:  [605 545 396], 		------------sum 1546

before remove weights,  [605, 602, 545, 449, 396, 394]
after remove pre pack weights,  [602, 449, 394]
G_BUCKET_ID_list [[2, 13, 15], [6, 14, 17], [5, 0, 16], [8, 12, 18], [9, 10, 20], [4, 11, 22], [7, 1, 23], [3, 19, 21]]
Groups_mem_list  [[586, 518, 476], [609, 507, 464], [618, 480, 480], [591, 530, 457], [587, 557, 434], [617, 560, 400], [605, 545, 396], [602, 449, 394]]
G_BUCKET_ID_list length 8
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  8
current group_mem  1.5811395189618396
current group_mem  1.5814913056330546
current group_mem  1.5785234047864416
current group_mem  1.5789837227108152
current group_mem  1.5795295993392289
current group_mem  1.5773440880052956
current group_mem  1.5484342143112446
current group_mem  1.446553254634386
batches output list generation spend  0.0005795955657958984
self.weights_list  [0.143004805313335, 0.08208618774810042, 0.22551984253527013, 0.07313532949934573, 0.07369613265743724, 0.10843294003804664, 0.18568082603006344, 0.10844393617840138]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01421809196472168
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4691195487976074
len local_batched_seeds_list  8
partition total batch output list spend :  0.7529499530792236
self.buckets_partition() spend  sec:  0.48337602615356445
layer  0
 the number of batches:  8
check_connections_block*********************************

the find indices time spent  0.0490107536315918

in edges time spent  0.16586828231811523
local to global src and eids time spent  0.32161903381347656
time gen tails  0.08486819267272949
res  length 8
layer  1
num of batch  8
check_connections_block*********************************

the find indices time spent  0.15832138061523438

in edges time spent  0.8329870700836182
local to global src and eids time spent  1.267993450164795
time gen tails  0.22881627082824707
res  length 8
block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07983684539794922  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.21845006942749  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.218181133270264  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07553768157958984  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.084065914154053  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.085295677185059  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.08402347564697266  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.108320236206055  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.111377239227295  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07935428619384766  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.011342525482178  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.012350082397461  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.07956743240356445  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.013647556304932  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.014688491821289  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0870656967163086  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.24501895904541  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.246789455413818  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.0939326286315918  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.244282245635986  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 5.247710227966309  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09249687194824219  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.906010150909424  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 4.907480239868164  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.962890625 GB
    Memory Allocated: 0.09610271453857422  GigaBytes
Max Memory Allocated: 5.375265121459961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0423400402069092
pure train time :  0.7284510135650635
train time :  1.0682077407836914
end to end time :  7.337630987167358
connection check time:  3.570321559906006
block generation time  1.9317519664764404
Run 00 | Epoch 00190 | Loss 1.0423 | Test 0.6266
end to end time  67.817302942276
eval batch size  11368
Run 00 | Epoch 00190 | Loss 1.0423 | Test 0.6266
Total (block generation + training)time/epoch 67.817302942276
pure train time per /epoch  [1.216118574142456, 0.7361698150634766, 0.7572329044342041, 0.729905366897583, 0.7381777763366699, 0.7461512088775635, 0.8187470436096191, 0.7587013244628906, 0.7542109489440918, 0.7617897987365723, 0.782778263092041, 0.7528619766235352, 0.729363203048706, 0.741863489151001, 0.7504348754882812, 0.7522592544555664, 0.7203876972198486, 0.6860795021057129, 0.7351682186126709, 0.8597073554992676, 0.7306132316589355, 0.8574001789093018, 0.7488400936126709, 0.7415275573730469, 0.7275857925415039, 0.7342360019683838, 0.7212924957275391, 0.742753267288208, 0.7221975326538086, 0.7356998920440674, 0.7336807250976562, 0.661583662033081, 0.6721432209014893, 0.7314047813415527, 0.7442080974578857, 0.7345623970031738, 0.7277886867523193, 0.7361879348754883, 0.7038779258728027, 0.7397112846374512, 0.7447659969329834, 0.7366237640380859, 0.797081470489502, 0.7302420139312744, 0.7286965847015381, 0.739457368850708, 0.7194023132324219, 0.7734987735748291, 0.7217471599578857, 0.7213089466094971, 0.7358851432800293, 0.7325754165649414, 0.7464208602905273, 0.657846212387085, 0.7267036437988281, 0.7458381652832031, 0.7266044616699219, 0.7500255107879639, 0.7503440380096436, 0.7199094295501709, 0.7265727519989014, 0.6580407619476318, 0.7397680282592773, 0.7289528846740723, 0.7327122688293457, 0.7474796772003174, 0.7032673358917236, 0.7362825870513916, 0.7486367225646973, 0.7454996109008789, 0.7482419013977051, 0.74700927734375, 0.7397587299346924, 0.7421083450317383, 0.7368996143341064, 0.7580113410949707, 0.6781666278839111, 0.7609727382659912, 0.7451150417327881, 0.7544546127319336, 0.744394063949585, 0.7479372024536133, 0.76487135887146, 0.709768533706665, 0.6592369079589844, 0.6709156036376953, 0.6564583778381348, 0.7781412601470947, 0.7318270206451416, 0.7185847759246826, 0.7520396709442139, 0.724947452545166, 0.6570088863372803, 0.7233409881591797, 0.7460088729858398, 0.6390409469604492, 0.7352557182312012, 0.7359344959259033, 0.737191915512085, 0.7238202095031738, 0.7309341430664062, 0.7460141181945801, 0.7259995937347412, 0.7282111644744873, 0.7319896221160889, 0.7445755004882812, 0.752694845199585, 0.7146010398864746, 0.7339375019073486, 0.8067340850830078, 0.7528188228607178, 0.7469587326049805, 0.7591681480407715, 0.7339050769805908, 0.7500030994415283, 0.7334558963775635, 0.7872514724731445, 0.732532262802124, 0.7203912734985352, 0.7220339775085449, 0.7445378303527832, 0.7319610118865967, 0.7362582683563232, 0.7359297275543213, 0.6470799446105957, 0.7234067916870117, 0.7526705265045166, 0.7262885570526123, 0.7327477931976318, 0.7369654178619385, 0.7354717254638672, 0.741769552230835, 0.7452192306518555, 0.724043607711792, 0.710881233215332, 0.7258148193359375, 0.7407011985778809, 0.7446079254150391, 0.7235152721405029, 0.7398862838745117, 0.7479395866394043, 0.6783127784729004, 0.7291083335876465, 0.74045729637146, 0.7068078517913818, 0.7351803779602051, 0.747361421585083, 0.7390017509460449, 0.727515459060669, 0.7282891273498535, 0.7572510242462158, 0.7417781352996826, 0.7198173999786377, 0.7224631309509277, 0.7326703071594238, 0.7305481433868408, 0.7215061187744141, 0.7565438747406006, 0.7241010665893555, 0.7830476760864258, 0.7098274230957031, 0.7126882076263428, 0.7351541519165039, 0.7175586223602295, 0.7408945560455322, 0.7257249355316162, 0.7390532493591309, 0.7229008674621582, 0.6621317863464355, 0.6674301624298096, 0.6646971702575684, 0.6728146076202393, 0.662468433380127, 0.6774230003356934, 0.7259078025817871, 0.745628833770752, 0.7422606945037842, 0.7680497169494629, 0.7267656326293945, 0.7410366535186768, 0.7337274551391602, 0.73396897315979, 0.7357666492462158, 0.7369821071624756, 0.733039379119873, 0.7314910888671875, 0.7150650024414062, 0.7997329235076904, 0.7446422576904297, 0.7366557121276855, 0.7284510135650635]
pure train time average  0.7325627599807985
input num  average  972620.6335078534
