main start at this time 1701290801.9793162
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.0011527538299560547
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015490293502807617
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6278707981109619
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7377493381500244
self.buckets_partition() spend  sec:  0.6433858871459961
check connections block*********************************

the find indices time spent  0.04214978218078613

in edges time spent  0.1542801856994629
local to global src and eids time spent  0.2829248905181885
time gen tails  0.04930758476257324
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.3184785842895508

----------------------------------------
check connections block*********************************

the find indices time spent  0.09068489074707031

in edges time spent  0.3873019218444824
local to global src and eids time spent  0.47515416145324707
time gen tails  0.04901552200317383
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.6397030353546143

block collection to dataloader spend  7.3909759521484375e-06
----------------------------------------------------------pseudo_mini_loss sum 4.018531799316406
pure train time :  0.738391637802124
train time :  1.316220998764038
end to end time :  4.820827007293701
connection check time:  1.7919373512268066
block generation time  0.958181619644165
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.0004711151123046875
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015639066696166992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6339943408966064
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7117810249328613
self.buckets_partition() spend  sec:  0.6496560573577881
check connections block*********************************

the find indices time spent  0.040876150131225586

in edges time spent  0.1396956443786621
local to global src and eids time spent  0.21999812126159668
time gen tails  0.034481048583984375
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.3022756576538086

----------------------------------------
check connections block*********************************

the find indices time spent  0.0861055850982666

in edges time spent  0.3596975803375244
local to global src and eids time spent  0.4808540344238281
time gen tails  0.05009317398071289
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.6298007965087891

block collection to dataloader spend  8.58306884765625e-06
----------------------------------------------------------pseudo_mini_loss sum 3.8344473838806152
pure train time :  0.3371424674987793
train time :  0.4707303047180176
end to end time :  3.7992610931396484
connection check time:  1.6688761711120605
block generation time  0.9320764541625977
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.0005762577056884766
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015354156494140625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5852065086364746
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6637184619903564
self.buckets_partition() spend  sec:  0.6005866527557373
check connections block*********************************

the find indices time spent  0.040198564529418945

in edges time spent  0.09439921379089355
local to global src and eids time spent  0.10029840469360352
time gen tails  0.025595426559448242
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.21619725227355957

----------------------------------------
check connections block*********************************

the find indices time spent  0.053969383239746094

in edges time spent  0.20436859130859375
local to global src and eids time spent  0.17603111267089844
time gen tails  0.03611350059509277
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.4280259609222412

block collection to dataloader spend  6.9141387939453125e-06
----------------------------------------------------------pseudo_mini_loss sum 3.6816253662109375
pure train time :  0.31781435012817383
train time :  0.4429163932800293
end to end time :  2.6152052879333496
connection check time:  0.8518490791320801
block generation time  0.6442232131958008
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.0005040168762207031
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014417886734008789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5072004795074463
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6127471923828125
self.buckets_partition() spend  sec:  0.5217666625976562
check connections block*********************************

the find indices time spent  0.04220414161682129

in edges time spent  0.1521437168121338
local to global src and eids time spent  0.2722480297088623
time gen tails  0.0477595329284668
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.2991297245025635

----------------------------------------
check connections block*********************************

the find indices time spent  0.08796334266662598

in edges time spent  0.36078596115112305
local to global src and eids time spent  0.5146467685699463
time gen tails  0.07270026206970215
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.619837760925293

block collection to dataloader spend  7.867813110351562e-06
----------------------------------------------------------pseudo_mini_loss sum 3.5470449924468994
pure train time :  0.33042073249816895
train time :  0.43977785110473633
end to end time :  3.8014254570007324
connection check time:  1.8096561431884766
block generation time  0.9189674854278564
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.0005197525024414062
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014490604400634766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6181704998016357
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7230720520019531
self.buckets_partition() spend  sec:  0.6326925754547119
check connections block*********************************

the find indices time spent  0.04248547554016113

in edges time spent  0.1526479721069336
local to global src and eids time spent  0.27164292335510254
time gen tails  0.047818899154663086
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.30049896240234375

----------------------------------------
check connections block*********************************

the find indices time spent  0.08852529525756836

in edges time spent  0.35318875312805176
local to global src and eids time spent  0.5148055553436279
time gen tails  0.0726923942565918
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.615715503692627

block collection to dataloader spend  1.5497207641601562e-05
----------------------------------------------------------pseudo_mini_loss sum 3.433201551437378
pure train time :  0.3223588466644287
train time :  0.43957018852233887
end to end time :  3.8965635299682617
connection check time:  1.8031339645385742
block generation time  0.9162144660949707
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.0005154609680175781
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014432430267333984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5937066078186035
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6983959674835205
self.buckets_partition() spend  sec:  0.6081674098968506
check connections block*********************************

the find indices time spent  0.042168378829956055

in edges time spent  0.16250944137573242
local to global src and eids time spent  0.2827599048614502
time gen tails  0.048218727111816406
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.30147218704223633

----------------------------------------
check connections block*********************************

the find indices time spent  0.08725976943969727

in edges time spent  0.35702085494995117
local to global src and eids time spent  0.5247378349304199
time gen tails  0.07267427444458008
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.6134767532348633

block collection to dataloader spend  7.62939453125e-06
----------------------------------------------------------pseudo_mini_loss sum 3.3353586196899414
pure train time :  0.3272228240966797
train time :  0.44443511962890625
end to end time :  3.9143385887145996
connection check time:  1.8430745601654053
block generation time  0.9149489402770996
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.000492095947265625
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014411687850952148
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5935115814208984
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6971871852874756
self.buckets_partition() spend  sec:  0.6079504489898682
check connections block*********************************

the find indices time spent  0.0423126220703125

in edges time spent  0.16839194297790527
local to global src and eids time spent  0.28105616569519043
time gen tails  0.04786038398742676
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.3076803684234619

----------------------------------------
check connections block*********************************

the find indices time spent  0.0929110050201416

in edges time spent  0.4119856357574463
local to global src and eids time spent  0.5511453151702881
time gen tails  0.07216572761535645
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.6144957542419434

block collection to dataloader spend  7.867813110351562e-06
----------------------------------------------------------pseudo_mini_loss sum 3.267354726791382
pure train time :  0.32041478157043457
train time :  0.45969462394714355
end to end time :  4.02980637550354
connection check time:  1.9372670650482178
block generation time  0.9221761226654053
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.0004687309265136719
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014159679412841797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5960164070129395
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7001793384552002
self.buckets_partition() spend  sec:  0.6102030277252197
check connections block*********************************

the find indices time spent  0.042726993560791016

in edges time spent  0.15468406677246094
local to global src and eids time spent  0.2760810852050781
time gen tails  0.04888772964477539
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.31508708000183105

----------------------------------------
check connections block*********************************

the find indices time spent  0.09105777740478516

in edges time spent  0.39391589164733887
local to global src and eids time spent  0.5368578433990479
time gen tails  0.07589292526245117
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.6128325462341309

block collection to dataloader spend  7.3909759521484375e-06
----------------------------------------------------------pseudo_mini_loss sum 3.227663040161133
pure train time :  0.3217802047729492
train time :  0.45034003257751465
end to end time :  3.9798765182495117
connection check time:  1.8870213031768799
block generation time  0.9279196262359619
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.00047516822814941406
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014548063278198242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6041927337646484
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7121107578277588
self.buckets_partition() spend  sec:  0.618767499923706
check connections block*********************************

the find indices time spent  0.04237508773803711

in edges time spent  0.1578075885772705
local to global src and eids time spent  0.2726752758026123
time gen tails  0.04817461967468262
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.300112247467041

----------------------------------------
check connections block*********************************

the find indices time spent  0.0874776840209961

in edges time spent  0.3610091209411621
local to global src and eids time spent  0.5146181583404541
time gen tails  0.07529163360595703
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.6124484539031982

block collection to dataloader spend  7.3909759521484375e-06
----------------------------------------------------------pseudo_mini_loss sum 3.193680763244629
pure train time :  0.31867361068725586
train time :  0.4370615482330322
end to end time :  3.90255069732666
connection check time:  1.8191640377044678
block generation time  0.9125607013702393
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  2
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  2
G_BUCKET_ID_list [[5, 4, 7, 3, 8, 9, 2, 11, 1, 12, 13], [6, 10, 14, 16, 15, 17, 18, 0, 19, 20, 22, 23, 21]]
Groups_mem_list  [[1084, 1081, 1069, 1053, 1048, 1042, 1020, 995, 948, 941, 919], [1073, 989, 900, 855, 849, 827, 818, 813, 802, 776, 715, 710, 706]]
G_BUCKET_ID_list length 2
len(g_bucket_nids_list)  2
len(local_split_batches_nid_list)  2
current group_mem  11.206131434890104
current group_mem  10.840145739729854
batches output list generation spend  0.00047016143798828125
self.weights_list  [0.6399423802245412, 0.3600576197754588]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01418304443359375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5967381000518799
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.700554370880127
self.buckets_partition() spend  sec:  0.6109488010406494
check connections block*********************************

the find indices time spent  0.042505741119384766

in edges time spent  0.15697002410888672
local to global src and eids time spent  0.2729926109313965
time gen tails  0.0480501651763916
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.3029599189758301

----------------------------------------
check connections block*********************************

the find indices time spent  0.08693981170654297

in edges time spent  0.3634676933288574
local to global src and eids time spent  0.5157229900360107
time gen tails  0.07285356521606445
res  length 2

block_gen_time in "generate_blocks_for_one_layer_block"  0.612360954284668

block collection to dataloader spend  8.344650268554688e-06
----------------------------------------------------------pseudo_mini_loss sum 3.152296781539917
pure train time :  0.32025790214538574
train time :  0.4371469020843506
end to end time :  3.8867056369781494
connection check time:  1.8200011253356934
block generation time  0.915320873260498
end to end time  3.953486204147339
Total (block generation + training)time/epoch 3.953486204147339
pure train time per /epoch  [0.738391637802124, 0.3371424674987793, 0.31781435012817383, 0.33042073249816895, 0.3223588466644287, 0.3272228240966797, 0.32041478157043457, 0.3217802047729492, 0.31867361068725586, 0.32025790214538574]
pure train time average  0.3217846949895223
input num  average  310891.4
