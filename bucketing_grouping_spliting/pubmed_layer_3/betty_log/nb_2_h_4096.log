main start at this time 1689568655.084773
  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.199 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.199 GB
Metis partitioning: 0.000 seconds, peak memory: 25.199 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006109476089477539
pure dgl.metis_partition the time spent:  0.002929210662841797
connection checking time:  0.0253140926361084
block generation total time  0.02670001983642578
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.626953125 GB
    Memory Allocated: 2.064272880554199  GigaBytes
Max Memory Allocated: 2.068573474884033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.626953125 GB
    Memory Allocated: 2.064274311065674  GigaBytes
Max Memory Allocated: 2.068573474884033  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 5.384765625 GB
    Memory Allocated: 2.7861132621765137  GigaBytes
Max Memory Allocated: 3.6024417877197266  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 5.384765625 GB
    Memory Allocated: 2.78611421585083  GigaBytes
Max Memory Allocated: 3.6024417877197266  GigaBytes

pure train time  4.967859506607056
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.759765625 GB
    Memory Allocated: 4.59926176071167  GigaBytes
Max Memory Allocated: 5.34926176071167  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.097580075263977
REG start----................................
Convert a graph into a bidirected graph: 0.004 seconds, peak memory: 30.636 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.636 GB
Metis partitioning: 0.000 seconds, peak memory: 30.636 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003951311111450195
pure dgl.metis_partition the time spent:  0.006241798400878906
connection checking time:  0.023984670639038086
block generation total time  0.02564072608947754
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.759765625 GB
    Memory Allocated: 5.324697017669678  GigaBytes
Max Memory Allocated: 5.34926176071167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.759765625 GB
    Memory Allocated: 5.324698448181152  GigaBytes
Max Memory Allocated: 5.34926176071167  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.259765625 GB
    Memory Allocated: 5.277606010437012  GigaBytes
Max Memory Allocated: 6.321401119232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.259765625 GB
    Memory Allocated: 5.277606964111328  GigaBytes
Max Memory Allocated: 6.321401119232178  GigaBytes

pure train time  4.6208202838897705
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.259765625 GB
    Memory Allocated: 4.600543975830078  GigaBytes
Max Memory Allocated: 6.321401119232178  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0976035594940186
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004726409912109375
pure dgl.metis_partition the time spent:  0.002315044403076172
connection checking time:  0.024160146713256836
block generation total time  0.02586817741394043
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.259765625 GB
    Memory Allocated: 5.126314163208008  GigaBytes
Max Memory Allocated: 6.321401119232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.259765625 GB
    Memory Allocated: 5.126315593719482  GigaBytes
Max Memory Allocated: 6.321401119232178  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.48436975479126  GigaBytes
Max Memory Allocated: 6.321401119232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.484370708465576  GigaBytes
Max Memory Allocated: 6.321401119232178  GigaBytes

pure train time  4.556729316711426
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 4.602598667144775  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0985358953475952
loading full batch data spends  0.005620718002319336
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0036878585815429688
pure dgl.metis_partition the time spent:  0.0022253990173339844
connection checking time:  0.024052858352661133
block generation total time  0.025797128677368164
generate_dataloader_block spend   0.06116938591003418
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.39680814743042  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.3968095779418945  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.207253932952881  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.207254886627197  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

pure train time  4.623716115951538
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 4.600339412689209  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0977542400360107
loading full batch data spends  0.0058650970458984375
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004703521728515625
pure dgl.metis_partition the time spent:  0.0023651123046875
connection checking time:  0.02362823486328125
block generation total time  0.0252993106842041
generate_dataloader_block spend   0.061738014221191406
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.3477702140808105  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.347771644592285  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.2443952560424805  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.244396209716797  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

pure train time  4.518698692321777
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 4.600953578948975  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0895559787750244
loading full batch data spends  0.005941152572631836
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005074501037597656
pure dgl.metis_partition the time spent:  0.0020599365234375
connection checking time:  0.023956298828125
block generation total time  0.02569103240966797
generate_dataloader_block spend   0.06171560287475586
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.12955904006958  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.129560470581055  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.461966514587402  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.461967468261719  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

pure train time  4.593188047409058
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 4.601508617401123  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0917143821716309
loading full batch data spends  0.005373954772949219
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003368854522705078
pure dgl.metis_partition the time spent:  0.0021190643310546875
connection checking time:  0.02364349365234375
block generation total time  0.025386810302734375
generate_dataloader_block spend   0.05953812599182129
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.392322540283203  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.392323970794678  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.2063307762146  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.206331729888916  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

pure train time  4.554844617843628
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 4.600223064422607  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0915119647979736
loading full batch data spends  0.0058405399322509766
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00476837158203125
pure dgl.metis_partition the time spent:  0.002272367477416992
connection checking time:  0.024299144744873047
block generation total time  0.02575063705444336
generate_dataloader_block spend   0.06246805191040039
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.267638683319092  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.267640113830566  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.339599132537842  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.339600086212158  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

pure train time  4.689927816390991
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 4.601312637329102  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0954551696777344
loading full batch data spends  0.007838726043701172
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005403280258178711
pure dgl.metis_partition the time spent:  0.0021927356719970703
connection checking time:  0.023715496063232422
block generation total time  0.025585174560546875
generate_dataloader_block spend   0.061849117279052734
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.091095447540283  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26171875 GB
    Memory Allocated: 5.091096878051758  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.267578125 GB
    Memory Allocated: 5.494483470916748  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.267578125 GB
    Memory Allocated: 5.4944844245910645  GigaBytes
Max Memory Allocated: 6.480829238891602  GigaBytes

pure train time  4.549625396728516
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26953125 GB
    Memory Allocated: 4.601790428161621  GigaBytes
Max Memory Allocated: 6.491293907165527  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0937533378601074
loading full batch data spends  0.005050182342529297
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 31.136 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.136 GB
Metis partitioning: 0.000 seconds, peak memory: 31.136 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0031425952911376953
pure dgl.metis_partition the time spent:  0.001979827880859375
connection checking time:  0.023449182510375977
block generation total time  0.024954557418823242
generate_dataloader_block spend   0.057984352111816406
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26953125 GB
    Memory Allocated: 5.119794845581055  GigaBytes
Max Memory Allocated: 6.491293907165527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26953125 GB
    Memory Allocated: 5.119796276092529  GigaBytes
Max Memory Allocated: 6.491293907165527  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.26953125 GB
    Memory Allocated: 5.476059436798096  GigaBytes
Max Memory Allocated: 6.491293907165527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.26953125 GB
    Memory Allocated: 5.476060390472412  GigaBytes
Max Memory Allocated: 6.491293907165527  GigaBytes

pure train time  4.611209869384766
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.26953125 GB
    Memory Allocated: 4.601925849914551  GigaBytes
Max Memory Allocated: 6.491293907165527  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0890119075775146
Total (block generation + training)time/epoch 5.022520235606602
pure train time/epoch 4.586249073346456

num_input_list  [7112, 7318, 7370, 7393, 7179, 7219, 7175, 7494, 7162, 7163]
