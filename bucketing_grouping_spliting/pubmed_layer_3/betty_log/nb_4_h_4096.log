main start at this time 1689568819.0461571
  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.206 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.206 GB
Metis partitioning: 0.000 seconds, peak memory: 25.206 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005408525466918945
pure dgl.metis_partition the time spent:  0.003528118133544922
connection checking time:  0.03257298469543457
block generation total time  0.03426671028137207
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.951171875 GB
    Memory Allocated: 1.4066290855407715  GigaBytes
Max Memory Allocated: 1.4078569412231445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.951171875 GB
    Memory Allocated: 1.406630516052246  GigaBytes
Max Memory Allocated: 1.4078569412231445  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.884765625 GB
    Memory Allocated: 2.961772918701172  GigaBytes
Max Memory Allocated: 3.0079421997070312  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.884765625 GB
    Memory Allocated: 2.9617738723754883  GigaBytes
Max Memory Allocated: 3.0079421997070312  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 5.634765625 GB
    Memory Allocated: 2.475955009460449  GigaBytes
Max Memory Allocated: 3.9591784477233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 5.634765625 GB
    Memory Allocated: 2.4759559631347656  GigaBytes
Max Memory Allocated: 3.9591784477233887  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 5.634765625 GB
    Memory Allocated: 2.614901542663574  GigaBytes
Max Memory Allocated: 3.9591784477233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 5.634765625 GB
    Memory Allocated: 2.6149024963378906  GigaBytes
Max Memory Allocated: 3.9591784477233887  GigaBytes

pure train time  7.036088705062866
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.384765625 GB
    Memory Allocated: 4.598309516906738  GigaBytes
Max Memory Allocated: 5.348309516906738  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1010276079177856
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 32.189 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 32.189 GB
Metis partitioning: 0.000 seconds, peak memory: 32.189 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003744363784790039
pure dgl.metis_partition the time spent:  0.0028505325317382812
connection checking time:  0.03399348258972168
block generation total time  0.0348811149597168
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.404296875 GB
    Memory Allocated: 5.130300998687744  GigaBytes
Max Memory Allocated: 5.348309516906738  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.404296875 GB
    Memory Allocated: 5.130302429199219  GigaBytes
Max Memory Allocated: 5.348309516906738  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.8037614822387695  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.803762435913086  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.912377834320068  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.912378787994385  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.961472034454346  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.961472988128662  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

pure train time  7.050478458404541
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.599137306213379  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.100809097290039
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 34.784 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.784 GB
Metis partitioning: 0.000 seconds, peak memory: 34.784 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0045680999755859375
pure dgl.metis_partition the time spent:  0.0029692649841308594
connection checking time:  0.03365373611450195
block generation total time  0.03585171699523926
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.970742225646973  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.970743656158447  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.753605365753174  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.75360631942749  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.131340503692627  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.131341457366943  GigaBytes
Max Memory Allocated: 6.127722263336182  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.954599380493164  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.9546003341674805  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

pure train time  6.654250621795654
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.599104881286621  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0976476669311523
loading full batch data spends  0.009201765060424805
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 37.318 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 37.318 GB
Metis partitioning: 0.000 seconds, peak memory: 37.318 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00674891471862793
pure dgl.metis_partition the time spent:  0.0028510093688964844
connection checking time:  0.030518531799316406
block generation total time  0.03628039360046387
generate_dataloader_block spend   0.08490753173828125
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.056041717529297  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.0560431480407715  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.944073677062988  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.944074630737305  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.9301838874816895  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.930184841156006  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.873198986053467  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.873199939727783  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

pure train time  7.007343053817749
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.598301410675049  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0937960147857666
loading full batch data spends  0.009107828140258789
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 39.071 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 39.071 GB
Metis partitioning: 0.000 seconds, peak memory: 39.071 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003520965576171875
pure dgl.metis_partition the time spent:  0.002830028533935547
connection checking time:  0.033167123794555664
block generation total time  0.03592562675476074
generate_dataloader_block spend   0.0844581127166748
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.036281108856201  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.036282539367676  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.922499656677246  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.9225006103515625  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.936095237731934  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.93609619140625  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.915004253387451  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.915005207061768  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

pure train time  7.19243597984314
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.599096298217773  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0998057126998901
loading full batch data spends  0.008530855178833008
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 41.321 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 41.321 GB
Metis partitioning: 0.000 seconds, peak memory: 41.321 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003187417984008789
pure dgl.metis_partition the time spent:  0.0026748180389404297
connection checking time:  0.030298948287963867
block generation total time  0.035062551498413086
generate_dataloader_block spend   0.08175516128540039
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.930583477020264  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.930584907531738  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.7980475425720215  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.798048496246338  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.086019515991211  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.086020469665527  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.987863063812256  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.987864017486572  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

pure train time  6.971323490142822
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.599104881286621  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.09347665309906
loading full batch data spends  0.009074211120605469
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 43.447 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 43.447 GB
Metis partitioning: 0.000 seconds, peak memory: 43.447 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003610849380493164
pure dgl.metis_partition the time spent:  0.002959728240966797
connection checking time:  0.03072500228881836
block generation total time  0.03528618812561035
generate_dataloader_block spend   0.0825204849243164
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.037332057952881  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.0373334884643555  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.943770408630371  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.9437713623046875  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.948601245880127  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.948602199554443  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.878412246704102  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.878413200378418  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

pure train time  7.4163525104522705
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.598299503326416  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.090641975402832
loading full batch data spends  0.00917673110961914
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 45.447 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.447 GB
Metis partitioning: 0.000 seconds, peak memory: 45.447 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004534244537353516
pure dgl.metis_partition the time spent:  0.0028998851776123047
connection checking time:  0.03697347640991211
block generation total time  0.03543400764465332
generate_dataloader_block spend   0.08795523643493652
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.821059703826904  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.821061134338379  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.0466227531433105  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.046623706817627  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.061441898345947  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.061442852020264  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.881515026092529  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.881515979766846  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

pure train time  7.1743059158325195
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.5990891456604  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0875756740570068
loading full batch data spends  0.008556842803955078
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 47.385 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.385 GB
Metis partitioning: 0.000 seconds, peak memory: 47.385 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0030608177185058594
pure dgl.metis_partition the time spent:  0.0025925636291503906
connection checking time:  0.03285574913024902
block generation total time  0.03498101234436035
generate_dataloader_block spend   0.07968020439147949
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.83876895904541  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.838770389556885  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.855168342590332  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.855169296264648  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.152621746063232  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.152622699737549  GigaBytes
Max Memory Allocated: 6.128257751464844  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.948784828186035  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.948785781860352  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

pure train time  7.0414299964904785
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.59909200668335  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0873411893844604
loading full batch data spends  0.009105205535888672
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 49.260 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 49.260 GB
Metis partitioning: 0.000 seconds, peak memory: 49.260 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035712718963623047
pure dgl.metis_partition the time spent:  0.002969503402709961
connection checking time:  0.033364057540893555
block generation total time  0.03508305549621582
generate_dataloader_block spend   0.08473396301269531
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.909319877624512  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.909321308135986  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.8102498054504395  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.810250759124756  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.001001358032227  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.001002311706543  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.0730390548706055  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 5.073040008544922  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

pure train time  6.784993886947632
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.904296875 GB
    Memory Allocated: 4.599470615386963  GigaBytes
Max Memory Allocated: 6.150759696960449  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0929011106491089
Total (block generation + training)time/epoch 7.927846329552787
pure train time/epoch 7.09680696328481

num_input_list  [8063, 8367, 8302, 8089, 8449, 8256, 8324, 8488, 8036, 8013]
