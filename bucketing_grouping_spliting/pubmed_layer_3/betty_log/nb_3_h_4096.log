main start at this time 1689568729.3909385
  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.199 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.199 GB
Metis partitioning: 0.000 seconds, peak memory: 25.199 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005433082580566406
pure dgl.metis_partition the time spent:  0.003325939178466797
connection checking time:  0.027283906936645508
block generation total time  0.030063152313232422
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.470703125 GB
    Memory Allocated: 1.9040956497192383  GigaBytes
Max Memory Allocated: 1.9074339866638184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.470703125 GB
    Memory Allocated: 1.904097080230713  GigaBytes
Max Memory Allocated: 1.9074339866638184  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 5.228515625 GB
    Memory Allocated: 2.5469980239868164  GigaBytes
Max Memory Allocated: 3.4578866958618164  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 5.228515625 GB
    Memory Allocated: 2.546998977661133  GigaBytes
Max Memory Allocated: 3.4578866958618164  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 5.728515625 GB
    Memory Allocated: 2.7157349586486816  GigaBytes
Max Memory Allocated: 3.5456700325012207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 5.728515625 GB
    Memory Allocated: 2.715735912322998  GigaBytes
Max Memory Allocated: 3.5456700325012207  GigaBytes

pure train time  6.341576814651489
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.603515625 GB
    Memory Allocated: 4.599137306213379  GigaBytes
Max Memory Allocated: 5.349137306213379  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1012588739395142
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.473 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.473 GB
Metis partitioning: 0.000 seconds, peak memory: 30.473 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004561185836791992
pure dgl.metis_partition the time spent:  0.0027437210083007812
connection checking time:  0.026902437210083008
block generation total time  0.030245304107666016
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.603515625 GB
    Memory Allocated: 4.959089279174805  GigaBytes
Max Memory Allocated: 5.349137306213379  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.603515625 GB
    Memory Allocated: 4.959090709686279  GigaBytes
Max Memory Allocated: 5.349137306213379  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.853515625 GB
    Memory Allocated: 4.939363956451416  GigaBytes
Max Memory Allocated: 5.95692253112793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.853515625 GB
    Memory Allocated: 4.939364910125732  GigaBytes
Max Memory Allocated: 5.95692253112793  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.853515625 GB
    Memory Allocated: 5.303814888000488  GigaBytes
Max Memory Allocated: 5.95692253112793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.853515625 GB
    Memory Allocated: 5.303815841674805  GigaBytes
Max Memory Allocated: 5.95692253112793  GigaBytes

pure train time  5.836281061172485
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.600751876831055  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1017992496490479
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004248857498168945
pure dgl.metis_partition the time spent:  0.0025365352630615234
connection checking time:  0.02676224708557129
block generation total time  0.03111100196838379
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.1539411544799805  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.153942584991455  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.128148555755615  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.128149509429932  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.935907363891602  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.935908317565918  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

pure train time  6.224745512008667
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.598132610321045  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.103766679763794
loading full batch data spends  0.007677793502807617
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035293102264404297
pure dgl.metis_partition the time spent:  0.002549409866333008
connection checking time:  0.025272130966186523
block generation total time  0.029573440551757812
generate_dataloader_block spend   0.06842398643493652
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.080448150634766  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.08044958114624  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.140227317810059  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.140228271484375  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.968824863433838  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.968825817108154  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

pure train time  5.7484166622161865
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.598135948181152  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.107175588607788
loading full batch data spends  0.007297992706298828
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005200386047363281
pure dgl.metis_partition the time spent:  0.0026602745056152344
connection checking time:  0.02601337432861328
block generation total time  0.03075861930847168
generate_dataloader_block spend   0.0697944164276123
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.244907379150391  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.244908809661865  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.985659599304199  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.985660552978516  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.9666523933410645  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.966653347015381  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

pure train time  5.615492820739746
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.598259449005127  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.091078519821167
loading full batch data spends  0.0075452327728271484
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004608631134033203
pure dgl.metis_partition the time spent:  0.0026044845581054688
connection checking time:  0.027063846588134766
block generation total time  0.029747962951660156
generate_dataloader_block spend   0.06985044479370117
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.930617809295654  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.930619239807129  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.906962871551514  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.90696382522583  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.362348556518555  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.362349510192871  GigaBytes
Max Memory Allocated: 6.301464557647705  GigaBytes

pure train time  5.9297661781311035
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.600564479827881  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0967981815338135
loading full batch data spends  0.007498502731323242
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005343437194824219
pure dgl.metis_partition the time spent:  0.0027039051055908203
connection checking time:  0.02885150909423828
block generation total time  0.03063178062438965
generate_dataloader_block spend   0.07335114479064941
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.226192951202393  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.226194381713867  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.926348686218262  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.926349639892578  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.043344020843506  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.043344974517822  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

pure train time  6.0090813636779785
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.598809719085693  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.089202880859375
loading full batch data spends  0.007209300994873047
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0031948089599609375
pure dgl.metis_partition the time spent:  0.0023946762084960938
connection checking time:  0.027904510498046875
block generation total time  0.03021836280822754
generate_dataloader_block spend   0.06917977333068848
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.0201287269592285  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.020130157470703  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.1437482833862305  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.143749237060547  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.045022964477539  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.0450239181518555  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

pure train time  5.764856338500977
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.598477840423584  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.098404049873352
loading full batch data spends  0.0074481964111328125
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003175020217895508
pure dgl.metis_partition the time spent:  0.0022706985473632812
connection checking time:  0.028382539749145508
block generation total time  0.029636383056640625
generate_dataloader_block spend   0.06848430633544922
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.022103309631348  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.022104740142822  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.079061508178711  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.079062461853027  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.101390361785889  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.101391315460205  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

pure train time  5.751451730728149
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.59913969039917  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0862606763839722
loading full batch data spends  0.007032155990600586
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 30.982 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.982 GB
Metis partitioning: 0.000 seconds, peak memory: 30.982 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003395557403564453
pure dgl.metis_partition the time spent:  0.002550840377807617
connection checking time:  0.02722907066345215
block generation total time  0.030078887939453125
generate_dataloader_block spend   0.0683741569519043
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.986949920654297  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.9869513511657715  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.083200454711914  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.0832014083862305  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.149670600891113  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 5.14967155456543  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

pure train time  6.211056232452393
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.103515625 GB
    Memory Allocated: 4.599316596984863  GigaBytes
Max Memory Allocated: 6.359433650970459  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0856196880340576
Total (block generation + training)time/epoch 6.4927167892456055
pure train time/epoch 5.880284110705058

num_input_list  [7736, 7892, 8140, 7607, 7749, 7722, 7654, 8136, 7876, 8116]
