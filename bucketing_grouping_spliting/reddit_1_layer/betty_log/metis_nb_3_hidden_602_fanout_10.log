main start at this time 1691287335.3084466
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.233 seconds, peak memory: 34.907 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.907 GB
Metis partitioning: 12.581 seconds, peak memory: 36.210 GB
Split the graph: 4.341 seconds
Construct subgraphs: 0.012 seconds
52676
49895
50860
The batched output nid list before graph partition
connection checking time:  1.4110472202301025
block generation total time  1.8695690631866455
pure train time  0.803856372833252
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 0.44187498092651367  GigaBytes
Max Memory Allocated: 20.296410083770752  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.166555404663086
Convert a graph into a bidirected graph: 1.731 seconds, peak memory: 62.665 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 62.665 GB
Metis partitioning: 12.655 seconds, peak memory: 63.979 GB
Split the graph: 4.821 seconds
Construct subgraphs: 0.019 seconds
50714
50055
52662
The batched output nid list before graph partition
connection checking time:  1.414595365524292
block generation total time  1.9781479835510254
pure train time  0.6110210418701172
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.025390625 GB
    Memory Allocated: 0.44713640213012695  GigaBytes
Max Memory Allocated: 20.332417488098145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.247234344482422
Convert a graph into a bidirected graph: 1.920 seconds, peak memory: 66.176 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.176 GB
Metis partitioning: 12.721 seconds, peak memory: 67.490 GB
Split the graph: 4.797 seconds
Construct subgraphs: 0.029 seconds
52111
49730
51590
The batched output nid list before graph partition
connection checking time:  1.4674227237701416
block generation total time  1.9211134910583496
pure train time  0.16988730430603027
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.12890625 GB
    Memory Allocated: 0.4441800117492676  GigaBytes
Max Memory Allocated: 20.332417488098145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7505760192871094
loading full batch data spends  0.09043169021606445
Convert a graph into a bidirected graph: 1.902 seconds, peak memory: 71.330 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.330 GB
Metis partitioning: 12.826 seconds, peak memory: 72.678 GB
Split the graph: 4.832 seconds
Construct subgraphs: 0.021 seconds
52228
51261
49942
The batched output nid list before graph partition
connection checking time:  1.42281174659729
block generation total time  1.9956440925598145
generate_dataloader_block spend   23.93761968612671
pure train time  0.14612817764282227
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.12890625 GB
    Memory Allocated: 0.439239501953125  GigaBytes
Max Memory Allocated: 20.332417488098145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3123154640197754
loading full batch data spends  0.08506488800048828
Convert a graph into a bidirected graph: 1.858 seconds, peak memory: 75.540 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.540 GB
Metis partitioning: 13.084 seconds, peak memory: 76.843 GB
Split the graph: 4.667 seconds
Construct subgraphs: 0.033 seconds
51292
49742
52397
The batched output nid list before graph partition
connection checking time:  1.420530080795288
block generation total time  1.9711964130401611
generate_dataloader_block spend   23.894230604171753
pure train time  0.16873908042907715
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.12890625 GB
    Memory Allocated: 0.44518375396728516  GigaBytes
Max Memory Allocated: 20.332417488098145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9403812885284424
Total (block generation + training)time/epoch 26.352267742156982
pure train time/epoch 0.16873908042907715

num_input_list  [510603, 510484, 511164, 510753, 510029]
