main start at this time 1691287492.068952
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.563 seconds, peak memory: 34.892 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.892 GB
Metis partitioning: 12.916 seconds, peak memory: 36.301 GB
Split the graph: 3.177 seconds
Construct subgraphs: 0.045 seconds
37616
37329
39504
38982
The batched output nid list before graph partition
connection checking time:  1.53997802734375
block generation total time  1.931250810623169
pure train time  1.0935001373291016
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.484375 GB
    Memory Allocated: 0.4035983085632324  GigaBytes
Max Memory Allocated: 15.312253952026367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.1665544509887695
Convert a graph into a bidirected graph: 1.890 seconds, peak memory: 63.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 63.214 GB
Metis partitioning: 12.519 seconds, peak memory: 63.214 GB
Split the graph: 3.695 seconds
Construct subgraphs: 0.046 seconds
37374
39307
39508
37242
The batched output nid list before graph partition
connection checking time:  1.5857045650482178
block generation total time  1.942819356918335
pure train time  0.1888577938079834
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.490234375 GB
    Memory Allocated: 0.3965902328491211  GigaBytes
Max Memory Allocated: 15.312253952026367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.247235298156738
Convert a graph into a bidirected graph: 1.879 seconds, peak memory: 65.407 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.407 GB
Metis partitioning: 13.047 seconds, peak memory: 66.799 GB
Split the graph: 3.369 seconds
Construct subgraphs: 0.042 seconds
37262
37276
39410
39483
The batched output nid list before graph partition
connection checking time:  1.528515338897705
block generation total time  1.9671387672424316
pure train time  0.1781144142150879
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.490234375 GB
    Memory Allocated: 0.40415000915527344  GigaBytes
Max Memory Allocated: 15.324015617370605  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7505764961242676
loading full batch data spends  0.07458257675170898
Convert a graph into a bidirected graph: 1.869 seconds, peak memory: 72.253 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.253 GB
Metis partitioning: 12.796 seconds, peak memory: 73.645 GB
Split the graph: 3.572 seconds
Construct subgraphs: 0.043 seconds
39450
37319
37297
39365
The batched output nid list before graph partition
connection checking time:  1.550004482269287
block generation total time  1.9306578636169434
generate_dataloader_block spend   22.63607358932495
pure train time  0.19124412536621094
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.490234375 GB
    Memory Allocated: 0.4046330451965332  GigaBytes
Max Memory Allocated: 15.324015617370605  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3123152256011963
loading full batch data spends  0.0861520767211914
Convert a graph into a bidirected graph: 1.884 seconds, peak memory: 74.510 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.510 GB
Metis partitioning: 12.995 seconds, peak memory: 75.898 GB
Split the graph: 3.460 seconds
Construct subgraphs: 0.012 seconds
37879
38451
39288
37813
The batched output nid list before graph partition
connection checking time:  1.5519146919250488
block generation total time  1.9909989833831787
generate_dataloader_block spend   22.730906009674072
pure train time  0.17821049690246582
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.490234375 GB
    Memory Allocated: 0.39897775650024414  GigaBytes
Max Memory Allocated: 15.324015617370605  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9403815269470215
Total (block generation + training)time/epoch 25.19287872314453
pure train time/epoch 0.17821049690246582

num_input_list  [612742, 612856, 612713, 613012, 612481]
