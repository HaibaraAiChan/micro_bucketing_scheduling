main start at this time 1691287794.6504443
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.231 seconds, peak memory: 34.903 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.903 GB
Metis partitioning: 12.507 seconds, peak memory: 36.292 GB
Split the graph: 2.382 seconds
Construct subgraphs: 0.033 seconds
26282
24906
25616
25487
24860
26280
The batched output nid list before graph partition
connection checking time:  1.629429578781128
block generation total time  2.0074732303619385
pure train time  0.7821290493011475
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.3671875 GB
    Memory Allocated: 0.3428993225097656  GigaBytes
Max Memory Allocated: 10.261058330535889  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.166554927825928
Convert a graph into a bidirected graph: 1.891 seconds, peak memory: 58.940 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.940 GB
Metis partitioning: 12.977 seconds, peak memory: 60.359 GB
Split the graph: 2.985 seconds
Construct subgraphs: 0.038 seconds
26295
24884
25347
25303
25409
26193
The batched output nid list before graph partition
connection checking time:  1.6748957633972168
block generation total time  2.0490164756774902
pure train time  0.24304795265197754
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.3671875 GB
    Memory Allocated: 0.3434896469116211  GigaBytes
Max Memory Allocated: 10.282395362854004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.24723482131958
Convert a graph into a bidirected graph: 1.897 seconds, peak memory: 70.040 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.040 GB
Metis partitioning: 13.051 seconds, peak memory: 71.432 GB
Split the graph: 2.606 seconds
Construct subgraphs: 0.036 seconds
26286
26195
24843
24938
24829
26340
The batched output nid list before graph partition
connection checking time:  1.6751108169555664
block generation total time  2.0038902759552
pure train time  0.2599935531616211
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.875 GB
    Memory Allocated: 0.34338951110839844  GigaBytes
Max Memory Allocated: 10.308620929718018  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7505764961242676
loading full batch data spends  0.08848428726196289
Convert a graph into a bidirected graph: 1.884 seconds, peak memory: 77.250 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.250 GB
Metis partitioning: 13.217 seconds, peak memory: 78.642 GB
Split the graph: 2.461 seconds
Construct subgraphs: 0.029 seconds
24897
24888
26116
26337
26187
25006
The batched output nid list before graph partition
connection checking time:  1.7238023281097412
block generation total time  2.0656797885894775
generate_dataloader_block spend   22.27664279937744
pure train time  0.30339980125427246
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.009765625 GB
    Memory Allocated: 0.33646345138549805  GigaBytes
Max Memory Allocated: 10.328702449798584  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3123159408569336
loading full batch data spends  0.09015178680419922
Convert a graph into a bidirected graph: 1.913 seconds, peak memory: 78.642 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.642 GB
Metis partitioning: 13.249 seconds, peak memory: 79.736 GB
Split the graph: 2.431 seconds
Construct subgraphs: 0.026 seconds
26195
24840
24826
26041
26338
25191
The batched output nid list before graph partition
connection checking time:  1.7280879020690918
block generation total time  2.0106942653656006
generate_dataloader_block spend   22.284607887268066
pure train time  0.3117504119873047
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.009765625 GB
    Memory Allocated: 0.3370194435119629  GigaBytes
Max Memory Allocated: 10.328702449798584  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9403820037841797
Total (block generation + training)time/epoch 24.95901131629944
pure train time/epoch 0.3117504119873047

num_input_list  [765317, 765667, 765905, 766091, 765150]
