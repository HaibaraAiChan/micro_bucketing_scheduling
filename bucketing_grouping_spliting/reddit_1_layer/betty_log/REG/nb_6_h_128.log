main start at this time 1690929908.648046
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
REG start----................................
Convert a graph into a bidirected graph: 1.394 seconds, peak memory: 34.715 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.715 GB
Metis partitioning: 9.279 seconds, peak memory: 35.383 GB
Split the graph: 1.176 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
REG construction  time spent:  4.745010137557983
pure dgl.metis_partition the time spent:  11.87507438659668
connection checking time:  1.2689287662506104
block generation total time  1.9117536544799805
pure train time  0.8226988315582275
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.068359375 GB
    Memory Allocated: 0.20505475997924805  GigaBytes
Max Memory Allocated: 10.150331974029541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.1665544509887695
REG start----................................
Convert a graph into a bidirected graph: 1.449 seconds, peak memory: 65.559 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.559 GB
Metis partitioning: 9.902 seconds, peak memory: 66.197 GB
Split the graph: 1.522 seconds
Construct subgraphs: 0.227 seconds
REG metis partition end ----................................
REG construction  time spent:  4.45492148399353
pure dgl.metis_partition the time spent:  13.114457368850708
connection checking time:  1.2562522888183594
block generation total time  1.9142351150512695
pure train time  0.26373291015625
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.6484375 GB
    Memory Allocated: 0.20566606521606445  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.042497634887695
REG start----................................
Convert a graph into a bidirected graph: 1.428 seconds, peak memory: 77.331 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.331 GB
Metis partitioning: 10.135 seconds, peak memory: 77.968 GB
Split the graph: 1.746 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  4.683120012283325
pure dgl.metis_partition the time spent:  13.346906661987305
connection checking time:  1.304069995880127
block generation total time  1.9119112491607666
pure train time  0.32007336616516113
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.666015625 GB
    Memory Allocated: 0.20032644271850586  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.923587799072266
loading full batch data spends  0.07842397689819336
REG start----................................
Convert a graph into a bidirected graph: 1.445 seconds, peak memory: 78.228 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.228 GB
Metis partitioning: 9.268 seconds, peak memory: 78.228 GB
Split the graph: 1.214 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  5.629840135574341
pure dgl.metis_partition the time spent:  11.9614417552948
connection checking time:  1.3145289421081543
block generation total time  1.8576467037200928
generate_dataloader_block spend   22.044611930847168
pure train time  0.24469947814941406
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.666015625 GB
    Memory Allocated: 0.22670698165893555  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.806082248687744
loading full batch data spends  0.09254908561706543
REG start----................................
Convert a graph into a bidirected graph: 1.449 seconds, peak memory: 78.412 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.412 GB
Metis partitioning: 10.061 seconds, peak memory: 78.412 GB
Split the graph: 1.332 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  5.283243417739868
pure dgl.metis_partition the time spent:  12.87214732170105
connection checking time:  1.2676329612731934
block generation total time  1.8526051044464111
generate_dataloader_block spend   22.450791835784912
pure train time  0.2582104206085205
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.666015625 GB
    Memory Allocated: 0.21452617645263672  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.695546627044678
loading full batch data spends  0.10516214370727539
REG start----................................
Convert a graph into a bidirected graph: 1.402 seconds, peak memory: 78.412 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.412 GB
Metis partitioning: 10.171 seconds, peak memory: 78.412 GB
Split the graph: 1.509 seconds
Construct subgraphs: 0.220 seconds
REG metis partition end ----................................
REG construction  time spent:  4.82306694984436
pure dgl.metis_partition the time spent:  13.318629503250122
connection checking time:  1.2727108001708984
block generation total time  1.9248864650726318
generate_dataloader_block spend   22.453680992126465
pure train time  0.3306279182434082
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.666015625 GB
    Memory Allocated: 0.20489931106567383  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.593874931335449
loading full batch data spends  0.0998528003692627
REG start----................................
Convert a graph into a bidirected graph: 1.405 seconds, peak memory: 78.412 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.412 GB
Metis partitioning: 10.261 seconds, peak memory: 78.412 GB
Split the graph: 1.538 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  4.859117269515991
pure dgl.metis_partition the time spent:  13.241884231567383
connection checking time:  1.254016637802124
block generation total time  1.885613203048706
generate_dataloader_block spend   22.421955585479736
pure train time  0.3265354633331299
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.666015625 GB
    Memory Allocated: 0.18544960021972656  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.505173206329346
loading full batch data spends  0.10062646865844727
REG start----................................
Convert a graph into a bidirected graph: 1.378 seconds, peak memory: 78.418 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.418 GB
Metis partitioning: 9.275 seconds, peak memory: 78.418 GB
Split the graph: 1.554 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  4.962404727935791
pure dgl.metis_partition the time spent:  12.237377405166626
connection checking time:  1.2843201160430908
block generation total time  1.8732936382293701
generate_dataloader_block spend   21.586192846298218
pure train time  0.2789156436920166
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.666015625 GB
    Memory Allocated: 0.20433902740478516  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.42472505569458
loading full batch data spends  0.09648275375366211
REG start----................................
Convert a graph into a bidirected graph: 1.486 seconds, peak memory: 78.469 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.469 GB
Metis partitioning: 10.307 seconds, peak memory: 78.469 GB
Split the graph: 1.548 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  4.957371950149536
pure dgl.metis_partition the time spent:  13.375741243362427
connection checking time:  1.2935218811035156
block generation total time  1.8812189102172852
generate_dataloader_block spend   22.689406871795654
pure train time  0.3383355140686035
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.666015625 GB
    Memory Allocated: 0.20325613021850586  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.351598739624023
loading full batch data spends  0.06685733795166016
REG start----................................
Convert a graph into a bidirected graph: 1.464 seconds, peak memory: 78.469 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.469 GB
Metis partitioning: 10.374 seconds, peak memory: 78.469 GB
Split the graph: 1.429 seconds
Construct subgraphs: 0.212 seconds
REG metis partition end ----................................
REG construction  time spent:  5.657644033432007
pure dgl.metis_partition the time spent:  13.495191097259521
connection checking time:  1.3199315071105957
block generation total time  1.9036362171173096
generate_dataloader_block spend   23.506144285202026
pure train time  0.2761712074279785
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.669921875 GB
    Memory Allocated: 0.21265029907226562  GigaBytes
Max Memory Allocated: 10.227973937988281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.287236213684082
Total (block generation + training)time/epoch 24.816930498395646
pure train time/epoch 0.30146602789560956

num_input_list  [365823, 364096, 366283, 363673, 377071, 379407, 349509, 365908, 357678, 368163]
