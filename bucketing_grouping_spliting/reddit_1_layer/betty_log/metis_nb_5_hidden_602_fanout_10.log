main start at this time 1691287644.5585432
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.194 seconds, peak memory: 34.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.905 GB
Metis partitioning: 12.532 seconds, peak memory: 36.303 GB
Split the graph: 2.552 seconds
Construct subgraphs: 0.034 seconds
30450
31519
31125
30527
29810
The batched output nid list before graph partition
connection checking time:  1.1720166206359863
block generation total time  1.345649003982544
pure train time  0.8106093406677246
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.822265625 GB
    Memory Allocated: 0.3612227439880371  GigaBytes
Max Memory Allocated: 12.2369384765625  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.166555404663086
Convert a graph into a bidirected graph: 1.945 seconds, peak memory: 66.819 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.819 GB
Metis partitioning: 12.915 seconds, peak memory: 68.185 GB
Split the graph: 3.038 seconds
Construct subgraphs: 0.015 seconds
30672
31543
29854
29929
31433
The batched output nid list before graph partition
connection checking time:  1.6412882804870605
block generation total time  2.0875539779663086
pure train time  0.2284245491027832
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.158203125 GB
    Memory Allocated: 0.370241641998291  GigaBytes
Max Memory Allocated: 12.298539161682129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.247235298156738
Convert a graph into a bidirected graph: 1.886 seconds, peak memory: 77.237 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.237 GB
Metis partitioning: 13.899 seconds, peak memory: 78.614 GB
Split the graph: 2.830 seconds
Construct subgraphs: 0.043 seconds
31607
30582
29853
31599
29790
The batched output nid list before graph partition
connection checking time:  1.6411652565002441
block generation total time  2.0580601692199707
pure train time  0.48061060905456543
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.037109375 GB
    Memory Allocated: 0.36342477798461914  GigaBytes
Max Memory Allocated: 12.313085556030273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7505764961242676
loading full batch data spends  0.08760523796081543
Convert a graph into a bidirected graph: 2.021 seconds, peak memory: 80.964 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.964 GB
Metis partitioning: 12.955 seconds, peak memory: 80.964 GB
Split the graph: 3.038 seconds
Construct subgraphs: 0.015 seconds
30902
30796
31180
30278
30275
The batched output nid list before graph partition
connection checking time:  1.639641284942627
block generation total time  2.013432741165161
generate_dataloader_block spend   22.540892839431763
pure train time  0.22144341468811035
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.037109375 GB
    Memory Allocated: 0.3639659881591797  GigaBytes
Max Memory Allocated: 12.313085556030273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3123157024383545
loading full batch data spends  0.09104394912719727
Convert a graph into a bidirected graph: 1.974 seconds, peak memory: 80.964 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.964 GB
Metis partitioning: 12.811 seconds, peak memory: 80.964 GB
Split the graph: 2.834 seconds
Construct subgraphs: 0.015 seconds
29791
31276
30996
29790
31578
The batched output nid list before graph partition
connection checking time:  1.616591215133667
block generation total time  2.0392024517059326
generate_dataloader_block spend   22.225229263305664
pure train time  0.23128652572631836
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.037109375 GB
    Memory Allocated: 0.37015676498413086  GigaBytes
Max Memory Allocated: 12.313085556030273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9403820037841797
Total (block generation + training)time/epoch 24.984739780426025
pure train time/epoch 0.23128652572631836

num_input_list  [696188, 696098, 696631, 696136, 695545]
