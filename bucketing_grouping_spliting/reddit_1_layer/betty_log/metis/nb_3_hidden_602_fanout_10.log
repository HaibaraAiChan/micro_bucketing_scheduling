main start at this time 1693440340.7267756
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.304 seconds, peak memory: 34.903 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.903 GB
Metis partitioning: 12.283 seconds, peak memory: 36.211 GB
Split the graph: 4.049 seconds
Construct subgraphs: 0.012 seconds
52412
49811
51208
metis partition time  20.688459157943726
The batched output nid list before graph partition
connection checking time:  1.448059320449829
block generation total time  1.939650058746338
pure train time  0.8105611801147461
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.837890625 GB
    Memory Allocated: 0.4418206214904785  GigaBytes
Max Memory Allocated: 20.212823390960693  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.1675567626953125
Convert a graph into a bidirected graph: 1.743 seconds, peak memory: 62.340 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 62.340 GB
Metis partitioning: 12.646 seconds, peak memory: 63.654 GB
Split the graph: 5.121 seconds
Construct subgraphs: 0.026 seconds
52308
49974
51149
metis partition time  19.575589179992676
The batched output nid list before graph partition
connection checking time:  1.4621667861938477
block generation total time  2.023711919784546
pure train time  0.1779954433441162
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.83984375 GB
    Memory Allocated: 0.44197797775268555  GigaBytes
Max Memory Allocated: 20.23935842514038  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.246783256530762
Convert a graph into a bidirected graph: 1.898 seconds, peak memory: 66.553 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.553 GB
Metis partitioning: 12.590 seconds, peak memory: 67.867 GB
Split the graph: 4.649 seconds
Construct subgraphs: 0.030 seconds
51803
51725
49903
metis partition time  19.2153422832489
The batched output nid list before graph partition
connection checking time:  1.441488265991211
block generation total time  1.9994359016418457
pure train time  0.15819406509399414
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.83984375 GB
    Memory Allocated: 0.4375905990600586  GigaBytes
Max Memory Allocated: 20.23935842514038  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7482755184173584
loading full batch data spends  0.07512998580932617
Convert a graph into a bidirected graph: 1.923 seconds, peak memory: 70.678 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.678 GB
Metis partitioning: 12.816 seconds, peak memory: 72.036 GB
Split the graph: 4.574 seconds
Construct subgraphs: 0.012 seconds
50948
49906
52577
metis partition time  19.37282419204712
The batched output nid list before graph partition
connection checking time:  1.4235906600952148
block generation total time  1.9882910251617432
generate_dataloader_block spend   23.593612670898438
pure train time  0.612011194229126
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.912109375 GB
    Memory Allocated: 0.4458737373352051  GigaBytes
Max Memory Allocated: 20.328079223632812  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3118362426757812
loading full batch data spends  0.0840001106262207
Convert a graph into a bidirected graph: 1.921 seconds, peak memory: 74.025 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.025 GB
Metis partitioning: 12.749 seconds, peak memory: 75.339 GB
Split the graph: 4.163 seconds
Construct subgraphs: 0.006 seconds
52190
49664
51577
metis partition time  18.878488302230835
The batched output nid list before graph partition
connection checking time:  0.8478572368621826
block generation total time  1.3326709270477295
generate_dataloader_block spend   21.746345281600952
pure train time  0.18125081062316895
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.962890625 GB
    Memory Allocated: 0.44370365142822266  GigaBytes
Max Memory Allocated: 20.328079223632812  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9377288818359375
Total (block generation + training)time/epoch 25.208810806274414
pure train time/epoch 0.18125081062316895

num_input_list  [510437, 510669, 510329, 510830, 510610]
