main start at this time 1693440956.4599347
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.400 seconds, peak memory: 34.892 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.892 GB
Metis partitioning: 13.198 seconds, peak memory: 36.298 GB
Split the graph: 2.138 seconds
Construct subgraphs: 0.032 seconds
21588
22225
21379
21377
22577
22545
21740
metis partition time  19.805822134017944
The batched output nid list before graph partition
connection checking time:  1.8116724491119385
block generation total time  1.819328784942627
pure train time  0.8812625408172607
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.294921875 GB
    Memory Allocated: 0.31438636779785156  GigaBytes
Max Memory Allocated: 8.823408126831055  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.1675567626953125
Convert a graph into a bidirected graph: 1.985 seconds, peak memory: 71.607 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.607 GB
Metis partitioning: 13.999 seconds, peak memory: 72.973 GB
Split the graph: 2.186 seconds
Construct subgraphs: 0.057 seconds
22550
22557
21840
21343
21321
22538
21282
metis partition time  18.270636796951294
The batched output nid list before graph partition
connection checking time:  1.8217175006866455
block generation total time  2.266479969024658
pure train time  0.3856062889099121
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.791015625 GB
    Memory Allocated: 0.3110065460205078  GigaBytes
Max Memory Allocated: 8.859137058258057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.246783256530762
Convert a graph into a bidirected graph: 1.981 seconds, peak memory: 81.461 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.461 GB
Metis partitioning: 13.591 seconds, peak memory: 82.853 GB
Split the graph: 2.099 seconds
Construct subgraphs: 0.019 seconds
21279
21280
22572
22526
21877
21321
22576
metis partition time  17.739651679992676
The batched output nid list before graph partition
connection checking time:  1.8264529705047607
block generation total time  2.1829705238342285
pure train time  0.3195223808288574
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.791015625 GB
    Memory Allocated: 0.3191227912902832  GigaBytes
Max Memory Allocated: 8.860179424285889  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.748276472091675
loading full batch data spends  0.08865070343017578
Convert a graph into a bidirected graph: 1.985 seconds, peak memory: 82.935 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 82.935 GB
Metis partitioning: 13.441 seconds, peak memory: 82.935 GB
Split the graph: 2.438 seconds
Construct subgraphs: 0.016 seconds
21566
21598
21374
22363
22577
22575
21378
metis partition time  17.918134927749634
The batched output nid list before graph partition
connection checking time:  1.8098828792572021
block generation total time  2.1740870475769043
generate_dataloader_block spend   22.782011032104492
pure train time  0.5961077213287354
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.88671875 GB
    Memory Allocated: 0.3119964599609375  GigaBytes
Max Memory Allocated: 8.869182586669922  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3118371963500977
loading full batch data spends  0.09026455879211426
Convert a graph into a bidirected graph: 1.985 seconds, peak memory: 82.935 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 82.935 GB
Metis partitioning: 13.501 seconds, peak memory: 82.935 GB
Split the graph: 2.552 seconds
Construct subgraphs: 0.018 seconds
22568
22045
21304
21844
21361
21859
22450
metis partition time  18.09817099571228
The batched output nid list before graph partition
connection checking time:  1.7733840942382812
block generation total time  2.1382126808166504
generate_dataloader_block spend   22.876572847366333
pure train time  0.3294222354888916
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.376953125 GB
    Memory Allocated: 0.3188776969909668  GigaBytes
Max Memory Allocated: 8.869182586669922  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9377288818359375
Total (block generation + training)time/epoch 25.64939320087433
pure train time/epoch 0.3294222354888916

num_input_list  [824689, 824208, 824270, 824963, 824629]
