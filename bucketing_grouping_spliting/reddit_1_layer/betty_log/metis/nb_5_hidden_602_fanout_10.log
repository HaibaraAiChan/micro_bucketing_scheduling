main start at this time 1693440646.6855145
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.369 seconds, peak memory: 34.892 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.892 GB
Metis partitioning: 13.150 seconds, peak memory: 36.300 GB
Split the graph: 2.662 seconds
Construct subgraphs: 0.039 seconds
30450
31519
31125
30527
29810
metis partition time  20.257441759109497
The batched output nid list before graph partition
connection checking time:  1.681504249572754
block generation total time  1.7395071983337402
pure train time  0.8265645503997803
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.822265625 GB
    Memory Allocated: 0.36159276962280273  GigaBytes
Max Memory Allocated: 12.236873149871826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.167557716369629
Convert a graph into a bidirected graph: 2.019 seconds, peak memory: 66.499 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.499 GB
Metis partitioning: 13.238 seconds, peak memory: 67.865 GB
Split the graph: 2.938 seconds
Construct subgraphs: 0.015 seconds
30057
31540
30419
29871
31544
metis partition time  18.25215768814087
The batched output nid list before graph partition
connection checking time:  1.6558833122253418
block generation total time  2.1268815994262695
pure train time  0.2505836486816406
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.158203125 GB
    Memory Allocated: 0.37059736251831055  GigaBytes
Max Memory Allocated: 12.305122375488281  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.24678373336792
Convert a graph into a bidirected graph: 1.900 seconds, peak memory: 76.611 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.611 GB
Metis partitioning: 13.372 seconds, peak memory: 78.003 GB
Split the graph: 2.692 seconds
Construct subgraphs: 0.026 seconds
30355
31593
30096
29831
31556
metis partition time  18.03712248802185
The batched output nid list before graph partition
connection checking time:  1.699922800064087
block generation total time  2.1996400356292725
pure train time  0.5213141441345215
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.625 GB
    Memory Allocated: 0.36951255798339844  GigaBytes
Max Memory Allocated: 12.321531772613525  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.748276710510254
loading full batch data spends  0.09071803092956543
Convert a graph into a bidirected graph: 2.148 seconds, peak memory: 80.975 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.975 GB
Metis partitioning: 13.618 seconds, peak memory: 80.975 GB
Split the graph: 3.126 seconds
Construct subgraphs: 0.018 seconds
29894
31605
29965
30386
31581
metis partition time  18.973201513290405
The batched output nid list before graph partition
connection checking time:  1.7639784812927246
block generation total time  2.2255539894104004
generate_dataloader_block spend   23.793866872787476
pure train time  0.22480010986328125
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.626953125 GB
    Memory Allocated: 0.37036705017089844  GigaBytes
Max Memory Allocated: 12.321531772613525  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3118364810943604
loading full batch data spends  0.09369516372680664
Convert a graph into a bidirected graph: 1.989 seconds, peak memory: 80.975 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.975 GB
Metis partitioning: 13.604 seconds, peak memory: 80.975 GB
Split the graph: 3.002 seconds
Construct subgraphs: 0.035 seconds
31581
30266
29969
30152
31463
metis partition time  18.674596548080444
The batched output nid list before graph partition
connection checking time:  1.713207483291626
block generation total time  2.1530680656433105
generate_dataloader_block spend   23.421720027923584
pure train time  0.25190043449401855
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.62890625 GB
    Memory Allocated: 0.37074995040893555  GigaBytes
Max Memory Allocated: 12.321531772613525  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9377286434173584
Total (block generation + training)time/epoch 26.221741676330566
pure train time/epoch 0.25190043449401855

num_input_list  [696023, 696109, 695859, 696207, 695837]
