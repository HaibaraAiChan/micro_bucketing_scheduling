main start at this time 1693440494.4450521
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.557 seconds, peak memory: 35.001 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 35.001 GB
Metis partitioning: 12.493 seconds, peak memory: 36.389 GB
Split the graph: 3.032 seconds
Construct subgraphs: 0.048 seconds
39141
37327
37539
39424
metis partition time  20.164318084716797
The batched output nid list before graph partition
connection checking time:  0.8922111988067627
block generation total time  1.3621134757995605
pure train time  0.9388594627380371
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.130859375 GB
    Memory Allocated: 0.40480661392211914  GigaBytes
Max Memory Allocated: 15.292122840881348  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.1675567626953125
Convert a graph into a bidirected graph: 1.958 seconds, peak memory: 62.762 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 62.762 GB
Metis partitioning: 12.744 seconds, peak memory: 62.762 GB
Split the graph: 3.191 seconds
Construct subgraphs: 0.044 seconds
37616
37329
39504
38982
metis partition time  17.981386184692383
The batched output nid list before graph partition
connection checking time:  1.55367112159729
block generation total time  2.1135077476501465
pure train time  0.46082162857055664
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.53125 GB
    Memory Allocated: 0.40270519256591797  GigaBytes
Max Memory Allocated: 15.332576751708984  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.246783256530762
Convert a graph into a bidirected graph: 1.939 seconds, peak memory: 69.238 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.238 GB
Metis partitioning: 13.103 seconds, peak memory: 69.238 GB
Split the graph: 3.284 seconds
Construct subgraphs: 0.043 seconds
38608
37270
38318
39235
metis partition time  18.413832426071167
The batched output nid list before graph partition
connection checking time:  1.1912047863006592
block generation total time  2.1251840591430664
pure train time  0.2024531364440918
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.53125 GB
    Memory Allocated: 0.40384817123413086  GigaBytes
Max Memory Allocated: 15.332576751708984  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7482759952545166
loading full batch data spends  0.08997082710266113
Convert a graph into a bidirected graph: 1.988 seconds, peak memory: 72.054 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.054 GB
Metis partitioning: 13.589 seconds, peak memory: 73.446 GB
Split the graph: 3.221 seconds
Construct subgraphs: 0.027 seconds
38608
37270
38318
39235
metis partition time  18.870211601257324
The batched output nid list before graph partition
connection checking time:  1.6564326286315918
block generation total time  2.1784956455230713
generate_dataloader_block spend   23.571202516555786
pure train time  0.21398663520812988
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.533203125 GB
    Memory Allocated: 0.403719425201416  GigaBytes
Max Memory Allocated: 15.332576751708984  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3118362426757812
loading full batch data spends  0.08525943756103516
Convert a graph into a bidirected graph: 1.999 seconds, peak memory: 74.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.632 GB
Metis partitioning: 13.483 seconds, peak memory: 76.020 GB
Split the graph: 3.243 seconds
Construct subgraphs: 0.006 seconds
39141
37327
37539
39424
metis partition time  18.77807855606079
The batched output nid list before graph partition
connection checking time:  1.6495211124420166
block generation total time  2.1468780040740967
generate_dataloader_block spend   23.465299129486084
pure train time  0.19391226768493652
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.533203125 GB
    Memory Allocated: 0.4048933982849121  GigaBytes
Max Memory Allocated: 15.332576751708984  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9377284049987793
Total (block generation + training)time/epoch 26.069592833518982
pure train time/epoch 0.19391226768493652

num_input_list  [612474, 612601, 612517, 612942, 612583]
