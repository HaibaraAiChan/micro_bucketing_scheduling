main start at this time 1693440801.8087602
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.345 seconds, peak memory: 34.892 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.892 GB
Metis partitioning: 13.091 seconds, peak memory: 36.296 GB
Split the graph: 2.626 seconds
Construct subgraphs: 0.054 seconds
26235
24855
24835
26335
26311
24860
metis partition time  20.159884214401245
The batched output nid list before graph partition
connection checking time:  1.7241106033325195
block generation total time  1.7643380165100098
pure train time  0.8901801109313965
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.87109375 GB
    Memory Allocated: 0.3359851837158203  GigaBytes
Max Memory Allocated: 10.289848804473877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.167556285858154
Convert a graph into a bidirected graph: 1.971 seconds, peak memory: 65.761 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.761 GB
Metis partitioning: 13.345 seconds, peak memory: 67.126 GB
Split the graph: 2.598 seconds
Construct subgraphs: 0.014 seconds
26294
24840
24829
24851
26277
26340
metis partition time  17.969101905822754
The batched output nid list before graph partition
connection checking time:  1.7344551086425781
block generation total time  2.1381967067718506
pure train time  0.2860696315765381
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.873046875 GB
    Memory Allocated: 0.3439359664916992  GigaBytes
Max Memory Allocated: 10.306300163269043  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.246783256530762
Convert a graph into a bidirected graph: 1.839 seconds, peak memory: 77.050 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.050 GB
Metis partitioning: 13.471 seconds, peak memory: 78.442 GB
Split the graph: 2.655 seconds
Construct subgraphs: 0.035 seconds
25200
24864
25380
26248
25435
26304
metis partition time  18.04619860649109
The batched output nid list before graph partition
connection checking time:  1.7803714275360107
block generation total time  2.140791177749634
pure train time  0.2757256031036377
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.873046875 GB
    Memory Allocated: 0.34278059005737305  GigaBytes
Max Memory Allocated: 10.306300163269043  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7482762336730957
loading full batch data spends  0.08127260208129883
Convert a graph into a bidirected graph: 1.984 seconds, peak memory: 78.442 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.442 GB
Metis partitioning: 13.852 seconds, peak memory: 78.442 GB
Split the graph: 2.842 seconds
Construct subgraphs: 0.039 seconds
24909
25635
24827
26340
26144
25576
metis partition time  18.762638807296753
The batched output nid list before graph partition
connection checking time:  1.769223928451538
block generation total time  2.1725680828094482
generate_dataloader_block spend   23.575965881347656
pure train time  0.2914290428161621
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.44921875 GB
    Memory Allocated: 0.3385505676269531  GigaBytes
Max Memory Allocated: 10.316818237304688  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3118367195129395
loading full batch data spends  0.08937668800354004
Convert a graph into a bidirected graph: 1.978 seconds, peak memory: 78.442 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.442 GB
Metis partitioning: 13.772 seconds, peak memory: 79.045 GB
Split the graph: 2.550 seconds
Construct subgraphs: 0.020 seconds
24863
24825
26301
26340
24885
26217
metis partition time  18.363351583480835
The batched output nid list before graph partition
connection checking time:  1.755439281463623
block generation total time  2.1720285415649414
generate_dataloader_block spend   23.140823125839233
pure train time  0.3374779224395752
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.44921875 GB
    Memory Allocated: 0.34314775466918945  GigaBytes
Max Memory Allocated: 10.316818237304688  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9377284049987793
Total (block generation + training)time/epoch 26.022733211517334
pure train time/epoch 0.3374779224395752

num_input_list  [765734, 765441, 765291, 765492, 765367]
