main start at this time 1691287944.8150005
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
Convert a graph into a bidirected graph: 4.256 seconds, peak memory: 34.908 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.908 GB
Metis partitioning: 12.559 seconds, peak memory: 36.298 GB
Split the graph: 2.086 seconds
Construct subgraphs: 0.036 seconds
21567
22195
21367
22577
21402
21812
22511
The batched output nid list before graph partition
connection checking time:  1.7014186382293701
block generation total time  2.006486654281616
pure train time  0.8106341361999512
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.494140625 GB
    Memory Allocated: 0.3198580741882324  GigaBytes
Max Memory Allocated: 8.831663131713867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.166554927825928
Convert a graph into a bidirected graph: 1.920 seconds, peak memory: 70.886 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.886 GB
Metis partitioning: 12.989 seconds, peak memory: 72.294 GB
Split the graph: 1.952 seconds
Construct subgraphs: 0.046 seconds
22282
22509
21376
21453
21970
21285
22556
The batched output nid list before graph partition
connection checking time:  1.6974194049835205
block generation total time  2.033304214477539
pure train time  0.275543212890625
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.494140625 GB
    Memory Allocated: 0.3203420639038086  GigaBytes
Max Memory Allocated: 8.851228713989258  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.24723482131958
Convert a graph into a bidirected graph: 1.964 seconds, peak memory: 79.946 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 79.946 GB
Metis partitioning: 13.004 seconds, peak memory: 81.365 GB
Split the graph: 2.282 seconds
Construct subgraphs: 0.022 seconds
21279
22575
21917
22423
21385
22573
21279
The batched output nid list before graph partition
connection checking time:  1.7174670696258545
block generation total time  2.0385916233062744
pure train time  0.5783052444458008
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.90625 GB
    Memory Allocated: 0.3120079040527344  GigaBytes
Max Memory Allocated: 8.869459629058838  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7505767345428467
loading full batch data spends  0.10166072845458984
Convert a graph into a bidirected graph: 1.937 seconds, peak memory: 81.365 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.365 GB
Metis partitioning: 13.153 seconds, peak memory: 81.365 GB
Split the graph: 2.083 seconds
Construct subgraphs: 0.019 seconds
22577
21586
21344
21331
21887
22158
22548
The batched output nid list before graph partition
connection checking time:  1.6969890594482422
block generation total time  2.059497356414795
generate_dataloader_block spend   21.858297109603882
pure train time  0.28804898262023926
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.908203125 GB
    Memory Allocated: 0.3191647529602051  GigaBytes
Max Memory Allocated: 8.869459629058838  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3123157024383545
loading full batch data spends  0.0864565372467041
Convert a graph into a bidirected graph: 1.931 seconds, peak memory: 81.365 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.365 GB
Metis partitioning: 13.075 seconds, peak memory: 81.365 GB
Split the graph: 2.269 seconds
Construct subgraphs: 0.021 seconds
22575
21324
21284
22576
21312
21783
22577
The batched output nid list before graph partition
connection checking time:  1.7541477680206299
block generation total time  2.028414726257324
generate_dataloader_block spend   21.976515531539917
pure train time  0.3583710193634033
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.38671875 GB
    Memory Allocated: 0.32044172286987305  GigaBytes
Max Memory Allocated: 8.869459629058838  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9403820037841797
Total (block generation + training)time/epoch 24.652053236961365
pure train time/epoch 0.3583710193634033

num_input_list  [824311, 824989, 825278, 824524, 824028]
