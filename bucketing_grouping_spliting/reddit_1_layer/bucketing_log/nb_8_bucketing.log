main start at this time 1701248014.384796
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.037978172302246094
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0013289451599121094
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013507366180419922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0397801399230957
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.46504950523376465
self.buckets_partition() spend  sec:  0.053302764892578125
check connections block*********************************

the find indices time spent  0.06633377075195312

in edges time spent  0.30982351303100586
local to global src and eids time spent  0.6991758346557617
time gen tails  0.13788175582885742
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.953134298324585

block collection to dataloader spend  1.3828277587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.697265625 GB
    Memory Allocated: 0.2586336135864258  GigaBytes
Max Memory Allocated: 0.2586336135864258  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.197265625 GB
    Memory Allocated: 6.74487829208374  GigaBytes
Max Memory Allocated: 7.564899444580078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.197265625 GB
    Memory Allocated: 6.747763633728027  GigaBytes
Max Memory Allocated: 7.564899444580078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.205078125 GB
    Memory Allocated: 0.27486181259155273  GigaBytes
Max Memory Allocated: 7.564899444580078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.773322105407715  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.776422023773193  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.27136850357055664  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.757501125335693  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.760370254516602  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2741999626159668  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.765955924987793  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.769076347351074  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.27159738540649414  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.733541011810303  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.73665714263916  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2711753845214844  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.718347072601318  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.721245288848877  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.27031993865966797  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.650974750518799  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.653975009918213  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.26650524139404297  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.526958465576172  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.530288219451904  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2897658348083496  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.167250156402588
pure train time :  0.6104707717895508
train time :  3.180877447128296
end to end time :  6.02818751335144
connection check time:  1.4055266380310059
block generation time  0.953134298324585
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.03989219665527344
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0005853176116943359
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012902021408081055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.040827035903930664
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4826507568359375
self.buckets_partition() spend  sec:  0.053741455078125
check connections block*********************************

the find indices time spent  0.07462859153747559

in edges time spent  0.39363765716552734
local to global src and eids time spent  0.7056186199188232
time gen tails  0.1349492073059082
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.608144760131836

block collection to dataloader spend  1.0967254638671875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2933688163757324  GigaBytes
Max Memory Allocated: 7.592583179473877  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.77766752243042  GigaBytes
Max Memory Allocated: 7.5999932289123535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780552387237549  GigaBytes
Max Memory Allocated: 7.5999932289123535  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29651880264282227  GigaBytes
Max Memory Allocated: 7.5999932289123535  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7954936027526855  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.798593521118164  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2933821678161621  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78057861328125  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7836785316467285  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29632568359375  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.788836479187012  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.791952610015869  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2933015823364258  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.753604412078857  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.756491661071777  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29372644424438477  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.743104457855225  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7469377517700195  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29195690155029297  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673119068145752  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.6765642166137695  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.28789758682250977  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.5489182472229  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.551680564880371  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2897186279296875  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.043247699737549
pure train time :  0.20649099349975586
train time :  2.3115556240081787
end to end time :  5.9370691776275635
connection check time:  1.5049192905426025
block generation time  1.608144760131836
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.03981351852416992
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0006124973297119141
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022263050079345703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04077768325805664
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.48136258125305176
self.buckets_partition() spend  sec:  0.06305575370788574
check connections block*********************************

the find indices time spent  0.06915807723999023

in edges time spent  0.33757972717285156
local to global src and eids time spent  0.7221462726593018
time gen tails  0.13938188552856445
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.34140944480896

block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29387807846069336  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.777312755584717  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780642509460449  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29719066619873047  GigaBytes
Max Memory Allocated: 7.614754676818848  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.795126914978027  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7985310554504395  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2934384346008301  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780634880065918  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7837347984313965  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2971220016479492  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.789632797241211  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.792748928070068  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2947559356689453  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.755058765411377  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.757946014404297  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2932438850402832  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.742621898651123  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.746455192565918  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2924346923828125  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673396110534668  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.6763200759887695  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2881150245666504  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.549135684967041  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.551898002624512  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2899360656738281  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.923147201538086
pure train time :  0.1676020622253418
train time :  2.199737548828125
end to end time :  5.532685041427612
connection check time:  1.482271671295166
block generation time  1.34140944480896
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.020566701889038086
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0004627704620361328
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016670942306518555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0213165283203125
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.3448348045349121
self.buckets_partition() spend  sec:  0.037999629974365234
check connections block*********************************

the find indices time spent  0.06863617897033691

in edges time spent  0.3341023921966553
local to global src and eids time spent  0.7030956745147705
time gen tails  0.1472005844116211
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.8136947154998779

block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29497385025024414  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.778408527374268  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78173828125  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29743051528930664  GigaBytes
Max Memory Allocated: 7.614907264709473  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7953667640686035  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.798770904541016  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2933506965637207  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780547142028809  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.783647060394287  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2964177131652832  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.788928508758545  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.792044639587402  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2932586669921875  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.753561496734619  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.756448745727539  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29207563400268555  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.741826057434082  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.745659351348877  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29186487197875977  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673119068145752  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.6765642166137695  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2882876396179199  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.5493083000183105  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.552070617675781  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29010868072509766  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.80674409866333
pure train time :  0.16391539573669434
train time :  2.0668370723724365
end to end time :  4.7118237018585205
connection check time:  1.459327220916748
block generation time  0.8136947154998779
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.03758811950683594
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0008008480072021484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01533961296081543
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.038718461990356445
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4924600124359131
self.buckets_partition() spend  sec:  0.05407118797302246
check connections block*********************************

the find indices time spent  0.07283759117126465

in edges time spent  0.32485461235046387
local to global src and eids time spent  0.7314724922180176
time gen tails  0.13761258125305176
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.3140895366668701

block collection to dataloader spend  1.0728836059570312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29497385025024414  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.778408527374268  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78173828125  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2968406677246094  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.794776916503906  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.798181056976318  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2928037643432617  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78120756149292  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.784076690673828  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2971668243408203  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.789378643035889  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.793302059173584  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2947559356689453  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.755058765411377  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.757946014404297  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2930870056152344  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.742465019226074  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.746298313140869  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29222631454467773  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673187732696533  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.676111698150635  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2878551483154297  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.54887580871582  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.551638126373291  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2896761894226074  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.695005416870117
pure train time :  0.14387726783752441
train time :  2.3068113327026367
end to end time :  5.613133192062378
connection check time:  1.4656023979187012
block generation time  1.3140895366668701
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.021305084228515625
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.000640869140625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01798701286315918
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.02226877212524414
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.3318922519683838
self.buckets_partition() spend  sec:  0.04027104377746582
check connections block*********************************

the find indices time spent  0.06975054740905762

in edges time spent  0.33335399627685547
local to global src and eids time spent  0.7015759944915771
time gen tails  0.13749432563781738
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.1558966636657715

block collection to dataloader spend  1.52587890625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29389142990112305  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7773261070251465  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780655860900879  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2975492477416992  GigaBytes
Max Memory Allocated: 7.615147113800049  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.795485496520996  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.798889636993408  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2931962013244629  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780392646789551  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.783492565155029  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2975950241088867  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.790105819702148  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.793221950531006  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2928304672241211  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.75344705581665  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.75633430480957  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2932472229003906  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.742197036743164  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.745298385620117  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2922844886779785  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673245906829834  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.6761698722839355  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2875838279724121  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.548604488372803  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.551366806030273  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.28940486907958984  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.595309734344482
pure train time :  0.1554429531097412
train time :  2.1654419898986816
end to end time :  5.117286920547485
connection check time:  1.4306702613830566
block generation time  1.1558966636657715
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.013443470001220703
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0005228519439697266
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013126850128173828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014219045639038086
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.18181371688842773
self.buckets_partition() spend  sec:  0.027353763580322266
check connections block*********************************

the find indices time spent  0.041254281997680664

in edges time spent  0.2014319896697998
local to global src and eids time spent  0.580437183380127
time gen tails  0.1362752914428711
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.885106086730957

block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29497385025024414  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.778408527374268  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78173828125  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29784297943115234  GigaBytes
Max Memory Allocated: 7.615265846252441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.795779228210449  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.799183368682861  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2935147285461426  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7807111740112305  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.783811092376709  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2966575622558594  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.789168357849121  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.7922844886779785  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29294919967651367  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.753252029418945  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.756139278411865  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29370594024658203  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.743083953857422  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.746917247772217  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2921476364135742  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673119068145752  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.6765642166137695  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.28780126571655273  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.548821926116943  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.551584243774414  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.28962230682373047  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.504197120666504
pure train time :  0.15202975273132324
train time :  2.2083141803741455
end to end time :  4.43804931640625
connection check time:  1.147801399230957
block generation time  0.885106086730957
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.021409988403320312
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0004851818084716797
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014514923095703125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.022240877151489258
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.33458685874938965
self.buckets_partition() spend  sec:  0.03677201271057129
check connections block*********************************

the find indices time spent  0.07388067245483398

in edges time spent  0.3215017318725586
local to global src and eids time spent  0.708554744720459
time gen tails  0.1351315975189209
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.8255620002746582

block collection to dataloader spend  1.430511474609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29497385025024414  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.778408527374268  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78173828125  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29752254486083984  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.795458793640137  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.798862934112549  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2933487892150879  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780545234680176  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.783645153045654  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29738664627075195  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.789897441864014  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.793013572692871  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29351234436035156  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.753815174102783  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.756702423095703  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29323720932006836  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.742615222930908  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.746448516845703  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29215192794799805  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673119068145752  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.6765642166137695  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2875699996948242  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.548590660095215  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.5513529777526855  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.28939104080200195  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.422603607177734
pure train time :  0.15340399742126465
train time :  2.179865598678589
end to end time :  4.791870355606079
connection check time:  1.4284355640411377
block generation time  0.8255620002746582
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.037804365158081055
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.00045943260192871094
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01264643669128418
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.038630008697509766
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.45035862922668457
self.buckets_partition() spend  sec:  0.05128836631774902
check connections block*********************************

the find indices time spent  0.07141780853271484

in edges time spent  0.3437001705169678
local to global src and eids time spent  0.6990327835083008
time gen tails  0.13633060455322266
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.1070184707641602

block collection to dataloader spend  1.049041748046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2939028739929199  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.777337551116943  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780667304992676  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29766368865966797  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.795599937438965  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.799004077911377  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29364442825317383  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.780840873718262  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78394079208374  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2967991828918457  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.789309978485107  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.792426109313965  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2934761047363281  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.75377893447876  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.75666618347168  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.292910099029541  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.742288112640381  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.746121406555176  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2929391860961914  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673900604248047  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.676824569702148  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.28801870346069336  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.549039363861084  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.551801681518555  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2898397445678711  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.352036476135254
pure train time :  0.14610075950622559
train time :  2.1699512004852295
end to end time :  5.193676233291626
connection check time:  1.4463245868682861
block generation time  1.1070184707641602
generate_dataloader_bucket_block=======
self.num_batch (get_in_degree_bucketing) 8
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
self.K  8
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.013417959213256836
7
8
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0005717277526855469
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015086650848388672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014231204986572266
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.17644214630126953
self.buckets_partition() spend  sec:  0.02932572364807129
check connections block*********************************

the find indices time spent  0.03997159004211426

in edges time spent  0.30049562454223633
local to global src and eids time spent  0.5077178478240967
time gen tails  0.10107111930847168
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.7742836475372314

block collection to dataloader spend  1.0251998901367188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29497718811035156  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.778411865234375  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.781741619110107  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.29726696014404297  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.79520320892334  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.798607349395752  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2928462028503418  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.78120756149292  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.784076690673828  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2966732978820801  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.788885116577148  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.792808532714844  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2947559356689453  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.755058765411377  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.757946014404297  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2923898696899414  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.741826057434082  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.745659351348877  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2924976348876953  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.673459053039551  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.676383018493652  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2880368232727051  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.549057483673096  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 6.551819801330566  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 9.61328125 GB
    Memory Allocated: 0.2898578643798828  GigaBytes
Max Memory Allocated: 7.6155595779418945  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.286539077758789
pure train time :  0.14026832580566406
train time :  2.193356990814209
end to end time :  4.293133020401001
connection check time:  1.135511875152588
block generation time  0.7742836475372314
end to end time  4.561420679092407
Total (block generation + training)time/epoch 4.561420679092407
pure train time per /epoch  [0.6104707717895508, 0.20649099349975586, 0.1676020622253418, 0.16391539573669434, 0.14387726783752441, 0.1554429531097412, 0.15202975273132324, 0.15340399742126465, 0.14610075950622559, 0.14026832580566406]
pure train time average  0.15071977887834823
input num list  [874058, 873397, 874169, 873434, 873730, 873575, 874070, 874000, 874195, 873970]
